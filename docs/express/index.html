<!doctype html><html lang=en><head><meta charset=UTF-8><title>Marko + Express | Marko</title><link rel=icon type=image/png sizes=32x32 href=/assets/d78b83f1.png><meta name=viewport content="width=device-width, initial-scale=1"><meta name=description content="Marko is a friendly (and fast!) UI library that makes building web apps fun."><script>
      if (window.self !== window.top) {
        document.documentElement.classList.add("iframe");
      }
    </script><script>
      const params = new URL(window.location).searchParams;
      const uwu = params.has("uwu")
        ? params.get("uwu") !== "false"
        : localStorage.uwu;
      if (uwu) {
        localStorage.uwu = true;
        document.documentElement.className = "uwu";
        document.write(
          "<style>@import url('https://fonts.googleapis.com/css2?family=Varela+Round&display=swap');html.uwu body{font-family:'Varela Round',sans-serif;}</style>",
        );
      } else {
        delete localStorage.uwu;
      }
    </script><script src="/assets/121.fd31caae.js" async></script><script src="/assets/364.f6733859.js" async></script><script src="/assets/991.5eec5c73.js" async></script><link rel="stylesheet" href="/assets/a50c84bf.css"></head><body class=docs><a href="#main" id=skip-link>Skip to main content</a><!--M#s0-1-0-14--><header data-marko-key="@header s0-1-0-14" class=site-header><div class=content><a href="/"><img src=/assets/91bc26e5.svg alt="Marko Home" class=site-logo><img src=/assets/2371441a.png alt="Marko Home" class=site-logo-uwu></a><div class=stuff><nav class=site-menu><a href=/docs/getting-started>Docs</a><a href=/try-online>Try Online</a><a href=https://github.com/marko-js/marko>GitHub</a><!--M^s0-1-0-14-12 s0-1-0-14 12--><link rel=preconnect href=https://GB0QQV5RQM-dsn.algolia.net crossorigin><div data-marko-key="@container s0-1-0-14-12" class=search></div><!--M/--></nav><button data-marko='{"onclick":"toggleMenu s0-1-0-14 false"}' class=menu>&#9776;</button></div></div></header><!--M/--><!--M#s0-1-0-15--><div data-marko-key="@sidebar s0-1-0-15" class=doc-sidebar><button data-marko='{"onclick":"hide s0-1-0-15 false"}' class=close>&#10005;</button><h1>Marko <!--M^s0-1-0-15-9 s0-1-0-15 9--><select data-marko='{"onchange":"switchVersion s0-1-0-15-9 false"}' data-marko-key="@version s0-1-0-15-9"><option value=/v6/docs/setup>next</option><option value=/docs/getting-started selected>5.37.27</option><option value="http://marko-v4.github.io/docs/">4.x</option><option value="http://v3.markojs.com/docs/">3.x</option><option value="http://marko-v2.github.io/docs/">2.x</option></select><!--M/--></h1><ul class=toc-level0><li class=section><a href="/docs/guides-overview/">GUIDES</a></li><li><a href="/docs/installing/">Installing</a></li><li><a href="/docs/getting-started/">Getting started</a></li><li><a href="/docs/conditionals-and-lists/">Conditionals and lists</a></li><li><a href="/docs/custom-tags/">Custom tags</a></li><li><a href="/docs/state/">State</a></li><li><a href="/docs/styles/">Styles</a></li><li><a href="/docs/events/">Events</a></li><li><a href="/docs/body-content/">Body content</a></li><li><a href="/docs/typescript/">TypeScript</a></li><li><a href="/docs/marko-5-upgrade/">Marko 5 upgrade</a></li><li><a href="/docs/troubleshooting-streaming/">Troubleshooting Streaming</a></li></ul><ul class=toc-level0><li class=section><a href="/docs/tutorials-overview/">TUTORIALS</a></li><li><a href="/docs/color-picker/">Color Picker</a></li></ul><ul class=toc-level0><li class=section><a href="/docs/reference-overview/">REFERENCE</a></li><li><a href="/docs/rendering/">Rendering</a></li><li><a href="/docs/syntax/">Syntax</a></li><li><a href="/docs/core-tags/">Core tags</a></li><li><a href="/docs/class-components/">Class components</a></li><li><a href="/docs/marko-json/">marko.json</a></li><li><a href="/docs/compiler/">Compiler</a></li></ul><ul class=toc-level0><li class=section><a href="/docs/bundler-integrations-overview/">BUNDLER INTEGRATIONS</a></li><li><a href="/docs/vite/">Vite</a></li><li><a href="/docs/webpack/">Webpack</a></li><li><a href="/docs/rollup/">Rollup</a></li><li><a href="/docs/lasso/">Lasso</a></li></ul><ul class=toc-level0><li class=section><a href="/docs/server-integrations-overview/">SERVER INTEGRATIONS</a></li><li><a href="/docs/cloudflare-workers/">Cloudflare Workers</a></li><li><a class=selected href="/docs/express/">Express</a></li><li><a href="/docs/fastify/">Fastify</a></li><li><a href="/docs/koa/">Koa</a></li><li><a href="/docs/http/">HTTP</a></li></ul><ul class=toc-level0><li class=section><a href="/docs/tooling-overview/">TOOLING</a></li><li><a href="/docs/editor-plugins/">Editor plugins</a></li></ul><ul class=toc-level0><li class=section><a href="/docs/articles-overview/">ARTICLES</a></li><li><a href="/docs/marko-vs-react/">Marko vs React</a></li><li><a href="/docs/why-is-marko-fast/">Why is Marko Fast</a></li><li><a href="/docs/10-awesome-marko-features/">10 Awesome Marko Features</a></li></ul></div><!--M/--><main id=main tabindex=-1 class=content><div class=doc-layout><div class=doc-container><div class=doc-content><h1 id=marko-express><a name=marko-express class=anchor href=#marko-express><span class=header-link></span></a>Marko + Express</h1><h2 id=quick-start><a name=quick-start class=anchor href=#quick-start><span class=header-link></span></a>Quick Start</h2><script>if(localStorage.getItem('markojs-website:syntax') === 'concise'){document.body.classList.add('concise')}</script><pre class=highlighted style=color:#D0D0E0;background-color:#202034>npm init marko -- --template vite-express
# Or `npx create-marko --template vite-express`
</pre><p>See <a href=https://github.com/marko-js/examples>Marko’s example projects</a> for working <a href="https://expressjs.com/">Express</a> integration code, such as:</p><ul><li><a href=https://github.com/marko-js/examples/tree/master/examples/vite-express><code>examples/vite-express</code></a></li><li><a href=https://github.com/marko-js/examples/tree/master/examples/rollup-express><code>examples/rollup-express</code></a></li><li><a href=https://github.com/marko-js/examples/tree/master/examples/webpack-express><code>examples/webpack-express</code></a></li></ul><p>But if you want to do things the hard way…</p><h2 id=doing-things-the-hard-way><a name=doing-things-the-hard-way class=anchor href=#doing-things-the-hard-way><span class=header-link></span></a>Doing things the hard way</h2><p>First, install Marko, Express, and the glue to hold them together:</p><pre class=highlighted style=color:#D0D0E0;background-color:#202034>npm install marko express @marko/express --save
</pre><h3 id=skip-the-view-engine><a name=skip-the-view-engine class=anchor href=#skip-the-view-engine><span class=header-link></span></a>Skip the view engine</h3><p>Express’s builtin view engine may be asynchronous, but it doesn’t support streaming — see <a href="https://tech.ebayinc.com/engineering/async-fragments-rediscovering-progressive-html-rendering-with-marko/">Rediscovering Progressive HTML Rendering</a> for why that’s important. So instead, we <a href="https://strongloop.com/strongblog/bypassing-express-view-rendering-for-speed-and-modularity/">bypass Express’s view engine</a> to use <code>@marko/express</code> instead.</p><p><a href=https://www.npmjs.com/package/@marko/express>The <code>@marko/express</code> package</a> adds a <code>res.marko()</code> method to <a href=https://expressjs.com/en/api.html#res>Express’s response object</a>. This method works like <a href=https://expressjs.com/en/api.html#resrender><code>res.render()</code></a>, but without the restrictions of Express’s view engine, letting you take full advantage of Marko’s streaming and modular template organization.</p><blockquote class=null><p><strong>ProTip</strong>: By using <code>res.marko()</code>, properties from <a href=https://expressjs.com/en/api.html#applocals><code>app.locals</code></a> and <a href=https://expressjs.com/en/api.html#reslocals><code>res.locals</code></a> are automatically <a href=/docs/rendering/#global-data>available on <code>&#36;global</code></a>.</p></blockquote><pre class=highlighted style=color:#D0D0E0;background-color:#202034><span style=color:#FF4185>import</span> <span style=color:#FFFFFF>express</span> <span style=color:#FF4185>from</span> <span style=color:#FFF066>"express"</span>;
<span style=color:#FF4185>import</span> <span style=color:#FFFFFF>markoPlugin</span> <span style=color:#FF4185>from</span> <span style=color:#FFF066>"@marko/express"</span>;
<span style=color:#FF4185>import</span> <span style=color:#FFFFFF>template</span> <span style=color:#FF4185>from</span> <span style=color:#FFF066>"./template.marko"</span>;

<span style=color:#66D9EF>const</span> <span style=color:#FFFFFF>app</span> <span style=color:#FFFFFF>=</span> <span style=color:#A6E22E>express</span>();
<span style=color:#FFFFFF>app</span>.<span style=color:#A6E22E>use</span>(<span style=color:#A6E22E>markoPlugin</span>()); <span style=color:#8F8F9E>// Enables `res.marko(template, input)`</span>

<span style=color:#FFFFFF>app</span>.<span style=color:#A6E22E>get</span>(<span style=color:#FFF066>"/"</span>, <span style=color:#66D9EF>function</span> (<span style=color:#FFAC4D>req</span>, <span style=color:#FFAC4D>res</span>) {
  <span style=color:#FFFFFF>res</span>.<span style=color:#A6E22E>marko</span>(<span style=color:#FFFFFF>template</span>, {
    name: <span style=color:#FFF066>"Frank"</span>,
    count: <span style=color:#AE81FF>30</span>,
    colors: [<span style=color:#FFF066>"red"</span>, <span style=color:#FFF066>"green"</span>, <span style=color:#FFF066>"blue"</span>],
  });
});

<span style=color:#FFFFFF>app</span>.<span style=color:#A6E22E>listen</span>(<span style=color:#AE81FF>8080</span>);
</pre><blockquote class=null><p><strong>Note</strong>: Older versions of <code>@marko/express</code> used to also attach Express’s <code>app</code>, <code>req</code>, and <code>res</code> objects onto <code>&#36;global</code>. This meant uncontrolled network data could cause new and exciting surprises in your app code. Nowadays we recommend explicitly accessing the specific pieces of the HTTP exchange you’re interested in, like this:</p><pre class=highlighted style=color:#D0D0E0;background-color:#202034><span style=color:#FFFFFF>app</span>.<span style=color:#A6E22E>get</span>(<span style=color:#FFF066>"/"</span>, <span style=color:#66D9EF>function</span> (<span style=color:#FFAC4D>req</span>, <span style=color:#FFAC4D>res</span>) {
  <span style=color:#FFFFFF>res</span>.<span style=color:#A6E22E>marko</span>(<span style=color:#FFFFFF>template</span>, {
    params: <span style=color:#FFFFFF>req</span>.<span style=color:#FFFFFF>params</span>,
    submitted: <span style=color:#FFFFFF>req</span>.<span style=color:#FFFFFF>method</span> <span style=color:#FF4185>===</span> <span style=color:#FFF066>"POST"</span> <span style=color:#FF4185>&&</span> <span style=color:#FFFFFF>req</span>.<span style=color:#FFFFFF>body</span>,
  });
});
</pre></blockquote><h3 id=byob-bring-your-own-bundler><a name=byob-bring-your-own-bundler class=anchor href=#byob-bring-your-own-bundler><span class=header-link></span></a>BYOB (Bring Your Own Bundler)</h3><p>Most of Marko’s API requires a bundler: the example code above assumes that <code>.marko</code> files can be <code>import</code>ed in your environment. <a href="/docs/bundler-integrations-overview/">Check out Marko’s supported bundlers</a> to see what works best for you.</p><a href="https://github.com/marko-js/marko/blob/main/packages/marko/docs/express.md" class=edit-on-github>EDIT <img alt="on GitHub" src=/assets/0bc571bc.svg></a><h2 id=contributors><a name=contributors class=anchor href=#contributors><span class=header-link></span></a> Contributors</h2><p>Helpful? You can thank these awesome people! You can also <a href=https://github.com/marko-js/marko/blob/main/packages/marko/docs/express.md>edit this doc</a> if you see any issues or want to improve it.</p><div class=contributors><a href=https://github.com/DylanPiercey class=contributor><img src=https://avatars.githubusercontent.com/u/4985201?v=4 alt class=photo><span class=name>DylanPiercey</span></a><a href=https://github.com/acrodrig class=contributor><img src=https://avatars.githubusercontent.com/u/959336?v=4 alt class=photo><span class=name>acrodrig</span></a><a href=https://github.com/mlrawlings class=contributor><img src=https://avatars.githubusercontent.com/u/1958812?v=4 alt class=photo><span class=name>mlrawlings</span></a><a href=https://github.com/tigt class=contributor><img src=https://avatars.githubusercontent.com/u/8072522?v=4 alt class=photo><span class=name>tigt</span></a><a href=https://github.com/marko-js/marko/blob/main/packages/marko/docs/express.md class="contributor you"><div class=photo><span class=icon>+</span></div><span class=name>You?</span></a></div><footer class="site-footer doc-footer"><a href="https://openjsf.org/" class=openjsf><img src=/assets/6876aea9.svg alt> <span><span class=bold>OpenJS</span>&nbsp;<span class=light>Foundation</span></span></a><div class=separator></div><a href=https://github.com/marko-js/marko/blob/main/LICENSE class=osi><img src=/assets/1b70b500.svg alt> MIT&nbsp;License</a><div class=separator></div><a href=https://github.com/eBay class=ebay><img src=/assets/339b8a9e.svg alt=eBay> open&nbsp;source</a></footer></div></div></div></main><script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-66854919-1', 'markojs.com');
    ga('send', 'pageview');
  </script><a href=https://discord.gg/marko target=_blank class=discord-button><img src=/assets/78800ea4.svg alt="Chat in Marko's Discord Server"></a><script>$MC=(window.$MC||[]).concat({"l":1,"w":[["s0-1-0-14",0,{}],["s0-1-0-14-12",1,{}],["s0-1-0-15",2,{"currentDoc":"express"}],["s0-1-0-15-9",3,{}]],"t":["IZr$9Bl","uja7Vjk","G0dDyNr","wIkyy5p"]})</script></body></html>