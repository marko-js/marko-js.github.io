<!doctype html><html lang=en><head><meta charset=UTF-8><title>Upgrading to Marko 5 | Marko</title><link rel=icon type=image/png sizes=32x32 href=/assets/d78b83f1.png><meta name=viewport content="width=device-width, initial-scale=1"><meta name=description content="Marko is a friendly (and fast!) UI library that makes building web apps fun."><script>
      if (window.self !== window.top) {
        document.documentElement.classList.add("iframe");
      }
    </script><script src="/assets/666.f6fc0204.js" async></script><script src="/assets/323.1c2c69d2.js" async></script><script src="/assets/987.ae467f67.js" async></script><link rel="stylesheet" href="/assets/69bfda3f.css"></head><body class=docs><a href=#main id=skip-link>Skip to main content</a><!--M#s0-1-0-11--><header data-marko-key="@header s0-1-0-11" class=site-header><div class=content><a href=/ ><img src=/assets/91bc26e5.svg alt="Marko Home" class=site-logo></a><div class=stuff><nav class=site-menu><a href=/docs/getting-started/ >Docs</a><a href=/try-online>Try Online</a><a href=https://github.com/marko-js/marko>GitHub</a><form class="SiteSearch search" role=search action=https://google.com/search><svg width=1em height=1em viewBox="0 0 64 64" fill=none stroke=#595959 stroke-width=5 focusable=false class=SiteSearch-icon><path d="M41 39a1 1 0 0 0-27-27 1 1 0 0 0 27 27l15 16-2 2-15-15" /></svg><input name=q type=search placeholder="search docsâ€¦" pattern=.*?\S+.*? title="Enter something to search for" required autocapitalize=off class=SiteSearch-input><button name=q value=site:markojs.com class=SiteSearch-submit>Go</button></form></nav><button data-marko='{"onclick":"toggleMenu s0-1-0-11 false"}' class=menu>&#9776;</button></div></div></header><!--M/--><!--M#s0-1-0-12--><div data-marko-key="@sidebar s0-1-0-12" class=doc-sidebar><button data-marko='{"onclick":"hide s0-1-0-12 false"}' class=close>&#10005;</button><h1>Marko <!--M^s0-1-0-12-9 s0-1-0-12 9--><select data-marko='{"onchange":"switchVersion s0-1-0-12-9 false"}'><option value=current selected>5.31.6</option><option value=http://marko-v4.github.io/docs/ >4.x</option><option value=http://v3.markojs.com/docs/ >3.x</option><option value=http://marko-v2.github.io/docs/ >2.x</option></select><!--M/--></h1><form class="SiteSearch search" role=search action=https://google.com/search><svg width=1em height=1em viewBox="0 0 64 64" fill=none stroke=#595959 stroke-width=5 focusable=false class=SiteSearch-icon><path d="M41 39a1 1 0 0 0-27-27 1 1 0 0 0 27 27l15 16-2 2-15-15" /></svg><input name=q type=search placeholder="search docsâ€¦" pattern=.*?\S+.*? title="Enter something to search for" required autocapitalize=off class=SiteSearch-input><button name=q value=site:markojs.com class=SiteSearch-submit>Go</button></form><ul class=toc-level0><li class=section><a href=/docs/guides-overview/ >GUIDES</a></li><li><a href=/docs/installing/ >Installing</a></li><li><a href=/docs/getting-started/ >Getting started</a></li><li><a href=/docs/conditionals-and-lists/ >Conditionals and lists</a></li><li><a href=/docs/custom-tags/ >Custom tags</a></li><li><a href=/docs/state/ >State</a></li><li><a href=/docs/styles/ >Styles</a></li><li><a href=/docs/events/ >Events</a></li><li><a href=/docs/body-content/ >Body content</a></li><li><a href=/docs/typescript/ >TypeScript</a></li><li><a class=selected href=/docs/marko-5-upgrade/ >Marko 5 upgrade</a><ul class="toc toc-level1"><li><a href="#step-0-ensure-youre-in-a-working-state-on-the-latest-version-of-marko-4">Step 0 - Ensure you&#39;re in a working state on the latest version of Marko 4</a></li><li><a href="#step-1-upgrade-dependencies">Step 1 - Upgrade dependencies</a></li><li><a href="#step-2-upgrade-marko">Step 2 - Upgrade Marko</a><ul class="toc toc-level2"><li><a href="#install-modules">Install Modules</a></li><li><a href="#app-entry-updates">App entry updates</a></li><li><a href="#submodule-updates">Submodule updates</a></li></ul></li><li><a href="#step-3-optional-but-recommended-deal-with-deprecations">Step 3 - Optional, but recommended: deal with deprecations</a></li></ul></li><li><a href=/docs/troubleshooting-streaming/ >Troubleshooting Streaming</a></li></ul><ul class=toc-level0><li class=section><a href=/docs/tutorials-overview/ >TUTORIALS</a></li><li><a href=/docs/color-picker/ >Color Picker</a></li></ul><ul class=toc-level0><li class=section><a href=/docs/reference-overview/ >REFERENCE</a></li><li><a href=/docs/rendering/ >Rendering</a></li><li><a href=/docs/syntax/ >Syntax</a></li><li><a href=/docs/core-tags/ >Core tags</a></li><li><a href=/docs/class-components/ >Class components</a></li><li><a href=/docs/marko-json/ >marko.json</a></li><li><a href=/docs/compiler/ >Compiler</a></li></ul><ul class=toc-level0><li class=section><a href=/docs/bundler-integrations-overview/ >BUNDLER INTEGRATIONS</a></li><li><a href=/docs/vite/ >Vite</a></li><li><a href=/docs/webpack/ >Webpack</a></li><li><a href=/docs/rollup/ >Rollup</a></li><li><a href=/docs/lasso/ >Lasso</a></li></ul><ul class=toc-level0><li class=section><a href=/docs/server-integrations-overview/ >SERVER INTEGRATIONS</a></li><li><a href=/docs/cloudflare-workers/ >Cloudflare Workers</a></li><li><a href=/docs/express/ >Express</a></li><li><a href=/docs/fastify/ >Fastify</a></li><li><a href=/docs/koa/ >Koa</a></li><li><a href=/docs/http/ >HTTP</a></li></ul><ul class=toc-level0><li class=section><a href=/docs/tooling-overview/ >TOOLING</a></li><li><a href=/docs/editor-plugins/ >Editor plugins</a></li></ul><ul class=toc-level0><li class=section><a href=/docs/articles-overview/ >ARTICLES</a></li><li><a href=/docs/marko-vs-react/ >Marko vs React</a></li><li><a href=/docs/why-is-marko-fast/ >Why is Marko Fast</a></li><li><a href=/docs/10-awesome-marko-features/ >10 Awesome Marko Features</a></li></ul></div><!--M/--><main id=main tabindex=-1 class=content><div class=doc-layout><div class=doc-container><div class=doc-content><h1 id=upgrading-to-marko-5><a name=upgrading-to-marko-5 class=anchor href=#upgrading-to-marko-5><span class=header-link></span></a>Upgrading to Marko 5</h1><p>The following guide will help you get through the upgrade process quickly and smoothly. This guide covers upgrading from Marko 4. If you are upgrading to Marko 5 from a previous version follow those docs first. After any given step you should have a working application.</p><p>This means you should complete a step and get it merged back into master fairly quickly. You shouldn&#39;t need to have a <code>marko-5-upgrade</code> branch for your project that lives in limbo for a couple of weeks falling behind the other changes that are being merged into master.</p><p>If you do decide to pause and later jump in where you left off, be sure to repeat Step 0 first ðŸ˜‰.</p><h2 id=step-0-ensure-youre-in-a-working-state-on-the-latest-version-of-marko-4><a name=step-0-ensure-youre-in-a-working-state-on-the-latest-version-of-marko-4 class=anchor href=#step-0-ensure-youre-in-a-working-state-on-the-latest-version-of-marko-4><span class=header-link></span></a>Step 0 - Ensure you&#39;re in a working state on the latest version of Marko 4</h2><p>Before we start, you&#39;ll want to make sure that you are already on the latest <code>4.x</code> release of <code>marko</code>.</p><script>if(localStorage.getItem('markojs-website:syntax') === 'concise'){document.body.classList.add('concise')}</script><pre class=highlighted style=color:#D0D0E0;background-color:#202034><span style=color:#8F8F9E># Upgrade using npm</span>
npm install marko@^4

<span style=color:#8F8F9E># Or with yarn</span>
yarn upgrade marko@^4
</pre><blockquote class=null><p><strong>Warning</strong> Do <em>not</em> run <code>npm install marko</code> (without the <code>@^4</code>). This will put you on Marko 5 and we&#39;re not quite there yet.</p></blockquote><p>Run your application and tests to ensure your project is in a working state. There&#39;s little worse than finding an issue after you&#39;ve started the upgrade process only to figure out the issue existed beforehand.</p><h2 id=step-1-upgrade-dependencies><a name=step-1-upgrade-dependencies class=anchor href=#step-1-upgrade-dependencies><span class=header-link></span></a>Step 1 - Upgrade dependencies</h2><p>Before upgrading to Marko 5, it is recommended to make sure that your Marko-related dependencies are up-to-date. Many packages have versions that support both Marko 4 and Marko 5. If one of your dependencies doesn&#39;t have a version that supports both, you&#39;ll need to wait to upgrade it until you&#39;re upgrading Marko.</p><p>After upgrading, run your application and tests to ensure that everything is still working as intended. If there are any issues, please refer to the changelogs of the modules you just upgraded to see if you need to make any changes within your app to accommodate the new versions.</p><h2 id=step-2-upgrade-marko><a name=step-2-upgrade-marko class=anchor href=#step-2-upgrade-marko><span class=header-link></span></a>Step 2 - Upgrade Marko</h2><p>Phew! With all the prep out of the way we&#39;re finally ready to upgrade <code>marko</code>!</p><h3 id=install-modules><a name=install-modules class=anchor href=#install-modules><span class=header-link></span></a>Install Modules</h3><p>Note that some features removed in Marko 4 do not log deprecations since they do not need to be resolved to get up and running with Marko 5. However for Marko 5 to support some of the features removed after Marko 4 you need to install a <code>compat</code> module.</p><p>There are currently two <code>compat</code> modules you can install, one which supports the <code>marko-widget</code>&#39;s api from Marko@3 and one with just the compat needed for Marko@4 components.</p><p><strong>For apps with <code>marko-widgets</code> installed, add the following modules:</strong></p><pre class=highlighted style=color:#D0D0E0;background-color:#202034><span style=color:#8F8F9E># Upgrade using npm</span>
npm install marko@^5 @marko/compiler marko-widgets@^8

<span style=color:#8F8F9E># Or with yarn</span>
yarn install marko@^5 @marko/compiler marko-widgets@^8
</pre><p><strong>For apps which were not using the Marko@3 compat layer, add the following modules:</strong></p><pre class=highlighted style=color:#D0D0E0;background-color:#202034><span style=color:#8F8F9E># Upgrade using npm</span>
npm install marko@^5 @marko/compiler @marko/compat-v4

<span style=color:#8F8F9E># Or with yarn</span>
yarn install marko@^5 @marko/compiler @marko/compat-v4
</pre><h3 id=app-entry-updates><a name=app-entry-updates class=anchor href=#app-entry-updates><span class=header-link></span></a>App entry updates</h3><p>If you&#39;re bundling your server code (common with <code>webpack</code> setups), your entry will be your bundler config. Otherwise it&#39;s probably something like <code>index.js</code> or <code>server.js</code> near your project root.</p><ul><li><p>Register your compat module globally so that any dependencies also run through the compat layer:</p><pre class=highlighted style=color:#D0D0E0;background-color:#202034><span style=color:#A6E22E>require</span>(<span style=color:#FFF066>"@marko/compiler"</span>).<span style=color:#FFFFFF>taglib</span>.<span style=color:#A6E22E>register</span>(<span style=color:#FFF066>"marko-widgets"</span>);
</pre><blockquote class=null><p><strong>Note</strong> if using <code>webpack</code> or <code>rollup</code> this line should also be added you your bundler config file</p></blockquote><blockquote class=null><p><strong>Note</strong> if using <code>jest</code> you should pass the <a href=https://github.com/marko-js/jest#customizing-the-marko-compiler><code>register</code> option</a> which requires the latest version of <code>jest</code> and <code>@marko/jest</code></p></blockquote></li><li><p><em>If you&#39;re using <code>babel</code></em>, Marko 5 picks up on your babel config which could change behavior. You may want to configure Marko to ignore your babel config:</p><pre class=highlighted style=color:#D0D0E0;background-color:#202034><span style=color:#A6E22E>require</span>(<span style=color:#FFF066>"@marko/compiler"</span>).<span style=color:#A6E22E>configure</span>({
  babelConfig: {
    babelrc: <span style=color:#AE81FF>false</span>,
    configFile: <span style=color:#AE81FF>false</span>,
  },
});
</pre><p>If you do this, you&#39;ll also want also want to pass the <code>babelConfig</code> option to your bundler plugin (<code>lasso-marko</code>, <code>@marko/webpack</code>, <code>@marko/rollup</code>)</p></li></ul><h3 id=submodule-updates><a name=submodule-updates class=anchor href=#submodule-updates><span class=header-link></span></a>Submodule updates</h3><p>A couple submodules no longer exist in Marko 5:</p><ul><li><em>If you&#39;re using the require hook</em>, replace <code>marko/node-require</code>:<pre class=highlighted style=color:#D0D0E0;background-color:#202034>- require('marko/node-require').install();
+ require('@marko/compiler/register');
</pre></li><li><em>If you&#39;re using <code>browser-refresh</code></em>, including the runtime is no longer necessary:<pre class=highlighted style=color:#D0D0E0;background-color:#202034>- require('marko/browser-refresh').enable();
</pre></li></ul><h2 id=step-3-optional-but-recommended-deal-with-deprecations><a name=step-3-optional-but-recommended-deal-with-deprecations class=anchor href=#step-3-optional-but-recommended-deal-with-deprecations><span class=header-link></span></a>Step 3 - Optional, but recommended: deal with deprecations</h2><p>Run your application and tests and ensure that there are no deprecation warnings logged to the console. If there are, you should follow the instructions in the deprecation messages to avoid the deprecated pattern and migrate to the recommended pattern.</p><p>Additionally, any deprecation warnings that start with <code>MIGRATION</code> are automatically migratable by <a href=https://github.com/marko-js/cli/blob/master/packages/migrate/README.md><code>marko migrate</code></a>. Most migrations are 100% safe and will run automatically. However, there are a few migrations which are considered unsafe: they may only get you 90% of the way there. These migrations will prompt and ask if you want to run the migration. It is highly recommended to run these only on a single component at a time and then finish the migration manually using the guide below so that your app is always in a working state.</p><blockquote class=null><p><strong>Note</strong> The <a href=https://dev.to/ryansolid/introducing-the-marko-tags-api-preview-37o4>TagsAPI</a> is becoming stable soon. Deprecations related to <code>marko-widgets</code>, might be worth holding off on rather than migrating these widgets to the Class Components API.</p></blockquote><a href=https://github.com/marko-js/marko/blob/main/packages/marko/docs/marko-5-upgrade.md class=edit-on-github>EDIT <img alt="on GitHub" src=/assets/0bc571bc.svg></a><h2 id=contributors><a name=contributors class=anchor href=#contributors><span class=header-link></span></a> Contributors</h2><p>Helpful? You can thank these awesome people! You can also <a href=https://github.com/marko-js/marko/blob/main/packages/marko/docs/marko-5-upgrade.md>edit this doc</a> if you see any issues or want to improve it.</p><div class=contributors><a href=https://github.com/DylanPiercey class=contributor><img src=https://avatars.githubusercontent.com/u/4985201?v=4 alt class=photo><span class=name>DylanPiercey</span></a><a href=https://github.com/mlrawlings class=contributor><img src=https://avatars.githubusercontent.com/u/1958812?v=4 alt class=photo><span class=name>mlrawlings</span></a><a href=https://github.com/tigt class=contributor><img src=https://avatars.githubusercontent.com/u/8072522?v=4 alt class=photo><span class=name>tigt</span></a><a class=contributor><img alt class=photo><span class=name></span></a><a href=https://github.com/marko-js/marko/blob/main/packages/marko/docs/marko-5-upgrade.md class="contributor you"><div class=photo><span class=icon>+</span></div><span class=name>You?</span></a></div><footer class="site-footer doc-footer"><a href=https://openjsf.org/  class=openjsf><img src=/assets/6876aea9.svg alt> <span><span class=bold>OpenJS</span>&nbsp;<span class=light>Foundation</span></span></a><div class=separator></div><a href=https://github.com/marko-js/marko/blob/main/LICENSE class=osi><img src=/assets/1b70b500.svg alt> MIT&nbsp;License</a><div class=separator></div><a href=https://github.com/eBay class=ebay><img src=/assets/339b8a9e.svg alt=eBay> open&nbsp;source</a></footer></div></div></div></main><script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-66854919-1', 'markojs.com');
    ga('send', 'pageview');
  </script><a href=https://discord.gg/marko target=_blank class=discord-button><img src=/assets/78800ea4.svg alt="Chat in Marko's Discord Server"></a><script>$MC=(window.$MC||[]).concat({"l":1,"w":[["s0-1-0-11",0,{}],["s0-1-0-12",1,{"currentDoc":"marko-5-upgrade","toc":"<ul class=\"toc toc-level1\"><li><a href=\"#step-0-ensure-youre-in-a-working-state-on-the-latest-version-of-marko-4\">Step 0 - Ensure you&#39;re in a working state on the latest version of Marko 4\u003C/a>\u003C/li><li><a href=\"#step-1-upgrade-dependencies\">Step 1 - Upgrade dependencies\u003C/a>\u003C/li><li><a href=\"#step-2-upgrade-marko\">Step 2 - Upgrade Marko\u003C/a><ul class=\"toc toc-level2\"><li><a href=\"#install-modules\">Install Modules\u003C/a>\u003C/li><li><a href=\"#app-entry-updates\">App entry updates\u003C/a>\u003C/li><li><a href=\"#submodule-updates\">Submodule updates\u003C/a>\u003C/li>\u003C/ul>\u003C/li><li><a href=\"#step-3-optional-but-recommended-deal-with-deprecations\">Step 3 - Optional, but recommended: deal with deprecations\u003C/a>\u003C/li>\u003C/ul>"}],["s0-1-0-12-9",2,{}]],"t":["OIKmBXjW","mFesaajv","07hv1F0+"]})</script></body></html>