(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[664],{"../../browser-shims sync recursive":e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id="../../browser-shims sync recursive",e.exports=t},"./playground/v6/index.marko?browser-entry":(e,t,r)=>{"use strict";var n={};r.r(n),r.d(n,{analyze:()=>tr,taglibs:()=>nr,translate:()=>rr});var a=r("../../node_modules/marko/dist/runtime/components/index.js"),o=(r("../components/app-layout/favicon.png"),r("../logos/marko.svg"),r("../components/app-layout/components/layout-search/search.png"),r("../components/app-layout/components/layout-search/component-browser.js")),s=r.n(o),i=r("../components/app-layout/components/layout-header/component-browser.js"),l=r.n(i),p=r("../components/app-layout/components/layout-sidebar/components/version-switcher/component-browser.js"),c=r.n(p),d=r("../components/app-layout/components/layout-sidebar/component-browser.js"),u=r.n(d),f=(r("../components/app-footer/openjsf.png"),r("../components/app-footer/osi.png"),r("../components/app-footer/ebay.svg"),r("../logos/discord.svg"),r("../../node_modules/marko/dist/runtime/vdom/index.js")),m=r("../../browser-shims/compiler/index.js"),y=r("../../node_modules/@marko/babel-utils/dist/index.js"),g=r("../../node_modules/path-browserify/index.js"),b=r.n(g),h=r("../../browser-shims sync recursive");function v(){return"html"===k().output}function x(){return!v()}function k(){return Fe.hub.file.markoOpts}function w(e){return{insert(t,r){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t){if(Array.isArray(t))return function(e,t,r){const n=t.length;let a=n,o=0;for(;o<a;){const n=o+a>>>1,s=e(t[n],r);if(0===s)return t;s>0?a=n:o=n+1}let s=r;for(;o<n;){const e=s;s=t[o],t[o++]=e}return t[n]=s,t}(e,n?[...t]:t,r);{const n=e(t,r);if(0!==n)return n<0?[t,r]:[r,t]}}return r},find(t,r){if(t)return Array.isArray(t)?t[function(e,t,r){let n=t.length,a=0;for(;a<n;){const o=a+n>>>1,s=e(t[o],r);if(0===s)return o;s>0?n=o:a=o+1}return-1}(e,t,r)]:t===r?t:void 0}}}var E=/^<.*>$|\.marko$/;function T(e){const t=e.node.extra??={};if(void 0===t.tagNameType){const r=e.get("name");if(r.isStringLiteral())t.tagNameType="@"===r.node.value[0]?3:(0,y.isNativeTag)(e)?0:1,t.tagNameNullable=t.tagNameNullable=!1;else{const e=[r];let n,a,o=!1;for(;(n=e.pop())&&2!==a;)if(n.isConditionalExpression())e.push(n.get("consequent")),n.node.alternate&&e.push(n.get("alternate"));else if(n.isLogicalExpression())"||"===n.node.operator?e.push(n.get("left")):o=!0,e.push(n.get("right"));else if(n.isAssignmentExpression())e.push(n.get("right"));else if(n.isBinaryExpression())a="+"!==n.node.operator||void 0!==a&&0!==a?2:0;else if(n.isStringLiteral()||n.isTemplateLiteral())a=void 0!==a&&0!==a?2:0;else if(n.isNullLiteral())o=!0;else if(n.isIdentifier()){if("undefined"===n.node.name){o=!0;continue}const t=n.scope.getBinding(n.node.name);if(!t){a=2;continue}if("module"===t.kind){const e=t.path.parent;a=E.test(e.source.value)&&e.specifiers.some((e=>m.types.isImportDefaultSpecifier(e)))?void 0!==a&&1!==a?2:1:2;continue}const r=t.path;if(r.isMarkoTag()&&"local"===t.kind){const n=r.get("name").node.value;if("tag"===n){a=void 0!==a&&1!==a?2:1;continue}if("const"===n){e.push(r.get("attributes")[0].get("value"));continue}if("let"===n){const n=r.get("attributes")[0];n.node?e.push(n.get("value")):o=!0;const s=t.constantViolations;for(let t=s.length;t--;){const r=s[t],{operator:n}=r.node;if("="===n)e.push(r.get("right"));else{if("+="!==n){a=2;break}a=void 0!==a&&0!==a?2:0}}}continue}a=2}else a=2;t.tagNameType=a,t.tagNameNullable=o,t.tagNameDynamic=!0}}return t.tagNameType}function S(e){const t=e.node.extra??={};let r=t.sectionId;if(void 0===r){const n=e.hub.file.path.node.extra??={},a=e.parent?.name,o=a?.value??a?.name??"dynamic";r=t.sectionId=n.nextSectionId||0,n.nextSectionId=r+1,n.sectionNames=n.sectionNames??[],n.sectionNames[r]=Fe.scope.generateUid(o+"Body")}return r}function C(e){let t=e;for(;;){if("Program"===t.type||"MarkoTagBody"===t.type&&0!==T(t.parentPath))return S(t);t=t.parentPath}}function D(e){let t,r=e;for(;void 0===(t=r.node.extra?.sectionId);)r=r.parentPath;return t}function A(e,t){return[r=>{const n=Fe.state[e]??=[];return n[r]??=t&&t(r)},(t,r)=>{(Fe.state[e]??=[])[t]=r}]}function N(e){const{nextSectionId:t}=Fe.node.extra;for(let r=0;r<t;r++)e(r)}var[M]=A("reservesByType",(()=>[void 0,void 0,void 0]));function L(e,t,r,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const o=r.extra??={};if(o.reserve){const e=o.reserve;if(a&&e.size)throw new Error("Unable to reserve multiple scopes for a node");return e.size=a,e.name+="_"+n,e}const s=M(t),i=o.reserve={id:0,type:e,size:a,name:n,sectionId:t};return s[e]?i.id=s[e].push(i)-1:s[e]=[i],i}function $(e,t){return e.sectionId-t.sectionId||e.type-t.type||e.id-t.id}var{insert:I}=w($),[F]=A("apply",(()=>[{sectionId:0,index:0,count:0,references:void 0,apply:m.types.identifier(""),hydrate:m.types.identifier("")}]));function j(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=t.scope,a=t.getBindingIdentifiers();for(const t in a){const o=n.getBinding(t).referencePaths,s=L(r,e,a[t],t);W(F(e),{sectionId:e,index:0,count:0,references:s,apply:m.types.identifier(""),hydrate:m.types.identifier("")});for(const e of o){const t=O(e.scope.path),r=B(t||e),n=r.parentPath;if(t){const e=t.node.id?.name;e||n.isMarkoAttribute()&&!n.node.default&&((t.node.extra??={}).name=n.node.name),P(t,"references",s)}P(n,`${r.listKey||r.key}References`,s)}}}function P(e,t,r){const n=C(e),a=(e.node.extra??={})[t],o=I(a?.references,r,!0);a&&a.count--,R(n,r),e.node.extra[t]=R(n,o)}function U(e,t){let r;for(const[n,a]of t){const t=n[a],o=t.references;if(delete n[a],t.count--,e=t.sectionId,o)if(Array.isArray(o))for(const e of o)r=I(r,e);else r=I(r,o)}return R(e,r)}function R(e,t){const r={sectionId:e,index:0,count:1,references:t,apply:m.types.identifier(""),hydrate:m.types.identifier("")},n=F(e),a=q(n,r);return a?a.count++:W(n,r),a??r}function B(e){let t=e;for(;!_(t.parentPath);)t=t.parentPath;return t}function O(e){let t=e;if(!t.isProgram()){for(;!z(t);){if(_(t))return;t=t.parentPath}return t}}function _(e){switch(e.type){case"MarkoTag":case"MarkoTagBody":case"MarkoAttribute":case"MarkoSpreadAttribute":case"MarkoPlaceholder":case"MarkoScriptlet":return!0;default:return!1}}function z(e){switch(e.type){case"FunctionExpression":case"ArrowFunctionExpression":return!0;default:return!1}}var{insert:W,find:q}=w((function(e,t){let{references:r}=e,{references:n}=t;if(r){if(n){if(Array.isArray(r)){if(Array.isArray(n)){const e=r.length,t=e-n.length;if(0!==t)return t;for(let t=0;t<e;t++){const e=$(r[t],n[t]);if(0!==e)return e}return 0}return 1}return Array.isArray(n)?-1:$(r,n)}return 1}return n?-1:0}));function V(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=r?F(e):Fe.node.extra.referenceGroups[e];let a;if(a="number"==typeof t?n[t]:q(n,{references:t}),!a)throw new Error(`Reference group not found for section ${e}: ${t}`);return a}function H(e,t,r){let n=e+(t?Fe.node.extra.sectionNames[t].replace("_","$"):"");if(r)if(Array.isArray(r)){n+="With";for(const e of r)n+=`_${e.name}`}else n+=`_${r.name}`;return Fe.scope.generateUid(n)}function G(e){const{output:t}=k();return(0,y.importNamed)(Fe.hub.file,K(t),e)}function Z(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return m.types.callExpression(G(e),r.filter(Boolean))}function J(){return h(K("html"))}function K(e){const{optimize:t}=k();return`@marko/runtime-fluurt/${t?"dist":"dist/debug"}/${"html"===e?"html":"dom"}`}function X(e,t){return m.types.memberExpression(Y(e,t),m.types.numericLiteral(e.id),!0)}function Y(e,t){const r=e.sectionId!==t?1:0;let n=je;for(let e=0;e<r;e++)n=m.types.memberExpression(n,m.types.identifier("_"));return n}var[Q]=A("applyStatements",(()=>[])),[ee]=A("hydrateStatements",(()=>[])),[te,re]=A("queue");function ne(e,t){re(D(e.get("body")),t)}function ae(e,t,r,n){const a=r?.index??0,o="apply"===e?Q(t):ee(t),s=o[a]??=[];Array.isArray(n)?s.push(...n):s.push(n)}function oe(e,t){const{markoOpts:{optimize:r},opts:{filename:n}}=Fe.hub.file;let a="";if(t)if(Array.isArray(t))for(const e of t)a+=`_${e.name}`;else a+=`_${t.name}`;return(0,y.getTemplateId)(r,`${n}_${e}${a}`)}var[se]=A("closurePriorities",(()=>[]));function ie(e,t){ae("hydrate",e,t,void 0)}function le(e){const t=C(e),r=ee(t);if(e.unshiftContainer("body",m.types.variableDeclaration("const",[m.types.variableDeclarator(je,Z("nextScopeId"))])),!r.length)return;const n=[];for(let a=r.length;a--;)if(r[a]?.length){const{references:r}=V(t,a);if(r)if(Array.isArray(r))for(const e of r)I(n,e);else I(n,r);e.pushContainer("body",m.types.expressionStatement(Z("writeHydrateCall",je,m.types.stringLiteral(oe(t,r)))))}e.pushContainer("body",m.types.expressionStatement(Z("writeHydrateScope",je,m.types.objectExpression(n.reduce(((e,t)=>(e.push(m.types.objectProperty(m.types.numericLiteral(t.id),m.types.identifier(t.name))),e)),[])))))}var pe={FunctionExpression:{exit:ce},ArrowFunctionExpression:{exit:ce}};function ce(e,t){let{root:r,sectionId:n}=t;const{node:a}=e,{extra:o}=a,s=o?.references?.references,i=e.hub.file.path.scope.generateUidIdentifier(o?.name);s&&("BlockStatement"!==a.body.type&&(a.body=m.types.blockStatement([m.types.returnStatement(a.body)])),a.body.body.unshift(m.types.variableDeclaration("const",(Array.isArray(s)?s:[s]).map((e=>m.types.variableDeclarator(m.types.identifier(e.name),X(e,n))))))),r.insertBefore(m.types.variableDeclaration("const",[m.types.variableDeclarator(i,a)])),a.params.unshift(je),e.replaceWith(Z("bind",je,i))}function de(e){const[t]=Q(e);return t?V(e,0).apply:m.types.nullLiteral()}function ue(e){const t=[],r=[];let n=e[0];for(let a=1;a<e.length;a++){let o=e[a];if("object"==typeof o){if(!m.types.isStringLiteral(o)){if(m.types.isTemplateLiteral(o)){let t=a+1;const r=o.expressions.length;me(e,t,o.quasis.length+r);for(let n=0;n<r;n++)e[t++]=o.quasis[n].value.raw,e[t++]=o.expressions[n];e[t]=o.quasis[r].value.raw;continue}r.push(o),t.push(n),n="";continue}o=o.value}n+=o}return r.length?(t.push(n),m.types.templateLiteral(t.map((e=>m.types.templateElement({raw:e}))),r)):n?m.types.stringLiteral(n):void 0}function fe(e,t){e[e.length-1]+=t}function me(e,t,r){for(let n=e.length-1;n>=t;n--)e[n+r]=e[n]}var[ye]=A("walks",(()=>[""])),[ge]=A("walkComment",(()=>[])),[be]=A("steps",(()=>[])),he={32:"get",33:"before",35:"after",36:"inside",37:"replace",38:"endChild",40:"skip",47:"beginChild",67:"next",97:"over",107:"out",117:"multiplier",46:"skipEnd",66:"beginChildEnd",91:"nextEnd",106:"overEnd",116:"outEnd",126:"multiplierEnd"};function ve(e){be(D(e)).push(0)}function xe(e){be(D(e)).push(1)}function ke(e){be(D(e)).push(0,1)}function we(e,t){const{reserve:r}=e.node.extra;if(t&&(!r||0!==r.type))throw e.buildCodeFrameError("Tried to visit a node that was not marked as needing to visit during analyze.");const n=D(e),a=be(n),o=ye(n),s=ge(n);if(t&&v())Ae(e)`${Z("markHydrateNode",je,m.types.numericLiteral(r.id))}`;else{let n="";if(a.length){const e=[];let t=0;for(const r of a)0===r?(t++,e.push(67)):(t--,t>=0?(e.length=e.lastIndexOf(67),e.push(97)):(e.length=e.lastIndexOf(107)+1,e.push(107),t=0));let r=e[0],o=0;for(const t of e)t!==r?(s.push(`${he[r]}(${o})`),n+=Ee(r,o),r=t,o=1):o++;s.push(`${he[r]}(${o})`),n+=Ee(r,o),a.length=0}void 0!==t&&(32!==t&&Ae(e)`<!>`,s.push(`${he[t]}`),n+=String.fromCharCode(t)),r?.size&&(s.push(`${he[40]}(${r.size})`),n+=Ee(40,r.size)),fe(o,n)}}function Ee(e,t){switch(e){case 67:case 47:return Te(t,e,20);case 97:case 107:return Te(t,e,10);case 40:return Te(t,e,7);default:throw new Error(`Unexpected walk code: ${e}`)}}function Te(e,t,r){let n="";if(e>=r){const t=Math.floor(e/r);n+=Te(t,117,10),e-=t*r}return n+=String.fromCharCode(t+e),n}function Se(e){const t=ue(ye(e))||m.types.stringLiteral("");return""!==t.value&&(t.leadingComments=[{type:"CommentBlock",value:" "+ge(e).join(", ")+" "}]),t}var[Ce]=A("renderer",(e=>{const t=Fe.node.extra.sectionNames[e];return m.types.identifier(t)})),[De]=A("writes",(()=>[""]));function Ae(e){const t=D(e);return function(e){const r=arguments.length<=1?0:arguments.length-1,n=De(t);fe(n,e[0]);for(let t=0;t<r;t++)n.push(t+1<1||arguments.length<=t+1?void 0:arguments[t+1],e[t+1])}}function Ne(e){const t=De(D(e)),r=ue(t);if(t.length=0,t[0]="",r)return m.types.expressionStatement(Z("write",r))}function Me(e){const t=Ne(e);t&&e.insertBefore(t)[0].skip()}function Le(e){const t=e.isProgram()?e:e.get("body"),r=Ne(t);r&&t.pushContainer("body",r)[0].skip()}function $e(e){const t=De(e);return{apply:de(e),walks:Se(e),writes:ue(t)||m.types.stringLiteral("")}}function Ie(e){return e.isImportDeclaration()||e.isExportDeclaration()||e.isMarkoScriptlet({static:!0})}var Fe,je,Pe={translate:{exit(e){Le(e),le(e);const t=[];for(const r of e.get("body"))Ie(r)?r.isMarkoScriptlet()&&r.replaceWithMultiple(r.node.body):(t.push(r.node),r.remove());const r=e.scope.generateUidIdentifier("renderer"),{attrs:n}=e.node.extra;e.pushContainer("body",[m.types.variableDeclaration("const",[m.types.variableDeclarator(r,m.types.arrowFunctionExpression([n?n.var:m.types.identifier("input")],m.types.blockStatement(t)))]),m.types.exportDefaultDeclaration(r),m.types.exportNamedDeclaration(m.types.variableDeclaration("const",[m.types.variableDeclarator(m.types.identifier("render"),Z("createRenderer",r))]))])}}},Ue={translate:{exit(e){we(e);const t=D(e),r=m.types.identifier("template"),n=m.types.identifier("walks"),a=m.types.identifier("apply"),o=m.types.identifier("applyAttrs"),{attrs:s}=e.node.extra,{walks:i,writes:l,apply:p}=$e(t);!function(e){const{nextSectionId:t}=Fe.node.extra;for(let r=t;r--;)e(r)}((e=>{!function(e){const t=ee(e);for(let r=t.length;r--;){const n=t[r];if(!n?.length)continue;const a=V(e,r),{references:o,hydrate:s}=a,i=o?(Array.isArray(o)?o:[o]).map((t=>m.types.assignmentPattern(m.types.identifier(t.name),X(t,e)))):[],[l]=Fe.pushContainer("body",[m.types.functionDeclaration(s,[je,...i],m.types.blockStatement(n)),m.types.expressionStatement(Z("register",m.types.stringLiteral(oe(e,o)),s))]);l.traverse(pe,{root:l,sectionId:e}),ae("apply",e,V(e,o),m.types.expressionStatement(Z("queueHydrate",je,s)))}}(e),function(e){const t=Q(e),r=Fe.node.extra.referenceGroups[e].length;if(!r)return;for(let n=r;n--;){const r=t[n]??[];if(0===n&&!r.length)continue;const a=V(e,n),{references:o,apply:s}=a,i=m.types.numericLiteral(n-1);let l,p;if(o)if(Array.isArray(o)){l=o.map((t=>m.types.assignmentPattern(m.types.identifier(t.name),X(t,e)))),p=m.types.blockStatement(r);for(const t of o)ae("apply",e,V(e,t),m.types.expressionStatement(Z("queue",je,s,i)))}else if(o.sectionId!==e){l=[m.types.assignmentPattern(m.types.identifier(o.name),X(o,e))],p=m.types.blockStatement(r);const t=te(e);if(t){const r=m.types.numericLiteral(NaN);se(o.sectionId).push(r),ae("apply",o.sectionId,V(o.sectionId,o),m.types.expressionStatement(t(a,r))),ae("apply",e,void 0,m.types.expressionStatement(Z("queue",je,s,i)))}}else{const e=m.types.identifier(o.name);l=[e],p=m.types.blockStatement([m.types.ifStatement(Z("write",je,m.types.numericLiteral(o.id),e),m.types.blockStatement(r))])}else l=[],p=m.types.blockStatement(r);const[c]=Fe.pushContainer("body",m.types.functionDeclaration(s,[je,...l],p));c.traverse(pe,{root:c,sectionId:e})}const n=se(e);for(let e=0;e<n.length;e++)n[e].value=e+t.length}(e)}));const c=[];if(N((e=>{if(e!==t){const{walks:t,writes:r,apply:n}=$e(e),a=Ce(e);c.push(m.types.variableDeclarator(a,Z("createRenderer",r,t,n)))}})),s){const r=[];e.node.body.push(m.types.exportNamedDeclaration(m.types.variableDeclaration("const",[m.types.variableDeclarator(o,m.types.functionExpression(null,[je,s.var],m.types.blockStatement(Object.keys(s.bindings).map((e=>{const n=s.bindings[e],{apply:a}=V(t,n.extra.reserve);return r.push(m.types.exportSpecifier(a,n.extra.reserve.exportIdentifier)),m.types.expressionStatement(m.types.callExpression(a,[je,n]))})))))])),m.types.exportNamedDeclaration(null,r))}e.node.body.push(m.types.exportNamedDeclaration(m.types.variableDeclaration("const",[m.types.variableDeclarator(r,l||m.types.stringLiteral(""))])),m.types.exportNamedDeclaration(m.types.variableDeclaration("const",[m.types.variableDeclarator(n,i||m.types.stringLiteral(""))])),m.types.exportNamedDeclaration(m.types.variableDeclaration("const",[m.types.variableDeclarator(a,m.types.isNullLiteral(p)?m.types.functionExpression(null,[],m.types.blockStatement([])):p)]))),c.length&&e.node.body.push(m.types.variableDeclaration("const",c)),e.node.body.push(m.types.exportDefaultDeclaration(Z("createRenderFn",r,n,a,s&&o)))}}},Re=new WeakMap,Be={migrate:{enter(e){Re.set(e,Fe),Fe=e},exit(){Fe.scope.crawl(),Fe=Re.get(Fe)}},analyze:{enter(e){Re.set(e,Fe),Fe=e,S(e)},exit(){N((e=>{let t=0;for(const r of M(e))if(r)for(const e of r)e.id=t,t+=e.size+1})),function(){const e=[];N((t=>{const r=F(t).filter((e=>e.count>0||!Array.isArray(e.references)));r.forEach(((e,r)=>{e.index=r,e.apply.name=H("apply",t,e.references),e.hydrate.name=H("hydrate",t,e.references)})),e[t]=r})),(Fe.node.extra??={}).referenceGroups=e}(),Fe=Re.get(Fe)}},translate:{enter(e){if(Re.set(e,Fe),Fe=e,je=e.scope.generateUidIdentifier("scope"),"hydrate"===k().output)return e.skip(),e.node.body=[m.types.importDeclaration([],m.types.stringLiteral(e.hub.file.opts.filename))],void((e.node.extra.hasInteractiveChild||e.node.extra.isInteractive)&&e.node.body.push(m.types.expressionStatement(Z("init"))))},exit(e){v()?Pe.translate.exit(e):Ue.translate.exit(e),Fe=Re.get(Fe)}}},Oe={translate:{exit(e){const t=e.get("source"),r=t.node.value;t.node.value=(0,y.resolveTagImport)(t,r)||r}}},_e={translate(e){v()&&Ae(e)`<!${e.node.value}>`,e.remove()}},ze={translate(e){v()&&Ae(e)`<?${e.node.value}?>`,e.remove()}},We={translate(e){v()&&Ae(e)`<![CDATA[${e.node.value}]]>`,e.remove()}},qe={translate(e){Ae(e)`${e.node.value}`,ke(e),e.remove()}};function Ve(e,t){if(!e)return!1;const{node:r}=t,n=Ge(e)?e.default:e;return Ze(n)?n(t,m.types):n.enter&&n.enter(t,m.types),r!==t.node}function He(e,t){if(!e)return!1;const{node:r}=t,n=Ge(e)?e.default:e;return!Ze(n)&&n.exit&&n.exit(t,m.types),r!==t.node}function Ge(e){return Boolean(e.default)}function Ze(e){return"function"==typeof e}var Je=/^[0-9A-Z_$]+$/i;function Ke(e){return Je.test(e)?m.types.identifier(e):m.types.stringLiteral(e)}function Xe(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{node:r}=e;let n=m.types.objectExpression([]);const a=n.extra={};for(const e of r.attributes){const t=e.value;m.types.isMarkoSpreadAttribute(e)?n.properties.push(m.types.spreadElement(t)):n.properties.push(m.types.objectProperty(Ke(e.name),t))}if(t){const{body:t,params:a}=r.body;let o=r.extra.hoistedControlFlows;if(o)for(const t of e.get("body").get("body"))if(e.insertBefore(t.node),t.remove(),(t.isConditional()||t.isLoop())&&!--o)break;t.length&&n.properties.push(m.types.objectMethod("method",m.types.identifier("renderBody"),a,m.types.blockStatement(t)))}if(n.properties.length){if(1===n.properties.length){const[e]=n.properties;m.types.isSpreadElement(e)&&(n=e.argument,n.extra=a)}return n}}function Ye(e){if(m.types.isObjectExpression(e)){const t=e.properties[e.properties.length-1];if(m.types.isObjectMethod(t)&&"renderBody"===t.key.name)return t}}function Qe(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"const";const{node:{var:n}}=e;n&&(e.get("var").remove(),e.insertBefore(m.types.variableDeclaration(r,[m.types.variableDeclarator(m.types.cloneDeep(n),t)])),e.hub.file.path.scope.crawl())}function et(e){let{extra:t}=e.node;if(t||(t=e.node.extra={}),void 0===t.confident){const r=e.get("value"),{confident:n,value:a}=r.evaluate();t.computed=a,t.confident=n}return t}var tt={analyze:{enter(e){const{node:t}=e,r=e.get("attributes");let n=e.has("var")?C(e):void 0;if(r.some(rt));else for(const t of r){const r=t.node,{name:a}=r;a.startsWith("on")?(n??=C(e),(Fe.node.extra??{}).isInteractive=!0):et(t).confident||(n??=C(e))}void 0!==n&&L(0,n,t,t.name.value)}},translate:{enter(e){const{extra:t}=e.node,r=v(),n=e.get("name"),a=e.get("attributes"),o=(0,y.getTagDef)(e),s=a.some((e=>e.isMarkoSpreadAttribute())),i=Ae(e),l=D(e);let p;if(r&&(t.tagNameNullable&&Me(e),Qe(e,m.types.unaryExpression("void",m.types.numericLiteral(0)))),t.reserve&&(p=m.types.numericLiteral(t.reserve.id),we(e,32)),i`<${n.node}`,s){const t=Z("attrs",je,Xe(e));r?i`${t}`:e.insertBefore(m.types.expressionStatement(t))}else for(const e of a){const t=e.node.name,n=e.node.extra??{},a=e.get("value"),{confident:o,computed:s,valueReferences:c}=n;switch(t){case"class":case"style":{const e=`${t}Attr`;o?i`${J()[e](s)}`:r?i`${Z(e,a.node)}`:ae("apply",l,c,m.types.expressionStatement(Z(e,m.types.memberExpression(je,p,!0),a.node)));break}default:o?i`${J().attr(t,s)}`:r?t.startsWith("on")?ie(l,n.valueReferences):i`${Z("attr",m.types.stringLiteral(t),a.node)}`:t.startsWith("on")?ae("hydrate",l,n.valueReferences,m.types.expressionStatement(Z("on",m.types.memberExpression(je,p,!0),m.types.stringLiteral(t.slice(2)),a.node))):ae("apply",l,c,m.types.expressionStatement(Z("attr",m.types.memberExpression(je,p,!0),m.types.stringLiteral(t),a.node)))}}let c=!1;if(o&&o.parseOptions?.openTagOnly){switch(o.htmlType){case"svg":case"math":i`/>`;break;default:i`>`}c=!0}else e.node.body.body.length?i`>`:(i`></${n.node}>`,c=!0);r&&t.tagNameNullable&&e.insertBefore(m.types.ifStatement(n.node,Ne(e)))[0].skip(),c?(ke(e),e.remove()):ve(e)},exit(e){const{extra:t}=e.node,r=v();r&&t.tagNameNullable&&Le(e),e.insertBefore(e.node.body.body).forEach((e=>e.skip())),Ae(e)`</${e.node.name}>`,r&&t.tagNameNullable&&e.insertBefore(m.types.ifStatement(e.node.name,Ne(e)))[0].skip(),xe(e),e.remove()}}};function rt(e){return"MarkoSpreadAttribute"===e.type}var nt={analyze:{enter(e){!function(e){e.has("var")&&j(C(e),e.get("var"));const t=e.get("body");t.get("body").length&&t.get("params").length&&j(C(t),t)}(e);const t=e.get("body");t.get("body").length&&S(t),(0,y.getTagDef)(e)?.template&&L(1,C(e),e.node,"child");const r=(0,y.loadFileForTag)(e)?.ast.program.extra;(r?.isInteractive||r?.hasInteractiveChild)&&((Fe.node.extra??{}).hasInteractiveChild=!0)},exit(e){const t=(0,y.getTagDef)(e)?.template,r=C(e);t&&(e.node.extra.attrsReferences=U(r,e.node.attributes.filter((e=>e.extra?.valueReferences)).map((e=>[e.extra,"valueReferences"]))))}},translate:{enter(e){we(e),v()&&Me(e)},exit(e){const t=D(e),r=e.get("body"),n=D(r),a=v(),{node:o}=e,s=Ae(e),i=o.extra.reserve;let l,p;if(a&&(Le(e),le(r)),m.types.isStringLiteral(o.name)){const{file:t}=e.hub,r=o.name.value,n=t.metadata.marko.tags,c=(0,y.getTagDef)(e)?.template,d=c&&(0,y.resolveRelativePath)(t,c),u=(0,y.loadFileForTag)(e).ast.program;if(!d)throw e.get("name").buildCodeFrameError(`Unable to find entry point for custom tag <${r}>.`);a?l=(0,y.importDefault)(t,d,r):(l=(0,y.importNamed)(t,d,"apply",r),u.extra.attrs&&(p=(0,y.importNamed)(t,d,"applyAttrs",`${r}_attrs`)),s`${(0,y.importNamed)(t,d,"template",`${r}_template`)}`,function(e,t,r){const n=ye(D(e));ge(D(e)).push(`${he[47]}(${t})`,r.name,he[38]),fe(n,Ee(47,t)),n.push(r,String.fromCharCode(38))}(e,i.id,(0,y.importNamed)(t,d,"walks",`${r}_walks`))),n.includes(d)||n.push(d)}else l=o.name;const c=o.var,d=Xe(e,!0),u=Ye(d);if(a&&o.extra.tagNameNullable){let t,r=ot(l,Xe(e));if(u){t=e.scope.generateUidIdentifier("renderBody");const[r]=e.insertBefore(m.types.functionDeclaration(t,u.params,u.body));r.skip(),d.properties[d.properties.length-1]=m.types.objectProperty(m.types.identifier("renderBody"),t)}c&&(Qe(e,m.types.unaryExpression("void",m.types.numericLiteral(0)),"let"),r=m.types.assignmentExpression("=",c,r)),e.replaceWith(m.types.ifStatement(l,m.types.expressionStatement(r),t&&at(t)))[0].skip()}else if(a)c?(Qe(e,ot(l,d)),e.remove()):e.replaceWith(at(l,d))[0].skip();else{if(u){const{walks:e,writes:t}=$e(n);d.properties.pop(),d.properties.push(m.types.objectProperty(m.types.identifier("renderBody"),Z("createRenderer",t||m.types.stringLiteral(""),e||m.types.stringLiteral(""),m.types.arrowFunctionExpression(u.params,u.body))))}ae("apply",t,void 0,m.types.expressionStatement(m.types.callExpression(l,[X(i,t)]))),d&&p&&ae("apply",t,e.node.extra.attrsReferences,m.types.expressionStatement(m.types.callExpression(p,[X(i,t),d]))),e.remove()}}}};function at(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return m.types.expressionStatement(ot(e,...r))}function ot(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return m.types.callExpression(e,r.filter(Boolean))}function st(e){const t=e.body;return 1===t.length&&m.types.isExpressionStatement(t[0])?t[0].expression:m.types.isBlockStatement(e)?e:m.types.blockStatement(t)}var it={translate:{enter(e){v()&&Me(e)},exit(e){const{node:t}=e,r=D(e.get("body")),n=Xe(e,!0),a=Ye(n),o=[t.name,n||m.types.nullLiteral()];if(v()?Me(e):o.unshift(je),a){n.properties.pop();let e=m.types.arrowFunctionExpression(a.params,st(a.body));if(x()){const{walks:t,writes:n}=$e(r);e=Z("createRenderer",n||m.types.stringLiteral(""),t||m.types.stringLiteral(""),e)}o.push(e)}const s=Z("dynamicTag",...o);t.var?(Qe(e,s),e.remove()):v()?e.replaceWith(m.types.expressionStatement(s))[0].skip():e.remove()}}},lt={translate:{enter(e){if(function(e){const t=De(D(e));return Boolean(t.length>1||t[0])}(e))throw e.get("name").buildCodeFrameError("Dynamic @tags cannot be mixed with body content.")},exit(e){(0,y.assertNoVar)(e),Le(e);const t=(0,y.findParentTag)(e);if(!t)throw e.get("name").buildCodeFrameError("@tags must be nested within another tag.");const r=t.node.extra;if(0===r.tagNameType)throw e.get("name").buildCodeFrameError("@tags cannot be nested under native tags.");const n=e.node.name.value.slice(1),a=r.nestedAttributeTags[n],o=Xe(e,!0)||m.types.objectExpression([]);if(a.dynamic)a.identifier||(a.identifier=t.scope.generateUidIdentifier(n),t.insertBefore(a.repeated?m.types.variableDeclaration("const",[m.types.variableDeclarator(a.identifier,m.types.arrayExpression([]))]):m.types.variableDeclaration("let",[m.types.variableDeclarator(a.identifier)])),t.pushContainer("attributes",m.types.markoAttribute(n,a.identifier))),e.replaceWith(m.types.expressionStatement(a.repeated?m.types.callExpression(m.types.memberExpression(a.identifier,m.types.identifier("push")),[o]):m.types.assignmentExpression("=",a.identifier,o)));else if(a.repeated){const r=t.get("attributes").find((e=>e.node.name===n));r?r.get("value").pushContainer("elements",o):t.pushContainer("attributes",m.types.markoAttribute(n,m.types.arrayExpression([o]))),e.remove()}else t.pushContainer("attributes",m.types.markoAttribute(n,o)),e.remove()}}};function pt(e){const{extra:t}=e.node;t.nestedAttributeTags={},t.hoistedControlFlows=0,ct(t,!1,!1,e)}function ct(e,t,r,n){let a=!1;for(const o of n.get("body").get("body"))o.isMarkoTag()&&dt(e,t,r,o)&&(a=!0);return a}function dt(e,t,r,n){if((0,y.isTransparentTag)(n)){if(ct(e,t||(0,y.isLoopTag)(n),!0,n))return(0,y.isTransparentTag)(n.parentPath.parentPath)||e.hoistedControlFlows++,!0}else if((0,y.isAttributeTag)(n)){const a=n.node.name.value.slice(1),o=e.nestedAttributeTags,s=o[a],i=s||(o[a]={dynamic:!1,repeated:!1});return i.dynamic||=r,i.repeated||=t||void 0!==s,!0}return!1}var ut={analyze:{enter(e){const t=(0,y.getTagDef)(e)?.analyzer?.hook;if(t)Ve(t,e);else switch(T(e)){case 0:tt.analyze.enter(e);break;case 1:nt.analyze.enter(e)}},exit(e){const t=(0,y.getTagDef)(e),r=T(e),n=t?.analyzer?.hook;n?He(n,e):0!==r&&(pt(e),1===r)&&nt.analyze.exit(e)}},translate:{enter(e){const t=(0,y.getTagDef)(e),r=e.node.extra;if((0,y.assertNoArgs)(e),t?.translator)return t.translator.path&&e.hub.file.metadata.marko.watchFiles.push(t.translator.path),void Ve(t.translator.hook,e);for(const t of e.get("attributes"))if(t.isMarkoAttribute()){if(t.node.arguments)throw t.buildCodeFrameError(`Unsupported arguments on the "${t.node.name}" attribute.`);if(t.node.modifier){if(!(0,y.isNativeTag)(t.parentPath))throw t.buildCodeFrameError(`Unsupported modifier "${t.node.modifier}".`);t.node.name+=`:${t.node.modifier}`}}let{tagNameType:n}=r;if(r.tagNameDynamic){if(r.tagNameNullable&&!e.get("name").isIdentifier()){const t=e.scope.generateUidIdentifier("tagName"),[r]=e.insertBefore(m.types.variableDeclaration("const",[m.types.variableDeclarator(t,e.node.name)]));r.skip(),e.set("name",t)}2===n||v()||(n=2)}switch(n){case 0:tt.translate.enter(e);break;case 1:nt.translate.enter(e);break;case 2:it.translate.enter(e);break;case 3:lt.translate.enter(e)}},exit(e){const t=(0,y.getTagDef)(e)?.translator;if(t)return void He(t.hook,e);const{extra:r}=e.node;let{tagNameType:n}=r;switch(!r.tagNameDynamic||2===n||v()&&void 0!==n||(n=2),n){case 0:tt.translate.exit(e);break;case 1:nt.translate.exit(e);break;case 2:it.translate.exit(e);break;case 3:lt.translate.exit(e)}}}},ft="marko-core";function mt(e){return e.isMarkoTag()&&(0,y.getTagDef)(e)?.taglibId===ft}function yt(e,t){return mt(e)&&e.node.name.value===t}var gt={script:"escapeScript",style:"escapeStyle"},bt={analyze(e){const{node:t}=e,{confident:r,computed:n}=et(e);(!r||!t.escape&&n)&&(L(0,C(e),t,"placeholder"),function(e){let t=e.getPrevSibling();for(;t.node&&ht(t);)t=t.getPrevSibling();if((t.node||m.types.isProgram(e.parentPath))&&(!m.types.isMarkoTag(t)||!(0,y.isNativeTag)(t)))return e.node.extra.needsMarker=!0;let r=e.getNextSibling();for(;r.node&&ht(r);)r=r.getNextSibling();if((r.node||m.types.isProgram(e.parentPath))&&(!m.types.isMarkoTag(r)||!(0,y.isNativeTag)(r)))return e.node.extra.needsMarker=!0;e.node.extra.needsMarker=!1}(e))},translate(e){const t=v(),r=Ae(e),n=e.node.extra,{confident:a,computed:o,valueReferences:s,reserve:i}=n,l=t||a&&(e.node.escape||!o),p=l?e.node.escape?gt[function(e){let{parentPath:t}=e;return t.isMarkoTag()&&(0,y.isNativeTag)(t)&&t.node.name.value||""}(e)]||"escapeXML":"toString":e.node.escape?"data":"html";a&&l?r`${J()[p](o)}`:(n.needsMarker?we(e,37):(t||r` `,we(e,32)),t?r`${Z(p,e.node.value)}`:ae("apply",D(e),s,m.types.expressionStatement(Z(p,m.types.memberExpression(je,m.types.numericLiteral(i.id),!0),e.node.value)))),ke(e),e.remove()}};function ht(e){return m.types.isMarkoComment(e)||m.types.isMarkoTag(e)&&mt(e)&&["let","const","effect","lifecycle","attrs","get","id"].includes(e.node.name.value)}var vt={translate(e){if(v()){if(e.node.static)return;e.replaceWithMultiple(e.node.body)}else e.node.static?e.replaceWithMultiple(e.node.body):(ae("apply",D(e),e.node.extra?.bodyReferences,e.node.body),e.remove())}},xt=/^\[if |<!\[endif\]$/,kt={translate(e){if(v()){const{value:t}=e.node;xt.test(t)&&Ae(e)`<!--${t}-->`}e.remove()}},wt={parse(e){const{node:t}=e;e.replaceWith((0,y.parseScript)(e.hub.file,t.rawValue,t.start).body[0])},parseOptions:{rootOnly:!0,rawOpenTag:!0,openTagOnly:!0,ignoreAttributes:!0,relaxRequireCommas:!0},autocomplete:[{displayText:'import <scope> from "<path>"',description:"Use to import external modules, follows the same syntax as JavaScript imports.",snippet:'import ${2} from "${1:path}"',descriptionMoreURL:"https://markojs.com/docs/syntax/#importing-external-files"}]},Et={parse(e){const{node:t}=e;e.replaceWith((0,y.parseScript)(e.hub.file,t.rawValue,t.start).body[0])},parseOptions:{rootOnly:!0,rawOpenTag:!0,openTagOnly:!0,ignoreAttributes:!0,relaxRequireCommas:!0},autocomplete:[{displayText:"export <value>"}]},Tt={analyze(e){if(e.has("var")){const t=e.get("var"),r=t.getBindingIdentifiers(),n=C(e);j(n,t,2);for(const e in r){const t=r[e].extra.reserve;t.exportIdentifier=V(n,t,!0).apply}(Fe.node.extra??={}).attrs={bindings:r,var:t.node}}},translate(e){e.remove()},attributes:{},autocomplete:[{displayText:"attrs/{ ... }",description:"Use to receive the attributes passed into this template.",snippet:"attrs/{ $1 }$2"}]};function St(e){const t=e.body;return 1===t.length?t[0]:m.types.isBlockStatement(e)?e:m.types.blockStatement(t)}var Ct={analyze:{enter(e){L(0,C(e),e.node,"if",3),nt.analyze.enter(e)},exit(e){pt(e),Nt(e)}},translate:{enter(e){const{node:t}=e,[r]=t.attributes;if((0,y.assertNoVar)(e),(0,y.assertNoParams)(e),!m.types.isMarkoAttribute(r)||!r.default)throw e.get("name").buildCodeFrameError("The '<if>' tag requires a default attribute like '<if=condition>'.");if(t.attributes.length>1){const r=t.attributes[1].loc?.start,n=t.attributes[t.attributes.length-1].loc?.end,a="The '<if>' tag only supports a default attribute.";throw null==r||null==n?e.get("name").buildCodeFrameError(a):e.hub.buildError({loc:{start:r,end:n}},a,Error)}we(e,37),ke(e),v()&&Me(e)},exit(e){Mt(e)}},attributes:{},autocomplete:[{snippet:"if=${1:condition}",description:"Use to display content only if the condition is met.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#if-else-if-else"}]},Dt=new WeakMap;function At(e,t){const r=Dt.get(e)??[],n=e.getNextSibling(),a=!(yt(n,"else")||yt(n,"else-if"));return r.push({tag:e,sectionId:t}),a||Dt.set(n,r),[a,r]}function Nt(e){const t=C(e),r=C(e.get("body")),[n,a]=At(e,r);n&&(a[0].tag.node.extra.conditionalReferences=U(t,a.filter((e=>{let{tag:t}=e;return t.node.attributes[0]?.extra?.valueReferences})).map((e=>{let{tag:t}=e;return[t.node.attributes[0].extra,"valueReferences"]}))))}function Mt(e){const t=e.get("body"),r=D(t),[n,a]=At(e,r);if(v()&&(Le(e),le(t)),n)if(x()){const t=D(e),{extra:r}=a[0].tag.node;let n=m.types.nullLiteral();for(let e=a.length;e--;){const{tag:t,sectionId:o}=a[e],[s]=t.node.attributes,i=Ce(o);ne(t,((e,t)=>{let{apply:n,index:a}=e;return Z("queueInBranch",je,m.types.numericLiteral(r.reserve.id),Ce(o),n,m.types.numericLiteral(a),t)})),t.remove(),n=s?m.types.conditionalExpression(s.value,i,n):i}ae("apply",t,r.conditionalReferences,m.types.expressionStatement(Z("setConditionalRenderer",je,m.types.numericLiteral(r.reserve.id),n)))}else{const t=e.getNextSibling();let r;for(let e=a.length;e--;){const{tag:t}=a[e],[n]=t.node.attributes,o=St(t.node.body);r=n?m.types.ifStatement(n.value,o,r):o,t.remove()}t.insertBefore(r)}}var Lt={analyze:{enter(e){nt.analyze.enter(e)},exit(e){Nt(e)}},translate:{enter(e){const{node:t}=e,[r]=t.attributes;if((0,y.assertNoVar)(e),(0,y.assertNoParams)(e),!m.types.isMarkoAttribute(r)||!r.default)throw e.get("name").buildCodeFrameError("The '<else-if>' tag requires a default attribute like '<else-if=condition>'.");if(t.attributes.length>1){const r=t.attributes[1].loc?.start,n=t.attributes[t.attributes.length-1].loc?.end,a="The '<else-if>' tag only supports a default attribute.";throw null==r||null==n?e.get("name").buildCodeFrameError(a):e.hub.buildError({loc:{start:r,end:n}},a,Error)}},exit(e){Mt(e)}},attributes:{},autocomplete:[{snippet:"else-if=${1:condition}",description:"Use after an <if> or <else-if> tag to display content if those conditions do not match and this one does.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#if-else-if-else"}]},$t={analyze:{enter(e){nt.analyze.enter(e)},exit(e){Nt(e)}},translate:{enter(e){const{node:t}=e,[r]=t.attributes;if((0,y.assertNoVar)(e),(0,y.assertNoParams)(e),t.attributes.length>1||r&&"if"!==r.name){const r=t.attributes[1].loc?.start,n=t.attributes[t.attributes.length-1].loc?.end,a="The '<else>' tag only supports an if attribute.";throw null==r||null==n?e.get("name").buildCodeFrameError(a):e.hub.buildError({loc:{start:r,end:n}},a,Error)}},exit(e){Mt(e)}},attributes:{},autocomplete:[{description:"Use after an <if> or <else-if> tag to display content if those conditions do not match.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#if-else-if-else"}]};function It(e){for(const t of e.get("attributes"))if(t.isMarkoSpreadAttribute())throw t.buildCodeFrameError(`The <${e.get("name")}> tag does not support ...spread attributes.`)}function Ft(e){if(e.node.body.body.length)throw e.get("name").buildCodeFrameError(`The <${e.get("name")}> tag does not support body content.`)}var jt={translate(e){const{node:t}=e,[r]=t.attributes;if((0,y.assertNoParams)(e),Ft(e),!t.var)throw e.get("name").buildCodeFrameError("The 'const' tag requires a tag variable.");if(!r)throw e.get("name").buildCodeFrameError("The 'const' tag requires a default attribute.");if(t.attributes.length>1||!m.types.isMarkoAttribute(r)||!r.default&&"default"!==r.name)throw e.get("name").buildCodeFrameError("The 'const' tag only supports the 'default' attribute.");if(x()){const n=D(e),a=Object.values(e.get("var").getBindingIdentifiers());ae("apply",n,r.extra?.valueReferences,1===a.length?m.types.expressionStatement(m.types.callExpression(V(n,a[0].extra.reserve).apply,[je,r.value])):[m.types.variableDeclaration("const",[m.types.variableDeclarator(t.var,r.value)]),...a.map((e=>m.types.expressionStatement(m.types.callExpression(V(n,e.extra.reserve).apply,[m.types.identifier(e.name)]))))])}else Qe(e,r.value);e.remove()},attributes:{},autocomplete:[{description:"Use to create an constant binding.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#const"}]},Pt={analyze(e){L(1,D(e),e.node,"cleanup"),(Fe.node.extra??{}).isInteractive=!0},translate(e){const{node:t}=e,[r]=t.attributes;if((0,y.assertNoParams)(e),Ft(e),!r)throw e.get("name").buildCodeFrameError("The 'effect' tag requires a default attribute.");if(t.attributes.length>1||!m.types.isMarkoAttribute(r)||!r.default&&"default"!==r.name)throw e.get("name").buildCodeFrameError("The 'effect' tag only supports the 'default' attribute.");const n=D(e);if(x()){const t=e.node.extra.reserve.id,{value:a}=r;let o=null;(m.types.isFunctionExpression(a)||m.types.isArrowFunctionExpression(a)&&m.types.isBlockStatement(a.body))&&(o=a.body.body,m.types.traverse(a.body,(e=>{m.types.isReturnStatement(e)&&(o=null)}))),ae("hydrate",n,r.extra?.valueReferences,o||m.types.expressionStatement(Z("userEffect",je,m.types.numericLiteral(t),r.value)))}else ie(n,r.extra?.valueReferences);e.remove()},attributes:{},autocomplete:[{description:"Use to create a side effects.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#effect"}]},Ut={analyze:{enter(e){const t=function(e){return e.node.extra??={},m.types.isMarkoTag(e.parentPath?.parent)&&(0,y.getTagDef)(e.parentPath.parentPath)?.html?e.node.extra.isOnlyChild=1===e.parent.body.length:e.node.extra.isOnlyChild=!1}(e);L(0,C(e),t?e.parentPath.parent:e.node,"for",3),nt.analyze.enter(e)},exit(e){pt(e)}},translate:{enter(e){if(function(e){const t=e.node.attributes,r=e.node.body.params.length>0;if((0,y.assertNoVar)(e),Ot(t,"of")){if((0,y.assertAllowedAttributes)(e,["of","by"]),!r)throw e.buildCodeFrameError("Invalid 'for of' tag, missing |value, index| params.")}else if(Ot(t,"in")){if((0,y.assertAllowedAttributes)(e,["in","by"]),!r)throw e.buildCodeFrameError("Invalid 'for in' tag, missing |key, value| params.")}else{if(!Ot(t,"from")||!Ot(t,"to"))throw e.buildCodeFrameError("Invalid 'for' tag, missing an 'of', 'in' or 'to' attribute.");(0,y.assertAllowedAttributes)(e,["from","to","step","by"])}}(e),!v()&&Object.keys(e.node.extra.nestedAttributeTags).length)return void e.remove();const{extra:{isOnlyChild:t}}=e.node;t||(we(e,37),ke(e)),v()&&Me(e)},exit(e){v()?Bt.exit(e):Rt.exit(e)}},attributes:{of:{type:"expression",autocomplete:[{description:"Iterates over a list of items."}]},in:{type:"expression",autocomplete:[{description:"Iterates over the keys and values of an object."}]},to:{type:"number",autocomplete:[{description:"Iterates up to the provided number (inclusive)"}]},from:{type:"number",autocomplete:[{description:"Iterates starting from the provided number (inclusive)"}]},step:{type:"number",autocomplete:[{description:"The amount to increment during each interation (with from/to)"}]}},autocomplete:[{snippet:"for|${1:value, index}| of=${3:array}",description:"Use to iterate over lists, object properties, or between ranges.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#iterating-over-a-list"},{snippet:"for|${1:name, value}| in=${3:object}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#iterating-over-an-objects-properties"},{snippet:"for|${1:index}| from=${2:number} to=${3:number} step=${4:number}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#iterating-between-a-range-of-numbers"}]},Rt={exit(e){const t=D(e.get("body")),r=D(e),{node:n}=e,{attributes:a,body:{params:o},extra:{isOnlyChild:s}}=n,{extra:{reserve:i}}=s?e.parentPath.parent:e.node,l=Ot(a,"of"),p=Ot(a,"by");if(ne(e,((e,t)=>{let{apply:r,index:n}=e;return Z("queueForEach",je,m.types.numericLiteral(i.id),r,m.types.numericLiteral(n),t)})),l){const n=l.value,[a]=o;if(!m.types.isIdentifier(a))throw e.buildCodeFrameError("Invalid 'for of' tag, |value| parameter must be an identifier.");const s=Ce(t);e.remove(),ae("apply",r,l.extra?.valueReferences,m.types.expressionStatement(Z("setLoopOf",je,m.types.numericLiteral(i.id),n,s,p?p.value:m.types.nullLiteral(),V(t,a.extra.reserve).apply)))}}},Bt={exit(e){const t=e.get("body"),{node:r}=e,{attributes:n,body:{body:a,params:o}}=r,s=e.get("name"),i=Ot(n,"of"),l=Ot(n,"in"),p=Ot(n,"from"),c=Ot(n,"to"),d=m.types.blockStatement(a);let u;if(Le(e),le(t),l){const[e,t]=o;t&&d.body.unshift(m.types.variableDeclaration("const",[m.types.variableDeclarator(t,m.types.memberExpression(l.value,e,!0))])),u=m.types.forInStatement(m.types.variableDeclaration("const",[m.types.variableDeclarator(e)]),l.value,d)}else if(i){let t=i.value;const[r,n,a]=o;if(!r)throw s.buildCodeFrameError("Invalid 'for of' tag, missing |value, index| params.");if(u=[],n){const t=e.scope.generateUidIdentifierBasedOnNode(n,"i");u.push(m.types.variableDeclaration("let",[m.types.variableDeclarator(t,m.types.numericLiteral(0))])),d.body.unshift(m.types.variableDeclaration("let",[m.types.variableDeclarator(n,m.types.updateExpression("++",t))]))}a&&(m.types.isIdentifier(a)&&(t=a),u.push(m.types.variableDeclaration("const",[m.types.variableDeclarator(a,i.value)]))),u.push(m.types.forOfStatement(m.types.variableDeclaration("const",[m.types.variableDeclarator(r)]),t,d))}else if(p&&c){const t=Ot(n,"step")||{value:m.types.numericLiteral(1)},r=t?t.value:m.types.numericLiteral(1),[a]=o,s=e.scope.generateUidIdentifier("steps"),i=e.scope.generateUidIdentifier("step");a&&d.body.unshift(m.types.variableDeclaration("const",[m.types.variableDeclarator(a,m.types.binaryExpression("+",p.value,m.types.binaryExpression("*",i,r)))])),u=m.types.forStatement(m.types.variableDeclaration("let",[m.types.variableDeclarator(s,m.types.binaryExpression("/",m.types.binaryExpression("-",c.value,p.value),r)),m.types.variableDeclarator(i,m.types.numericLiteral(0))]),m.types.binaryExpression("<=",i,s),m.types.updateExpression("++",i),d)}d.body.push(m.types.expressionStatement(Z("maybeFlush"))),e.replaceWithMultiple([].concat(u))}};function Ot(e,t){return e.find((e=>m.types.isMarkoAttribute(e)&&e.name===t))}var _t={translate(e){(0,y.assertNoParams)(e),Ft(e),Me(e);const{node:t,hub:{file:r}}=e,[n]=t.attributes;let a;if(!t.var)throw e.get("name").buildCodeFrameError("<get> requires a variable to be defined, eg <get/NAME>.");if(void 0===n)a="$";else{if(!m.types.isMarkoAttribute(n)||!n.default||!m.types.isStringLiteral(n.value))throw e.get("name").buildCodeFrameError("The '<get>' tag requires default attribute that is a string that resolves to a Marko file like '<get/val=\"../file.marko\">' or '<get/val=\"<tag-name>\">'.");if(t.attributes.length>1){const r=t.attributes[1].loc?.start,n=t.attributes[t.attributes.length-1].loc?.end,a="The '<get>' tag only supports a default attribute.";throw null==r||null==n?e.get("name").buildCodeFrameError(a):e.hub.buildError({loc:{start:r,end:n}},a,Error)}const o=e.get("attributes")[0].get("value");if("."===n.value.value)a=r.metadata.marko.id;else{const e=(0,y.resolveTagImport)(o,o.node.value);if(!e)throw o.buildCodeFrameError("Unable to resolve template provided to '<get>' tag.");a=(0,y.getTemplateId)(r.markoOpts.optimize,b().resolve(r.opts.filename,"..",e))}}v()?e.replaceWith(m.types.variableDeclaration("const",[m.types.variableDeclarator(t.var,Z("getInContext",m.types.stringLiteral(a)))])):e.remove()},autocomplete:[{displayText:'get/<name>="<from>"',description:"Gets a value provided from another template.",snippet:'get/${1:name}="${2:from}"',descriptionMoreURL:"https://markojs.com/docs/core-tags/#get"}]},zt={analyze(){},translate:{enter(e){ve(e),Ae(e)`<!--`},exit(e){(0,y.assertNoVar)(e),(0,y.assertNoParams)(e),(0,y.assertNoAttributes)(e),(0,y.assertNoAttributeTags)(e),xe(e),Ae(e)`-->`,e.remove()}},parseOptions:{state:"parsed-text"},attributes:{},autocomplete:[{description:"Use to create an html comment that is not stripped from the output.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#html-comment"}]},Wt={translate(e){const{node:t}=e,r=t.var,[n]=t.attributes;if((0,y.assertNoParams)(e),Ft(e),!r)throw e.get("name").buildCodeFrameError("The 'let' tag requires a tag variable.");if(!m.types.isIdentifier(r))throw e.get("var").buildCodeFrameError("The 'let' cannot be destructured.");if(!n)throw e.get("name").buildCodeFrameError("The 'let' tag requires a default attribute.");if(t.attributes.length>1||!m.types.isMarkoAttribute(n)||!n.default&&"default"!==n.name)throw e.get("name").buildCodeFrameError("The 'let' tag only supports the 'default' attribute.");if(x()){const t=D(e),a=r.extra.reserve,o=V(t,a);ae("apply",t,n.extra?.valueReferences,m.types.expressionStatement(m.types.callExpression(o.apply,[je,n.value]))),function(e,t){for(const r of e.constantViolations){let n;r.isUpdateExpression()?n=m.types.binaryExpression("++"===r.node.operator?"+":"-",e.identifier,m.types.numericLiteral(1)):r.isAssignmentExpression()&&(n="="===r.node.operator?r.node.right:m.types.binaryExpression(r.node.operator.slice(0,-1),e.identifier,r.node.right)),n&&r.parentPath.replaceWith(t(r,n))}}(e.scope.getBinding(a.name),((e,t)=>function(e,t,r,n){let{apply:a,index:o}=e;return Z("queue",Y(t,n),a,m.types.numericLiteral(o-1),r)}(o,a,t,D(e))))}else Qe(e,n.value);e.remove()},attributes:{},autocomplete:[{description:"Use to create a mutable binding.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#let"}]},qt={translate:{enter(e){v()&&Me(e);const{node:t}=e,[r]=t.attributes;if(!t.body.body.length)throw e.buildCodeFrameError("The '<set>' tag requires body content that the context is forwarded through.");if(!m.types.isMarkoAttribute(r)||!r.default)throw e.get("name").buildCodeFrameError("The '<set>' tag requires default attribute like '<set=val>'.");if(t.attributes.length>1){const r=t.attributes[1].loc?.start,n=t.attributes[t.attributes.length-1].loc?.end,a="The '<set>' tag only supports a default attribute.";throw null==r||null==n?e.get("name").buildCodeFrameError(a):e.hub.buildError({loc:{start:r,end:n}},a,Error)}e.insertBefore(m.types.expressionStatement(Z("pushContext",m.types.stringLiteral(e.hub.file.metadata.marko.id),r.value)))},exit(e){(0,y.assertNoParams)(e),(0,y.assertNoVar)(e),v()&&Le(e),e.insertAfter(m.types.expressionStatement(Z("popContext"))),e.replaceWithMultiple(e.node.body.body)}},autocomplete:[{displayText:"set=<value>",description:"Sets a value which can be read from a child template.",snippet:"set=${1:value}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#set"}]},Vt={translate(e){const{hub:{file:t}}=e;(0,y.assertNoVar)(e),(0,y.assertNoParams)(e),It(e);let r="text/css";const n=e.get("attributes"),a=b().basename(t.opts.sourceFileName),o=n.find((e=>e.isMarkoAttribute()&&"type"===e.node.name));if(o){const e=o.get("value");if(!e.isStringLiteral())throw e.buildCodeFrameError('<style> "type" attribute can only be a string literal.');r=e.node.value}"text/css"===r&&(r="css");const s=e.get("body").get("body"),i=s[0];if(1!==s.length||!i.isMarkoText())throw(i.isMarkoText()?s[1]:s[0]).buildCodeFrameError("The '<style>' tag currently only supports static content.");const{resolveVirtualDependency:l}=k();if(l){const e=l(t.opts.filename,{type:r,code:i.node.value,startPos:i.node.start,endPos:i.node.end,path:`./${a}`,virtualPath:`./${a}.${r}`});Fe.pushContainer("body",m.types.importDeclaration([],m.types.stringLiteral(e)))}e.remove()},attributes:{type:{enum:["css","less","scss","text/css"]}}},Ht={translate:{enter(e){if(v()&&Me(e),!e.node.var)throw e.get("name").buildCodeFrameError("<tag> requires a variable to be defined, eg <tag/NAME>.")},exit(e){v()&&Le(e),e.replaceWith(m.types.variableDeclaration("const",[m.types.variableDeclarator(e.node.var,m.types.arrowFunctionExpression(e.node.body.params,st(e.node.body)))]))}},attributes:{},autocomplete:[{displayText:"tag/<name>|<params>|",description:"Creates a reusable fragment within the template.",snippet:"tag/${1:name}|${2:param1, param2}|",descriptionMoreURL:"https://markojs.com/docs/core-tags/#tag"}]},Gt=new WeakMap,Zt={migrate:[e=>e.remove()]},Jt={taglibId:ft,"<import>":wt,"<export>":Et,"<attrs>":Tt,"<if>":Ct,"<else-if>":Lt,"<else>":$t,"<for>":Ut,"<let>":Wt,"<const>":jt,"<effect>":Pt,"<html-comment>":zt,"<tag>":Ht,"<set>":qt,"<get>":_t,"<yield>":{translate(e){(0,y.assertNoVar)(e),(0,y.assertNoParams)(e),Ft(e),It(e),Me(e);const{node:t,hub:{file:r}}=e,[n,a]=t.attributes;if(!m.types.isMarkoAttribute(n)||!n.default)throw e.get("name").buildCodeFrameError("The '<yield>' tag requires default attribute like '<yield=VALUE>'.");if(a&&"onnext"===a.name&&v()&&e.get("attributes")[1].remove(),t.attributes.length>1){const r=t.attributes[1].loc?.start,n=t.attributes[t.attributes.length-1].loc?.end,a="The '<yield>' tag only supports a default attribute.";throw null==r||null==n?e.get("name").buildCodeFrameError(a):e.hub.buildError({loc:{start:r,end:n}},a,Error)}let o=Gt.get(r);if(!o){const e=r.path;Gt.set(r,o=e.scope.generateDeclaredUidIdentifier("return")),e.pushContainer("body",m.types.returnStatement(o))[0].skip()}v()&&e.replaceWith(m.types.assignmentExpression("=",o,n.value))[0].skip()},autocomplete:[{displayText:"yield=<value>",description:"Provides a value for use in a parent template.",snippet:"yield=${1:value}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#yield"}]},"<style>":Vt,"<await-reorderer>":Zt,"<init-widgets>":Zt,"<init-components>":Zt,"<static>":{parse(e){const{node:t,hub:{file:r}}=e,n=t.rawValue,a=n.replace(/^static\s*/,"").trim(),o=t.name.start+(n.length-a.length);let{body:s}=(0,y.parseScript)(r,a,o);1===s.length&&m.types.isBlockStatement(s[0])&&(s=s[0].body),e.replaceWith(m.types.markoScriptlet(s,!0))},"parse-options":{rootOnly:!0,rawOpenTag:!0,openTagOnly:!0,ignoreAttributes:!0},autocomplete:[{displayText:"static <statement>",description:"A JavaScript statement which is only evaluated once your template is loaded.",descriptionMoreURL:"https://markojs.com/docs/syntax/#static-javascript"}]},"<__flush_here_and_after__>":{migrate:[e=>{e.replaceWithMultiple(e.node.body.body),Fe.scope.crawl()}]}},Kt=new WeakMap,Xt=new WeakSet;function Yt(e){for(const t of Fe.get("body"))if(!Ie(t))return void t.insertBefore(e);Fe.unshiftContainer("body",e)}var Qt={Program:Be,ReferencedIdentifier:{migrate(e){const{name:t}=e.node;if(!e.scope.hasBinding(t))switch(e.node.name){case"input":Xt.has(Fe)||(Xt.add(Fe),Yt(m.types.markoTag(m.types.stringLiteral("attrs"),void 0,m.types.markoTagBody(),void 0,e.node)));break;case"out":if(!m.types.isMemberExpression(e.parent)||!m.types.isIdentifier(e.parent.property)||"global"!==e.parent.property.name)throw e.buildCodeFrameError("Only out.global is supported for compatibility.");{let t=Kt.get(Fe);t||(t=Fe.scope.generateUidIdentifier("$global"),Kt.set(Fe,t),Yt(m.types.markoTag(m.types.stringLiteral("get"),void 0,m.types.markoTagBody(),void 0,t))),e.parentPath.replaceWith(t)}}}},ImportDeclaration:Oe,MarkoDocumentType:_e,MarkoDeclaration:ze,MarkoCDATA:We,MarkoText:qe,MarkoTag:ut,MarkoPlaceholder:bt,MarkoScriptlet:vt,MarkoComment:kt},er=e=>Object.entries(Qt).reduce(((t,r)=>{let[n,a]=r;return e in a&&(t[n]=a[e]),t}),{}),tr=er("analyze"),rr=er("translate"),nr=[["../../browser-shims",{...Jt,migrate:er("migrate")}]],ar=r("../../node_modules/@marko/tags-api-preview/dist/components/return/index-browser.js"),or=r.n(ar),sr=r("./playground/components/hash-value.marko"),ir=r("../../node_modules/marko/dist/runtime/helpers/render-tag.js"),lr=r.n(ir),pr=r("../components/repl/index.marko"),cr=r("../../node_modules/@marko/tags-api-preview/dist/translate/track-rendering/index.js"),dr=r("../../node_modules/marko/dist/runtime/components/renderer.js"),ur=r.n(dr),fr=r("../../node_modules/marko/dist/runtime/components/registry/index-browser.js"),mr=r("../../node_modules/marko/dist/runtime/components/defineComponent.js"),yr=r.n(mr);const gr="Mtx/OLsr",br=(0,f.t)(gr);(0,fr.r)(gr,(()=>br));const hr={onCreate(){this.state={}}};br._=ur()((function(e,t,r,a,o){(0,cr.begin)();try{var s=a,i=or()(s);lr()(sr.Z,{default:[{name:"index.marko",path:"/components/index.marko",content:"<let/count=0/>\n<button onclick() { count++ }>\n  ${count}\n</button>"}],_return:i},t,r,"0");const{defaultChange:e,default:o}=i();lr()(pr.Z,{getTranslator:function(){return n},files:o,filesChange:e},t,r,"1")}finally{(0,cr.end)()}}),{t:gr},hr),br.Component=yr()(hr,br._),(0,a.register)("HkYzEWAp",s()),(0,a.register)("OIKmBXjW",l()),(0,a.register)("07hv1F0+",c()),(0,a.register)("mFesaajv",u()),(0,a.init)()},"../../browser-shims/compiler/dist/babel-types/index.js":(e,t,r)=>{e.exports=r("../../node_modules/@marko/compiler/dist/babel-types/index.js")},"../../browser-shims/compiler/index.js":(e,t,r)=>{t.types=r("../../browser-shims/compiler/dist/babel-types/index.js")},"../../browser-shims/compiler/modules.js":(e,t,r)=>{e.exports=r("../../node_modules/@marko/compiler/modules.js")},"../../browser-shims/fs.js":(e,t,r)=>{e.exports=r("../../node_modules/memfs/lib/index.js")},"../../browser-shims/process.js":e=>{e.exports={env:{},browser:!0,cwd:()=>"/"}},"?98fd":()=>{},"?2e65":()=>{},"?6a61":()=>{},"?e376":()=>{},"?7dc1":()=>{},"?f84f":()=>{},"?378b":()=>{},"?4c42":()=>{},"?c86f":()=>{}},e=>{e.O(0,[323,103,771,976,962],(()=>("./playground/v6/index.marko?browser-entry",e(e.s="./playground/v6/index.marko?browser-entry")))),e.O()}]);
//# sourceMappingURL=664.f3a818fc.js.map