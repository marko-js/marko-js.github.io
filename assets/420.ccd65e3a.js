"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[420],{"../../node_modules/@marko/runtime-tags/dist/translator/index.js":(e,t,r)=>{var n,s=Object.create,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,c=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,p=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of i(t))l.call(e,s)||s===r||o(e,s,{get:()=>t[s],enumerable:!(n=a(t,s))||n.enumerable});return e},d=(e,t,r)=>(r=null!=e?s(c(e)):{},p(!t&&e&&e.__esModule?r:o(r,"default",{value:e,enumerable:!0}),e)),u={};((e,t)=>{for(var r in t)o(e,r,{get:t[r],enumerable:!0})})(u,{analyze:()=>Yi,getRuntimeEntryFiles:()=>tc,internalEntryBuilder:()=>rt,preferAPI:()=>Ki,tagDiscoveryDirs:()=>Zi,taglibs:()=>ec,transform:()=>Xi,translate:()=>Qi}),e.exports=(n=u,p(o({},"__esModule",{value:!0}),n));var f={name:r("../../node_modules/@marko/runtime-tags/package.json").name,taglibId:"marko-core"},m=r("../../browser-shims/compiler/index.js"),y=r("../../browser-shims/compiler/babel-utils.js");function g(e){for(const t of e.get("attributes"))if(t.isMarkoSpreadAttribute())throw t.buildCodeFrameError(`The \`${e.get("name").node.value}\` tag does not support \`...spread\` attributes.`)}function b(e){if(e.node.body.body.length)throw e.get("name").buildCodeFrameError(`The \`${e.get("name").node.value}\` tag does not support body content.`)}var h,v,x={migrate:[e=>{(0,y.assertNoArgs)(e),(0,y.assertNoParams)(e),(0,y.assertNoAttributes)(e),b(e),(0,y.assertNoAttributeTags)(e),(0,y.diagnosticDeprecate)(e,{label:"The `attrs` tag is deprecated, prefer destructuring `input` via the `const` tag.",fix(){const t=e.node.var;if(!t||"Identifier"===t.type&&"input"===t.name)e.remove();else{const r=m.types.markoTag(m.types.stringLiteral("const"),[m.types.markoAttribute("value",m.types.identifier("input"))],m.types.markoTagBody([]));r.var=t,e.replaceWith(r)}}})}],attributes:{},autocomplete:[{displayText:"attrs/{ ... }",description:"Use to receive the attributes passed into this template.",snippet:"attrs/{ $1 }$2"}]},w=r("../../browser-shims/compiler/index.js"),A=r("../../browser-shims/compiler/babel-utils.js"),S=((h=S||{}).ClosureScopes="ClosureScopes:",h.ClosureSignalIndex="ClosureSignalIndex:",h.ConditionalRenderer="ConditionalRenderer:",h.ConditionalScope="ConditionalScope:",h.ControlledHandler="ControlledHandler:",h.ControlledType="ControlledType:",h.ControlledValue="ControlledValue:",h.DynamicPlaceholderLastChild="DynamicPlaceholderLastChild:",h.EventAttributes="EventAttributes:",h.Getter="Getter:",h.LifecycleAbortController="LifecycleAbortController:",h.LoopScopeArray="LoopScopeArray:",h.LoopScopeMap="LoopScopeMap:",h.Promise="Promise:",h.TagVariableChange="TagVariableChange:",h),k=((v=k||{}).BranchAccessor="#BranchAccessor",v.CatchContent="#CatchContent",v.PlaceholderBranch="#PlaceholderBranch",v.PlaceholderContent="#PlaceholderContent",v.TagVariable="#TagVariable",v.TagVariableChange="#TagVariableChange",v.ClosestBranchId="#ClosestBranchId",v),E=r("../../browser-shims/compiler/babel-utils.js");function T(e){let{extra:t}=e;if(t||(t=e.extra={}),void 0===t.confident){const r=(0,E.computeNode)(e);r?(t.computed=r.value,t.confident=!0):(t.computed=void 0,t.confident=!1)}return t}var M=r("../../browser-shims/compiler/index.js"),C=(r("../../browser-shims/compiler/index.js"),r("../../browser-shims/compiler/index.js")),j=r("../../browser-shims/compiler/babel-utils.js"),P=r("../../browser-shims/compiler/index.js"),I=r("../../browser-shims/compiler/babel-utils.js"),B=r("../../browser-shims/compiler/index.js"),L=Symbol("skip");function N(e,t,r){const n=e[t];if(n)if(Array.isArray(n))for(let e=n.length;e--;)N(n,e,r);else{const s=B.types.VISITOR_KEYS[n.type];for(let e=s.length;e--;)N(n,s[e],r);const o=r(n,e,t);o&&(e[t]=o)}}function O(e,t){if(e)if(Array.isArray(e)){for(const r of e)if(O(r,t))return!0}else{switch(t(e)){case!0:return!0;case L:return!1}for(const r of B.types.VISITOR_KEYS[e.type])if(O(e[r],t))return!0}return!1}function $(e,t,r,n){if(t)if(Array.isArray(t))for(const s of t)$(e,s,r,n);else if(e(t,r,n)!==L)for(const n of B.types.VISITOR_KEYS[t.type])$(e,t[n],t,r)}var F=new WeakMap;function D(e=""){const t=(0,I.getFile)();let r=F.get(t);if(!r){const{cache:e}=t.markoOpts,{filename:n}=t.opts,s=`uid-counts:${n}`;r=e.get(s),r?U(t)&&(r=new Map(r)):(r=function(e){const t=new Map,r=e.path,n=e=>{const r=/^$(.*?)([1-9]\d*)?$/.exec(e);if(r){const e=r[1],n=r[2]?+r[2]+1:1;t.set(e,Math.max(t.get(e)||0,n))}};for(const e in r.scope.globals)n(e);return $(((e,t,r)=>{"Identifier"===e.type&&P.types.isBinding(e,t,r)&&n(e.name)}),r.node),t}(t),U(t)||e.set(s,r)),F.set(t,r)}e=e.replace(/^[^a-z$_]|[^a-z$_0-9]/gi,"")||"temp",e=/^\$?(.*?)\d*$/.exec(e)?.[1]||e;const n=(r.get(e)||0)+1,s=`$${n>1?e+n:e}`;return r.set(e,n),s}function R(e){return P.types.identifier(D(e))}function U(e){return"translate"===e.___compileStage}var z=r("../../browser-shims/compiler/babel-utils.js");function _(e){return e.node.name.value}var{taglibId:V}=f;function W(e){if(e.isMarkoTag()){const t=(0,z.getTagDef)(e);if(t)switch(t.taglibId){case V:case"@marko/translator-interop-class-tags":return!0;case"marko-html":switch(t.name){case"script":case"style":return!0}}}return!1}function q(e,t){return W(e)&&_(e)===t}function H(e){if(W(e))switch(_(e)){case"if":case"else-if":case"else":return!0}return!1}var G=class{constructor(e){this.compare=e}add(e,t){return e?Array.isArray(e)?Q(this.compare,e,t):ee(this.compare,e,t):t}union(e,t){return e?Array.isArray(e)?t?Array.isArray(t)?function(e,t,r){const n=t.length,s=r.length;let o=0,a=0;const i=[];for(;o<n&&a<s;){const n=t[o],s=r[a],c=e(n,s);0===c?(o++,a++,i.push(n)):c<0?(o++,i.push(n)):(a++,i.push(s))}if(n===s&&o===n)return t;for(;o<n;)i.push(t[o++]);for(;a<s;)i.push(r[a++]);return i}(this.compare,e,t):Q(this.compare,e,t):e:t?Array.isArray(t)?Q(this.compare,[...t],e):ee(this.compare,t,e):e:t}find(e,t){if(e){if(Array.isArray(e))return Y(this.compare,e,t);if(0===this.compare(e,t))return e}}findIndex(e,t){if(e){if(Array.isArray(e)){let r=e.length,n=0;for(;n<r;){const s=n+r>>>1,o=this.compare(e[s],t);if(0===o)return s;o>0?r=s:n=s+1}return-1}if(0===this.compare(e,t))return 0}return-1}isSuperset(e,t){if(!t)return!0;if(!Array.isArray(t))return-1!==this.findIndex(e,t);if(!Array.isArray(e))return!1;const r=t.length,n=e.length;if(r>n)return!1;for(let s=r;s--;){const r=this.findIndex(e,t[s]);if(-1===r||n-r<=s)return!1}return!0}};function J(e,t){return e?Array.isArray(e)?(e.push(t),e):[e,t]:t}function Z(e,t){if(e){if(Array.isArray(e)){const r=e.length;let n,s=0;for(;s<r;){let o=e[s++];if(t(o)){for(n=o;s<r;)if(o=e[s++],t(o)){for(n=[n,o];s<r;)o=e[s++],t(o)&&n.push(o);return n}return n}}return n}if(t(e))return e}}function K(e,t){if(e)if(Array.isArray(e)){let r=0;for(const n of e)t(n,r++)}else t(e,0)}function X(e,t){if(e){if(Array.isArray(e))return e.find(t);if(t(e,0))return e}}function Y(e,t,r){let n=t.length,s=0;for(;s<n;){const o=s+n>>>1,a=t[o],i=e(a,r);if(0===i)return a;i>0?n=o:s=o+1}}function Q(e,t,r){const n=t.length;let s=n,o=0;for(;o<s;){const n=o+s>>>1,a=e(t[n],r);if(0===a)return t;a>0?s=n:o=n+1}const a=new Array(n+1);for(let e=0;e<o;e++)a[e]=t[e];let i=r;for(;o<n;){const e=i;i=t[o],a[o++]=e}return a[n]=i,a}function ee(e,t,r){const n=e(t,r);return 0===n?t:n<0?[t,r]:[r,t]}var te=r("../../browser-shims/compiler/babel-utils.js"),re=e=>{const t=new WeakMap;return[()=>{let r=t.get((0,te.getProgram)());return r||t.set((0,te.getProgram)(),r=e()),r},e=>{t.set((0,te.getProgram)(),e)}]};function ne(e,t){return[r=>{const n=(0,te.getProgram)().state[e]??={};return n[r.id]??=t&&t(r)},(t,r)=>{((0,te.getProgram)().state[e]??={})[t.id]=r}]}var se=r("../../browser-shims/compiler/index.js"),oe=r("../../browser-shims/compiler/babel-utils.js"),ae=/^<.*>$|\.marko$/;function ie(e){const t=e.node.extra??={};if(void 0===t.tagNameType){const r=e.get("name");if(r.isStringLiteral()?(t.tagNameType="@"===r.node.value[0]?3:(0,oe.isNativeTag)(e)?0:1,t.tagNameNullable=t.tagNameNullable=!1):r.isIdentifier()?(function(e,t){const r=[e];let n,s,o,a=!1;for(;(n=r.pop())&&2!==s;)if(n.isConditionalExpression())r.push(n.get("consequent")),n.node.alternate&&r.push(n.get("alternate"));else if(n.isLogicalExpression())"||"===n.node.operator?r.push(n.get("left")):a=!0,r.push(n.get("right"));else if(n.isAssignmentExpression())r.push(n.get("right"));else if(n.isBinaryExpression())s="+"!==n.node.operator||void 0!==s?2:0;else if(n.isStringLiteral()||n.isTemplateLiteral())s=void 0!==s?2:0;else if(n.isNullLiteral())a=!0;else if(n.isIdentifier()){if("undefined"===n.node.name){a=!0;continue}const t=n.scope.getBinding(n.node.name);if(!t){s=2;continue}if("module"===t.kind){const r=t.path.parent;if(ae.test(r.source.value)&&r.specifiers.some((e=>se.types.isImportDefaultSpecifier(e)))){const t=(0,oe.resolveTagImport)(e,r.source.value)||r.source.value;0===s||o&&o!==t?(s=2,o=void 0):(s=1,o=t)}else s=2;continue}const i=t.path;if(i.isMarkoTag()&&"local"===t.kind){const e=i.get("name").node.value;if("const"===e){r.push(i.get("attributes")[0].get("value"));continue}if("let"===e){s=2;continue}continue}s=2}else s=2;t.tagNameType=s,t.tagNameNullable=a,t.tagNameDynamic=!0,1===s&&o&&(t.tagNameImported=o)}(r,t),0===t.tagNameType&&(t.tagNameType=2)):r.isTemplateLiteral()&&!r.node.expressions.length?t.tagNameType=0:t.tagNameType=2,void 0===t.tagNameType&&(t.tagNameType=2),1===t.tagNameType){const r=(0,oe.loadFileForTag)(e);r?"class"===r.ast.program.extra.featureType&&(t.tagNameType=2,t.featureType="class",((0,oe.getProgram)().node.extra??={}).needsCompat=!0):t.tagNameType=2}}return t.tagNameType}var ce=new G((function(e,t){return e.id-t.id}));function le(e){const t=e.node.extra??={};let r=t.section;if(!r&&("Program"===e.type||e.get("body").length)){const n=e.parentPath?pe(e.parentPath):void 0,s=e.parentPath?.get("name"),o=e.isProgram()?"":D(s.toString()+"_content"),a=e.hub.file.path.node.extra??={},i=a.sections??=[];r=t.section={id:i.length,name:o,loc:s?.node.loc||void 0,depth:n?n.depth+1:0,parent:n,sectionAccessor:void 0,params:void 0,referencedClosures:void 0,referencedHoists:void 0,bindings:void 0,hoisted:void 0,isHoistThrough:void 0,assignments:void 0,content:he(e),upstreamExpression:void 0,downstreamBinding:void 0,hasAbortSignal:!1,isBranch:!1},i.push(r)}return r}function pe(e){let t=e;for(;;){if("Program"===t.type||"MarkoTagBody"===t.type&&!t.node.attributeTags&&!Ee(t.parentPath))return le(t);t=t.parentPath}}function de(e){return e.node.extra?.section}function ue(e){let t,r=e;for(;void 0===(t=r.node.extra?.section);)r=r.parentPath;return t}var[fe]=ne("scopeIdIdentifier",(e=>R(`scope${e.id}_id`))),[me,ye]=ne("parentIsOwner",(()=>!1)),[ge]=ne("scopeIdentifier",(()=>C.types.identifier("undefined")));function be(e){const{sections:t}=(0,j.getProgram)().node.extra;t?.forEach(e)}function he(e){const t=e.get("body"),r={startType:null,endType:null,singleChild:!0};for(let e=t.length;e--;){const n=ve(t[e],"endType",r);if(null!==n){r.endType=n,1===n&&(r.singleChild=!1);for(let n=0;n<e;n++){const e=ve(t[n],"startType");if(null!==e)return r.startType=e,r.singleChild=!1,r}return r.startType=ve(t[e],"startType"),r}}return null}function ve(e,t,r){switch(e.type){case"MarkoText":return 4;case"MarkoPlaceholder":return 2;case"MarkoScriptlet":case"MarkoComment":case"ImportDeclaration":case"ExportAllDeclaration":case"ExportNamedDeclaration":return null;case"MarkoTag":{const n=e;if(W(n))switch(n.node.name.value){case"html-comment":return 0;case"html-script":case"html-style":return 3;case"for":case"if":case"await":case"try":return 1;default:return null}else{if((0,j.isNativeTag)(n))return 3;if((0,j.isAttributeTag)(n))return null;if(C.types.isStringLiteral(n.node.name)){const e=(0,j.loadFileForTag)(n)?.ast.program.extra.section;if(e)return e.content?(r&&!e.content.singleChild&&"endType"===t&&(r.startType=e.content.startType,r.singleChild=!1),e.content[t]):null}}}}return 1}var xe=e=>!(e.isBranch||!1===e.downstreamBinding?.serialize);function we(e){if(e.hoisted||e.isHoistThrough||e.referencedHoists)return!0}function Ae(e,t){return e.parent?.id===t.section.id}function Se(e,t){return!function(e,t){return e.isBranch&&Ae(e,t)}(e,t)}function ke(e,t){do{if(t===e)return!0}while(t=t.parent);return!1}function Ee(e){if(W(e))switch(e.node.name.value){case"html-comment":case"html-script":case"html-style":return!0;default:return!1}return 0===ie(e)}function Te(e){if(e.sources)return!(Array.isArray(e.sources)?e.sources.every(Be):Be(e.sources))||e.sources}function Me(e){if(Ls(e))return Pe(e.referencedBindings)}function Ce(e){let t;for(const r of e){const e=Me(r);if(!0===e)return!0;t=gs.union(t,e)}return t}function je(e){const t=Pe(e.upstreamExpression?.referencedBindings),r=Pe(function(e){if(e.isBranch)return Z(e.referencedClosures,(t=>Ae(e,t)))}(e));if(t||r)return{referenced:t,closures:r,all:!0===t||!0===r||gs.union(t,r)}}function Pe(e){if(e){let t;if(Array.isArray(e)){for(const r of e){const e=Te(r);if(!0===e)return!0;t=gs.union(t,e)}return t}return Te(e)}}function Ie(e,t){return!0===e||!0===t||gs.union(e,t)}function Be(e){return 2===e.type}function Le(e,t){switch(e.type){case"ObjectPattern":for(const r of e.properties)switch(r.type){case"ObjectProperty":"AssignmentPattern"===r.value.type?Le(r.value.left,t):Le(r.value,t);break;case"RestElement":Le(r.argument,t)}break;case"ArrayPattern":for(const r of e.elements)if(null!=r)switch(r.type){case"RestElement":Le(r.argument,t);break;case"AssignmentPattern":Le(r.left,t);break;default:Le(r,t)}break;case"Identifier":t(e)}}var Ne=(e=>(e.ClosureScopes="a",e.ClosureSignalIndex="b",e.ConditionalRenderer="c",e.ConditionalScope="d",e.ControlledHandler="e",e.ControlledType="f",e.ControlledValue="g",e.DynamicPlaceholderLastChild="h",e.EventAttributes="i",e.Getter="j",e.LifecycleAbortController="k",e.LoopScopeArray="l",e.LoopScopeMap="m",e.Promise="n",e.TagVariableChange="o",e))(Ne||{}),Oe=(e=>(e.BranchAccessor="a",e.CatchContent="b",e.PlaceholderBranch="c",e.PlaceholderContent="d",e.TagVariable="e",e.TagVariableChange="f",e.ClosestBranchId="g",e))(Oe||{}),$e=r("../../browser-shims/compiler/babel-utils.js");function Fe(){return"html"===Re().output}function De(){return!Fe()}function Re(){return(0,$e.getFile)().markoOpts}function Ue(){return Re().optimize}function ze(){return Ue()?Ne:S}function _e(e){let t=e;do{t=t.parentPath}while(t&&!qe(t));return t}function Ve(e){let t=e;for(;!qe(t.parentPath);)t=t.parentPath;return t}function We(e){let t,r=e;if(!r.isProgram()){for(;!qe(r);){if(He(r))t=r;else switch(r.type){case"CallExpression":case"NewExpression":t=void 0}r=r.parentPath}return t}}function qe(e){switch(e.type){case"MarkoTag":case"MarkoTagBody":case"MarkoAttribute":case"MarkoSpreadAttribute":case"MarkoPlaceholder":case"MarkoScriptlet":return!0;default:return!1}}function He(e){switch(e.type){case"FunctionDeclaration":return!e.node.declare;case"FunctionExpression":case"ArrowFunctionExpression":case"ObjectMethod":return!0;default:return!1}}function Ge(e){let t=e;for(;t;){const{parent:e,node:r}=t;switch(e.type){case"CallExpression":return e.callee===r;case"TSNonNullExpression":t=t.parentPath;break;default:return!1}}return!1}r("../../browser-shims/compiler/index.js");var Je=r("../../browser-shims/compiler/index.js"),Ze=r("../../browser-shims/compiler/index.js"),Ke=r("../../browser-shims/compiler/babel-utils.js"),Xe=d(r("../../node_modules/path-browserify/index.js"));function Ye(e){if(e.downstreamExpressions.size)return!0;for(const t of e.aliases)if(Ye(t))return!0;for(const t of e.propertyAliases.values())if(Ye(t))return!0;return!1}var Qe=r("../../browser-shims/compiler/index.js"),et=r("../../browser-shims/compiler/babel-utils.js"),tt=Symbol(),rt={build(e){const t=e[tt];if(!t)throw e.path.buildCodeFrameError("Unable to build hydrate code, no files were visited before finalizing the build");const r=t.imports.map((e=>Qe.types.importDeclaration([],Qe.types.stringLiteral(e))));return t.init&&(r.unshift(Qe.types.importDeclaration([Qe.types.importSpecifier(Qe.types.identifier("init"),Qe.types.identifier("init"))],Qe.types.stringLiteral(`${f.name}/${e.markoOpts.optimize?"":"debug/"}dom`))),r.push(Qe.types.expressionStatement(Qe.types.callExpression(Qe.types.identifier("init"),[])))),r},visit(e,t,r){const n=t[tt]||={imports:[],init:!1},{analyzedTags:s}=e.metadata.marko;n.imports.push((0,et.resolveRelativePath)(t,e.opts.filename)),n.init||=e.path.node.extra.hasInteractiveChild||e.path.node.extra.isInteractive||!1;for(const e of s||[])r(e)}},nt=r("../../browser-shims/compiler/index.js"),st=r("../../browser-shims/compiler/babel-utils.js");function ot(e,t){return t?e:""}function at(e,t){return t||0===t?`${e}:${"number"==typeof t&&t&&!/^(--|ta|or|li|z)|cou|nk|it|ag|we|do|w$/.test(e)?t+"px":t}`:""}function it(e,t,r){switch(typeof e){case"string":return e;case"object":if(null!==e){let n="",s="";if(Array.isArray(e))for(const o of e){const e=it(o,t,r);""!==e&&(n+=s+e,s=t)}else for(const o in e){const a=r(o,e[o]);""!==a&&(n+=s+a,s=t)}return n}}return""}function ct(e){return/^on[A-Z-]/.test(e)}function lt(e){return"-"===e[2]?e.slice(3):e.slice(2).toLowerCase()}function pt(e){return e?e+"":0===e?"0":""}Symbol();var dt=/[<&]/g,ut=e=>"&"===e?"&amp;":"&lt;";function ft(e){return e?(t=e+"",dt.test(t)?t.replace(dt,ut):t):0===e?"0":"&zwj;";var t}var mt=/<\/script/g;function yt(e){return e?(t=e+"",mt.test(t)?t.replace(mt,"\\x3C/script"):t):0===e?"0":"";var t}var gt=/<\/style/g;function bt(e){return e?(t=e+"",gt.test(t)?t.replace(gt,"\\3C/style"):t):0===e?"0":"";var t}var ht=Symbol(),{hasOwnProperty:vt}={},xt=function*(){}().constructor,wt=async function*(){}().constructor;function At(e){const t=e[0];return'"'===t||t>="0"&&t<="9"?"["+e+"]":"."+e}function St(e){const{next:t}=e;e.next=function(e){return this[ht]=1,t.call(this,e)}}function kt(e){return Mt("class",function(e){return it(e," ",ot)}(e))}function Et(e){return Mt("style",function(e){return it(e,";",at)}(e))}function Tt(e,t){return function(e){return null==e||!1===e}(t)?"":function(e,t){switch(typeof t){case"string":return" "+e+It(t);case"boolean":return" "+e;case"number":return" "+e+"="+t;case"object":if(t instanceof RegExp)return" "+e+It(t.source)}return" "+e+It(t+"")}(e,t)}function Mt(e,t){return t&&" "+e+It(t)}St(xt.prototype),St(wt.prototype),(()=>{const e=new Map;for(const t of Object.getOwnPropertyNames(Symbol)){const r=Symbol[t];"symbol"==typeof r&&e.set(r,"Symbol."+t)}})(),new Map([[AggregateError,"AggregateError"],[Array,"Array"],[Array.from,"Array.from"],[Array.isArray,"Array.isArray"],[Array.of,"Array.of"],[ArrayBuffer,"ArrayBuffer"],[ArrayBuffer.isView,"ArrayBuffer.isView"],[Atomics.add,"Atomics.add"],[Atomics.and,"Atomics.and"],[Atomics.compareExchange,"Atomics.compareExchange"],[Atomics.exchange,"Atomics.exchange"],[Atomics.isLockFree,"Atomics.isLockFree"],[Atomics.load,"Atomics.load"],[Atomics.notify,"Atomics.notify"],[Atomics.or,"Atomics.or"],[Atomics.store,"Atomics.store"],[Atomics.sub,"Atomics.sub"],[Atomics.wait,"Atomics.wait"],[BigInt,"BigInt"],[BigInt.asIntN,"BigInt.asIntN"],[BigInt.asUintN,"BigInt.asUintN"],[BigInt64Array,"BigInt64Array"],[BigInt64Array.from,"BigInt64Array.from"],[BigInt64Array.of,"BigInt64Array.of"],[BigUint64Array,"BigUint64Array"],[BigUint64Array.from,"BigUint64Array.from"],[BigUint64Array.of,"BigUint64Array.of"],[Boolean,"Boolean"],[console.assert,"console.assert"],[console.clear,"console.clear"],[console.count,"console.count"],[console.countReset,"console.countReset"],[console.debug,"console.debug"],[console.dir,"console.dir"],[console.dirxml,"console.dirxml"],[console.error,"console.error"],[console.group,"console.group"],[console.groupCollapsed,"console.groupCollapsed"],[console.groupEnd,"console.groupEnd"],[console.info,"console.info"],[console.log,"console.log"],[console.table,"console.table"],[console.time,"console.time"],[console.timeEnd,"console.timeEnd"],[console.timeLog,"console.timeLog"],[console.timeStamp,"console.timeStamp"],[console.trace,"console.trace"],[console.warn,"console.warn"],[DataView,"DataView"],[Date,"Date"],[Date.now,"Date.now"],[Date.parse,"Date.parse"],[Date.UTC,"Date.UTC"],[decodeURI,"decodeURI"],[decodeURIComponent,"decodeURIComponent"],[encodeURI,"encodeURI"],[encodeURIComponent,"encodeURIComponent"],[Error,"Error"],[EvalError,"EvalError"],[Float32Array,"Float32Array"],[Float32Array.from,"Float32Array.from"],[Float32Array.of,"Float32Array.of"],[Float64Array,"Float64Array"],[Float64Array.from,"Float64Array.from"],[Float64Array.of,"Float64Array.of"],[Function,"Function"],[globalThis.atob,"atob"],[globalThis.btoa,"btoa"],[globalThis.clearImmediate,"clearImmediate"],[globalThis.clearInterval,"clearInterval"],[globalThis.clearTimeout,"clearTimeout"],[globalThis.crypto?.getRandomValues,"crypto.getRandomValues"],[globalThis.crypto?.randomUUID,"crypto.randomUUID"],[globalThis.fetch,"fetch"],[globalThis.performance?.now,"performance.now"],[globalThis.queueMicrotask,"queueMicrotask"],[globalThis.setImmediate,"setImmediate"],[globalThis.setInterval,"setInterval"],[globalThis.setTimeout,"setTimeout"],[globalThis.structuredClone,"structuredClone"],[globalThis.URL,"URL"],[globalThis.URLSearchParams,"URLSearchParams"],[globalThis.WritableStream,"WritableStream"],[Int16Array,"Int16Array"],[Int16Array.from,"Int16Array.from"],[Int16Array.of,"Int16Array.of"],[Int32Array,"Int32Array"],[Int32Array.from,"Int32Array.from"],[Int32Array.of,"Int32Array.of"],[Int8Array,"Int8Array"],[Int8Array.from,"Int8Array.from"],[Int8Array.of,"Int8Array.of"],[Intl.Collator,"Intl.Collator"],[Intl.DateTimeFormat,"Intl.DateTimeFormat"],[Intl.DisplayNames,"Intl.DisplayNames"],[Intl.getCanonicalLocales,"Intl.getCanonicalLocales"],[Intl.ListFormat,"Intl.ListFormat"],[Intl.Locale,"Intl.Locale"],[Intl.NumberFormat,"Intl.NumberFormat"],[Intl.PluralRules,"Intl.PluralRules"],[Intl.RelativeTimeFormat,"Intl.RelativeTimeFormat"],[Intl.Segmenter,"Intl.Segmenter"],[Intl.supportedValuesOf,"Intl.supportedValuesOf"],[isFinite,"isFinite"],[isNaN,"isNaN"],[JSON.parse,"JSON.parse"],[JSON.stringify,"JSON.stringify"],[Map,"Map"],[Map.groupBy,"Map.groupBy"],[Math.abs,"Math.abs"],[Math.acos,"Math.acos"],[Math.acosh,"Math.acosh"],[Math.asin,"Math.asin"],[Math.asinh,"Math.asinh"],[Math.atan,"Math.atan"],[Math.atan2,"Math.atan2"],[Math.atanh,"Math.atanh"],[Math.cbrt,"Math.cbrt"],[Math.ceil,"Math.ceil"],[Math.clz32,"Math.clz32"],[Math.cos,"Math.cos"],[Math.cosh,"Math.cosh"],[Math.exp,"Math.exp"],[Math.expm1,"Math.expm1"],[Math.floor,"Math.floor"],[Math.fround,"Math.fround"],[Math.hypot,"Math.hypot"],[Math.imul,"Math.imul"],[Math.log,"Math.log"],[Math.log10,"Math.log10"],[Math.log1p,"Math.log1p"],[Math.log2,"Math.log2"],[Math.max,"Math.max"],[Math.min,"Math.min"],[Math.pow,"Math.pow"],[Math.random,"Math.random"],[Math.round,"Math.round"],[Math.sign,"Math.sign"],[Math.sin,"Math.sin"],[Math.sinh,"Math.sinh"],[Math.sqrt,"Math.sqrt"],[Math.tan,"Math.tan"],[Math.tanh,"Math.tanh"],[Math.trunc,"Math.trunc"],[Number,"Number"],[Number.isFinite,"Number.isFinite"],[Number.isInteger,"Number.isInteger"],[Number.isNaN,"Number.isNaN"],[Number.isSafeInteger,"Number.isSafeInteger"],[Number.parseFloat,"Number.parseFloat"],[Number.parseInt,"Number.parseInt"],[Object,"Object"],[Object.assign,"Object.assign"],[Object.create,"Object.create"],[Object.defineProperties,"Object.defineProperties"],[Object.defineProperty,"Object.defineProperty"],[Object.entries,"Object.entries"],[Object.freeze,"Object.freeze"],[Object.fromEntries,"Object.fromEntries"],[Object.getOwnPropertyDescriptor,"Object.getOwnPropertyDescriptor"],[Object.getOwnPropertyDescriptors,"Object.getOwnPropertyDescriptors"],[Object.getOwnPropertyNames,"Object.getOwnPropertyNames"],[Object.getOwnPropertySymbols,"Object.getOwnPropertySymbols"],[Object.getPrototypeOf,"Object.getPrototypeOf"],[Object.is,"Object.is"],[Object.isExtensible,"Object.isExtensible"],[Object.isFrozen,"Object.isFrozen"],[Object.isSealed,"Object.isSealed"],[Object.keys,"Object.keys"],[Object.preventExtensions,"Object.preventExtensions"],[Object.seal,"Object.seal"],[Object.setPrototypeOf,"Object.setPrototypeOf"],[Object.values,"Object.values"],[parseFloat,"parseFloat"],[parseInt,"parseInt"],[Promise,"Promise"],[Proxy,"Proxy"],[RangeError,"RangeError"],[ReferenceError,"ReferenceError"],[Reflect.apply,"Reflect.apply"],[Reflect.construct,"Reflect.construct"],[Reflect.defineProperty,"Reflect.defineProperty"],[Reflect.deleteProperty,"Reflect.deleteProperty"],[Reflect.get,"Reflect.get"],[Reflect.getOwnPropertyDescriptor,"Reflect.getOwnPropertyDescriptor"],[Reflect.getPrototypeOf,"Reflect.getPrototypeOf"],[Reflect.has,"Reflect.has"],[Reflect.isExtensible,"Reflect.isExtensible"],[Reflect.ownKeys,"Reflect.ownKeys"],[Reflect.preventExtensions,"Reflect.preventExtensions"],[Reflect.set,"Reflect.set"],[Reflect.setPrototypeOf,"Reflect.setPrototypeOf"],[RegExp,"RegExp"],[Set,"Set"],[String,"String"],[String.fromCharCode,"String.fromCharCode"],[String.fromCodePoint,"String.fromCodePoint"],[String.raw,"String.raw"],[Symbol,"Symbol"],[Symbol.for,"Symbol.for"],[SyntaxError,"SyntaxError"],[TypeError,"TypeError"],[Uint16Array,"Uint16Array"],[Uint16Array.from,"Uint16Array.from"],[Uint16Array.of,"Uint16Array.of"],[Uint32Array,"Uint32Array"],[Uint32Array.from,"Uint32Array.from"],[Uint32Array.of,"Uint32Array.of"],[Uint8Array,"Uint8Array"],[Uint8Array.from,"Uint8Array.from"],[Uint8Array.of,"Uint8Array.of"],[Uint8ClampedArray,"Uint8ClampedArray"],[Uint8ClampedArray.from,"Uint8ClampedArray.from"],[Uint8ClampedArray.of,"Uint8ClampedArray.of"],[URIError,"URIError"],[WeakMap,"WeakMap"],[WeakSet,"WeakSet"]]),new Map([[Atomics,"Atomics"],[console,"console"],[globalThis,"globalThis"],[globalThis.crypto,"crypto"],[Intl,"Intl"],[JSON,"JSON"],[Math,"Math"],[Reflect,"Reflect"]]),Symbol("Scope ID"),Symbol("Pending Contexts"),Symbol(),globalThis.setImmediate||globalThis.setTimeout||globalThis.queueMicrotask,Symbol("selectedValue");var Ct=/'|&(?=#?\w+;)/g,jt=/"|&(?=#?\w+;)/g,Pt=/["'>\s]|&#?\w+;|\/$/g;function It(e){return e?Pt.test(e)?e[Pt.lastIndex-1]===(Pt.lastIndex=0,'"')?"='"+function(e){return Ct.test(e)?e.replace(Ct,Bt):e}(e)+"'":'="'+function(e){return jt.test(e)?e.replace(jt,Lt):e}(e)+'"':"="+e:""}function Bt(e){return"'"===e?"&#39;":"&amp;"}function Lt(e){return'"'===e?"&#34;":"&amp;"}Symbol();var Nt=r("../../browser-shims/compiler/index.js");function Ot(e){return/^[a-z_$][a-z0-9_$]*$/i.test(e)}function $t(e){return Ot(e)?Nt.types.identifier(e):/^(?:0|[1-9][0-9]*)$/.test(e)?Nt.types.numericLiteral(parseInt(e,10)):Nt.types.stringLiteral(e)}function Ft(e,t){return Nt.types.objectProperty($t(e),t)}function Dt(e,t,r){const n=$t(t),s="Identifier"!==n.type;return r?Nt.types.optionalMemberExpression(e,n,s,!0):Nt.types.memberExpression(e,n,s)}var Rt=new Set(["awaitTag","conditional","conditionalClosure","createTry","dynamicTag","createRenderer","createContent","createTemplate","dynamicClosure","dynamicClosureRead","intersection","loopClosure","loopIn","loopOf","loopTo","state","value"]);function Ut(e){const{output:t}=Re();return Dt((0,st.importStar)((0,st.getFile)(),function(e){const{optimize:t}=Re();return`${f.name}/${t?"":"debug/"}${"html"===e?"html":"dom"}`}(t),"$"),e)}function zt(e,...t){const r=nt.types.callExpression(Ut(e),function(e){const t=[];for(let r=e.length;r--;){const n=e[r];(n||t.length)&&(t[r]=n||nt.types.unaryExpression("void",nt.types.numericLiteral(0)))}return t}(t));return De()&&Rt.has(e)&&(r.leadingComments=[{type:"CommentBlock",value:" @__PURE__ "}]),r}function _t(){return{escapeXML:ft,toString:pt,attr:Tt,classAttr:kt,styleAttr:Et,escapeScript:yt,escapeStyle:bt}}function Vt(){const e=Re();return`marko/src/runtime/helpers/tags-compat/${Fe()?"html":"dom"}${e.optimize?"":"-debug"}.${"esm"===e.modules?"mjs":"js"}`}var Wt=r("../../browser-shims/compiler/index.js"),qt=r("../../browser-shims/compiler/babel-utils.js"),Ht=d(r("../../node_modules/path-browserify/index.js"));var Gt=/[\\^$.*+?()[\]{}|]/g,Jt=r("../../browser-shims/compiler/index.js"),Zt=r("../../browser-shims/compiler/babel-utils.js"),Kt=r("../../browser-shims/compiler/index.js"),Xt=r("../../browser-shims/compiler/babel-utils.js");function Yt(e){const t={};for(const r of e.attributes)"MarkoAttribute"===r.type&&(t[r.name]=r.value);return t}function Qt(e){const t="MarkoTagBody"===e.parent.type?e.parentPath.parentPath:e.parentPath;if("MarkoTag"===t.type)return t}var er=r("../../browser-shims/compiler/index.js");function tr(e,t){if(!e)return!1;const{node:r}=t,n=nr(e)?e.default:e;return sr(n)?n(t,er.types):n.enter&&n.enter(t,er.types),r!==t.node}function rr(e,t){if(!e)return!1;const{node:r}=t,n=nr(e)?e.default:e;return!sr(n)&&n.exit&&n.exit(t,er.types),r!==t.node}function nr(e){return Boolean(e.default)}function sr(e){return"function"==typeof e}function or({html:e,dom:t}){return{enter(r){tr(Fe()?e:t,r)},exit(r){rr(Fe()?e:t,r)}}}var ar=r("../../browser-shims/compiler/index.js"),ir=r("../../browser-shims/compiler/index.js");function cr(e){const t=[],r=[];let n=e[0];for(let s=1;s<e.length;s++){let o=e[s];if("object"==typeof o){if(!ir.types.isStringLiteral(o)){if(ir.types.isTemplateLiteral(o)){let t=s+1;const r=o.expressions.length;pr(e,t,o.quasis.length+r);for(let n=0;n<r;n++)e[t++]=o.quasis[n].value.raw,e[t++]=o.expressions[n];e[t]=o.quasis[r].value.raw;continue}r.push(o),t.push(n),n="";continue}o=o.value}n+=o}return r.length?1!==r.length||n||t[0]?(t.push(n),ir.types.templateLiteral(t.map((e=>ir.types.templateElement({raw:e}))),r)):r[0]:n?ir.types.stringLiteral(n):void 0}function lr(e,t){e[e.length-1]+=t}function pr(e,t,r){for(let n=e.length-1;n>=t;n--)e[n+r]=e[n]}r("../../browser-shims/compiler/index.js");var[dr]=ne("walks",(()=>[""])),[ur]=ne("walkComment",(()=>[])),[fr]=ne("steps",(()=>[])),mr={32:"get",36:"inside",37:"replace",38:"endChild",47:"beginChild",48:"beginChildWithVar",49:"dynamicTagWithVar",67:"next",97:"over",107:"out",117:"multiplier",91:"nextEnd",106:"overEnd",116:"outEnd",126:"multiplierEnd"};function yr(e){fr(ue(e)).push(0)}function gr(e){fr(ue(e)).push(1)}function br(e){fr(ue(e)).push(0,1)}function hr(e,t){if(Fe())return;const r=ue(e),n=fr(r),s=dr(r),o=ur(r);let a="";if(n.length){const e=[];let t=0;for(const r of n)0===r?(t++,e.push(67)):(t--,t>=0?(e.length=e.lastIndexOf(67),e.push(97)):(e.length=e.lastIndexOf(107)+1,e.push(107),t=0));let r=e[0],s=0;for(const t of e)t!==r?(o.push(`${mr[r]}(${s})`),a+=vr(r,s),r=t,s=1):s++;o.push(`${mr[r]}(${s})`),a+=vr(r,s),n.length=0}void 0!==t&&(32!==t&&kr(e)`<!>`,o.push(`${mr[t]}`),a+=String.fromCharCode(t)),lr(s,a)}function vr(e,t){switch(e){case 67:return xr(t,e,20);case 97:case 107:return xr(t,e,10);default:throw new Error(`Unexpected walk code: ${e}`)}}function xr(e,t,r){let n="";if(e>=r){const t=Math.floor(e/r);n+=xr(t,117,10),e-=t*r}return n+=String.fromCharCode(t+e),n}function wr(e){const t=1===e.content?.startType?String.fromCharCode(68):"",r=1===e.content?.endType?String.fromCharCode(68):"",n=cr([t,...dr(e),r]);return n&&""!==n.value&&(n.leadingComments=[{type:"CommentBlock",value:" "+ur(e).join(", ")+" "}]),n}var[Ar]=ne("writes",(()=>[""])),[Sr]=ne("trailerWrites",(()=>[""]));function kr(e,t){const r=ue(e),n=t?Sr:Ar;return(e,...t)=>{const s=t.length,o=n(r);lr(o,e[0]);for(let r=0;r<s;r++)o.push(t[r],e[r+1])}}function Er(e){const t=ue(e),r=Ar(t),n=Sr(t),s=cr(r),o=cr(n);return r.length=0,r[0]="",n.length=0,n[0]="",s&&o?ar.types.expressionStatement(ar.types.sequenceExpression([zt("write",s),zt("writeTrailers",o)])):s?ar.types.expressionStatement(zt("write",s)):o?ar.types.expressionStatement(zt("writeTrailers",o)):void 0}function Tr(e){const t=Er(e);t&&e.insertBefore(t)[0].skip()}function Mr(e){const t=e.isProgram()?e:e.get("body"),r=Er(t);r&&t.node.body.push(r)}function Cr(e){const t=1===e.content?.startType?"<!>":"",r=1===e.content?.endType?"<!>":"",n=Ar(e);return{setup:Cn(e),walks:wr(e),writes:cr([t,...n,r])}}function jr(e,t){const r=ue(e);if(0!==t.type)throw e.buildCodeFrameError("Tried to mark a node that was not determined to need a mark during analyze.");Fe()&&kr(e)`${zt("markResumeNode",fe(r),As(t))}`}var Pr=new WeakSet,[Ir,Br]=ne("returnValue"),Lr={analyze(e){(0,Xt.assertNoArgs)(e),(0,Xt.assertNoVar)(e),(0,Xt.assertNoParams)(e),b(e),(0,Xt.assertAllowedAttributes)(e,["value","valueChange"]);const t=Qt(e);if(t){if((0,Xt.isNativeTag)(t))throw e.get("name").buildCodeFrameError("The `return` tag can not be used in a native tag.");if(function(e){if(W(e))switch(_(e)){case"if":case"else-if":case"else":case"for":case"await":case"try":return!0}return!1}(t))throw e.get("name").buildCodeFrameError(`The \`return\` tag can not be used under an \`${t.get("name").toString()}\` tag.`)}if(Pr.has(e.parentPath))throw e.get("name").buildCodeFrameError(`Cannot have multiple \`return\` tags ${"Program"===e.parent.type?"for the template":"within a tag's body content"}.`);if(Pr.add(e.parentPath),!Yt(e.node).value)throw e.get("name").buildCodeFrameError("The `return` tag requires a value.")},translate:or({html:{exit(e){const t=ue(e),r=Yt(e.node);if(Tr(e),r.valueChange&&Zr(t,(Ue()?Oe:k).TagVariableChange,r.valueChange,!0),r.value){const n=R("return");Br(t,n),e.replaceWith(Kt.types.variableDeclaration("const",[Kt.types.variableDeclarator(n,r.value)]))[0].skip()}}},dom:{exit(e){const t=ue(e),r=Yt(e.node);r.value&&gn(t,r.value.extra?.referencedBindings,{identifier:Ut("tagVarSignal"),hasDownstreamIntersections:()=>!0},r.value),r.valueChange&&gn(t,r.valueChange.extra?.referencedBindings,{identifier:Ut("setTagVarChange"),hasDownstreamIntersections:()=>!1},r.valueChange),e.remove()}}}),parseOptions:{openTagOnly:!0},autocomplete:[{displayText:"return=<value>",description:"Provides a value for use in a parent template.",snippet:"return=${1:value}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#return"}]},Nr=r("../../browser-shims/compiler/index.js");function Or(e){return e.declared||!e.upstreamAlias?Nr.types.identifier(e.name):void 0!==e.property?Dt(Or(e.upstreamAlias),e.property,e.upstreamAlias.nullable):Or(e.upstreamAlias)}var $r=r("../../browser-shims/compiler/index.js");function Fr(e){switch(e.type){case"FunctionDeclaration":case"FunctionExpression":case"ArrowFunctionExpression":return e;default:return $r.types.functionExpression(null,e.params,e.body,e.async,e.generator)}}var Dr=r("../../browser-shims/compiler/index.js");function Rr(e){if(1===e.length&&Dr.types.isExpressionStatement(e[0])){const{expression:t}=e[0];switch(t.type){case"ObjectExpression":case"AssignmentExpression":return Ur(t);default:return t}}return Dr.types.blockStatement(e)}function Ur(e){switch(e.type){case"ObjectExpression":case"AssignmentExpression":return Dr.types.parenthesizedExpression(e);default:return e}}var[zr]=ne("signals",(()=>new Map)),[_r,Vr]=ne("queue");function Wr(e,t){Vr(de(e.get("body")),t)}var[qr,Hr]=ne("serializeSectionSources");function Gr(e,t){if(t){const r=qr(e);if(!0===r)return;Hr(e,r&&!0!==t?gs.union(r,t):t)}}var[Jr]=ne("serializedScopeProperties",(()=>new Map));function Zr(e,t,r,n){n&&Jr(e).set(t,{expression:r,reason:n})}var[Kr,Xr]=ne("sectionWriteScopeBuilder");function Yr(e,t){const r=Kr(e);Xr(e,r?e=>t(r(e)):t)}var Qr=new WeakMap,[en]=ne("htmlScopeStatements",(()=>[])),[tn]=ne("hoistFunctionsIdsMap",(()=>new Map));function rn(e){const t=tn(e.section);let r=t.get(e);return r||t.set(e,r=R(`get${e.name}`)),r}var nn=()=>Jt.types.stringLiteral("SIGNAL NOT INITIALIZED");function sn(e,t,r=function(e){let t;if(e)if(Array.isArray(e)){t="expr";for(const r of e)t+=`_${r.name}`}else t=e.name;else t="setup";return t}(t)){const n=zr(e);let s=n.get(t);if(!s){const o=t?!Array.isArray(t)&&t.section===e&&t.export:!e.parent&&(0,Zt.getProgram)().node.extra.domExports?.setup;if(n.set(t,s={identifier:o?Jt.types.identifier(o):R(r+e.name.replace("_","$")),referencedBindings:t,section:e,values:[],intersection:void 0,render:[],renderReferencedBindings:void 0,effect:[],effectReferencedBindings:void 0,subscribers:[],hasDownstreamIntersections:()=>{let r=!!s.intersection;if(!r)for(const e of s.values)if(e.signal.hasDownstreamIntersections()){r=!0;break}if(!r&&!Array.isArray(t)&&t){for(const n of t.aliases)if(sn(e,n).hasDownstreamIntersections()){r=!0;break}if(!r)for(const[,n]of t.propertyAliases)if(sn(e,n).hasDownstreamIntersections()){r=!0;break}}return s.hasDownstreamIntersections=()=>r,r},build:nn,export:!!o}),Fe())return s;t?Array.isArray(t)?(dn(t,s),s.build=()=>{const{id:e,scopeOffset:r}=ms.get(t);return zt("intersection",Jt.types.numericLiteral(e),an(s),r||t.length>2?Jt.types.numericLiteral(t.length-1):void 0,r&&As(r))}):t.section!==e&&gs.find(e.referencedClosures,t)&&(s.build=()=>{const r=an(s);return!_r(e)||Se(e,t)?zt("dynamicClosureRead",As(t),r,Ae(e,t)?void 0:Jt.types.arrowFunctionExpression([_n],Zn(e,t.section))):_r(e)(t,r)}):s.build=()=>an(s)}return s}function on(e,t="value"){const r=sn(e.section,e);r.build=()=>{const n=an(r),s=!e.upstreamAlias&&(3===e.type||2===e.type),o=!(e.upstreamAlias&&!e.property)&&(e.downstreamExpressions.size||"ArrowFunctionExpression"===n.type&&n.body.body.length>0)||r.intersection,a=s||r.intersection;return o||a||e.hoists.size?zt(t,As(e,"state"===t),n):n},r.valueAccessor=As(e);for(const t of e.aliases)on(t);for(const t of e.propertyAliases.values())on(t);return r}function an(e){const t=e.section,r=e.referencedBindings,n=[_n],s=Array.isArray(r),o=r&&!s,a=o&&r.section===t;let i=!e.render.length;if(o&&(e.renderReferencedBindings||r.aliases.size||r.propertyAliases.size)){const e=Jt.types.identifier(r.name);r.loc&&(e.loc=r.loc,e.start=r.loc.start.index,e.end=r.loc.end.index),n.push(e)}if(a){for(const t of r.aliases){const n=sn(t.section,t);e.render.push(Jt.types.expressionStatement(Jt.types.callExpression(n.identifier,[_n,Jt.types.identifier(r.name),...pn(n)])))}for(const[t,n]of r.propertyAliases){const s=sn(n.section,n);e.render.push(Jt.types.expressionStatement(Jt.types.callExpression(s.identifier,[_n,Dt(Jt.types.identifier(r.name),t,r.nullable),...pn(s)])))}}for(const t of e.values)e.render.push(Jt.types.expressionStatement(Jt.types.callExpression(t.signal.identifier,[t.scope,t.value,...pn(t.signal)])));if(K(e.intersection,(t=>{e.render.push(Jt.types.expressionStatement(Jt.types.callExpression(t,[_n])))})),a){let t,n;K(r.closureSections,(s=>{r.sources&&(Se(s,r)?(t||(t=[],n=R(e.identifier.name+"_closure"),e.render.push(Jt.types.expressionStatement(Jt.types.callExpression(n,[_n])))),t.push(sn(s,r).identifier)):e.render.push(Jt.types.expressionStatement(Jt.types.callExpression(sn(s,r).identifier,[_n]))))})),n&&(e.prependStatements||=[]).push(Jt.types.variableDeclaration("const",[Jt.types.variableDeclarator(n,zt("dynamicClosure",...t))]))}if(e.effect.length){const t=Jt.types.identifier(`${e.identifier.name}_effect`);e.render.push(Jt.types.expressionStatement(Jt.types.callExpression(t,[_n])))}if(s&&e.renderReferencedBindings&&e.render.unshift(Jt.types.variableDeclaration("const",[Jt.types.variableDeclarator(Jn(t,e.renderReferencedBindings),_n)])),i&&1===e.render.length){const t=e.render[0];if("ExpressionStatement"===t.type){const{expression:e}=t;if("CallExpression"===e.type){const t=e.arguments;if(n.length>=t.length){for(let e=t.length;e--;){const r=n[e],s=t[e];if("Identifier"!==s.type||r.name!==s.name){i=!1;break}}if(i)return e.callee}}}}return Jt.types.arrowFunctionExpression(n,Jt.types.blockStatement(e.render))}var cn=new WeakSet,ln=[];function pn(e){return e.extraArgs?(cn.has(e)||(cn.add(e),N(e,"extraArgs",jn)),e.extraArgs):ln}function dn(e,t){if(Array.isArray(e))return void e.forEach((e=>dn(e,t)));const r=sn(t.section,e);r.intersection=J(r.intersection,t.identifier)}function un(e){for(let t=e.length;t--;){const r=e[t];if(r)if(Jt.types.isArrowFunctionExpression(r)&&Jt.types.isBlockStatement(r.body)){const n=r.body.body;0===n.length?e[t]=Jt.types.numericLiteral(0):1===n.length&&Jt.types.isExpressionStatement(n[0])&&(r.body=Ur(n[0].expression))}else(Jt.types.isNullLiteral(r)||Jt.types.isUnaryExpression(r)&&"void"===r.operator)&&(e[t]=Jt.types.numericLiteral(0));else e[t]=Jt.types.numericLiteral(0)}for(let t=e.length-1;Jt.types.isNumericLiteral(e[t])&&0===e[t].value;)e.length=t--;return e}function fn(e,t,r,n,s){const o=sn(t,r),a=o[e]??=[],i="effect"===e?mn:yn;if(Array.isArray(n)?a.push(...n):a.push(n),!1!==s)if(s)for(const e of s)i(o,e);else i(o,r)}function mn(e,t){e.effectReferencedBindings=gs.union(e.effectReferencedBindings,t)}function yn(e,t){e.renderReferencedBindings=gs.union(e.renderReferencedBindings,t)}function gn(e,t,r,n,s=_n){const o=sn(e,t);yn(o,t),o.values.push({signal:r,value:n,scope:s})}function bn(e,t,r){const{markoOpts:n,opts:{filename:s}}=(0,Zt.getFile)();let o="";if(t)if("string"==typeof t)o+=`_${t}`;else if(Array.isArray(t))for(const e of t)o+=`_${e.name}`;else o+=`_${t.name}`;return(0,Zt.getTemplateId)(n,s,`${e.id}${o}${r?"/"+r:""}`)}var hn=new WeakMap;function vn(e,t){const{markoOpts:r,opts:{filename:n}}=(0,Zt.getFile)();let s=hn.get(e);s||hn.set(e,s=new Set);const o=(0,Zt.getTemplateId)(r,n,`${e.id}/${t}`);let a=0,i=o;for(;s.has(i);)i=o+"_"+ ++a;return s.add(i),i}function xn(e){K(e.hoisted,(t=>{for(const r of t.hoists.values()){const n=[0===t.type?Jt.types.stringLiteral(ze().Getter+Ss(t)):As(t)];let s=e;for(;s&&s!==r.section;){const e=s.parent;e&&n.push(Es(s)),s=e}const o=rn(r);(0,Zt.getProgram)().node.body.push(Jt.types.variableDeclaration("const",[Jt.types.variableDeclarator(o,r.downstreamExpressions.size?zt("register",Jt.types.stringLiteral(bn(r.section,r,"hoist")),zt("hoist",...n)):zt("hoist",...n))])),r.downstreamExpressions.size&&gn(r.section,void 0,on(r),Jt.types.callExpression(o,[_n]))}}));const t=[...zr(e).values()].sort(An);for(const r of t){N(r,"render",jn);for(const e of r.values)N(e,"value",jn);let t;if(r.effect.length){N(r,"effect",Pn);const n=Jt.types.identifier(`${r.identifier.name}_effect`),s=r.effectReferencedBindings,o=O(r.effect,qn);t=Jt.types.variableDeclarator(n,zt("effect",Jt.types.stringLiteral(bn(e,r.referencedBindings)),Jt.types.arrowFunctionExpression(s?o?[_n,Jn(e,s)]:[Jn(e,s)]:o?[_n]:[],Rr(r.effect))))}let n=r.build();Jt.types.isCallExpression(n)&&un(n.arguments),r.register&&(n=zt("registerBoundSignal",Jt.types.stringLiteral(bn(e,r.referencedBindings,"var")),n));const s=Jt.types.variableDeclarator(r.identifier,n);let o=e.parent||r.referencedBindings||!Jt.types.isFunctionExpression(n)&&!Jt.types.isArrowFunctionExpression(n)?Jt.types.variableDeclaration("const",[s]):Jt.types.functionDeclaration(r.identifier,n.params,Jt.types.isExpression(n.body)?Jt.types.blockStatement([Jt.types.expressionStatement(n.body)]):n.body);r.export&&(o=Jt.types.exportNamedDeclaration(o));const a=r.prependStatements||[];t&&a.push(Jt.types.variableDeclaration("const",[t])),a.push(o),(0,Zt.getProgram)().node.body.push(...a)}}function wn(e){const t=Fr(e);return"FunctionDeclaration"===t.type?[t,Jt.types.returnStatement(t.id)]:[Jt.types.returnStatement(t)]}function An(e,t){const r=Sn(e),n=Sn(t);for(let e=Math.max(r.length,n.length)-1;e>=0;e--){const t=(n[e]??-1)-(r[e]??-1);if(0!==t)return t}return 0}function Sn({referencedBindings:e}){return e?Array.isArray(e)?e.map(kn).sort():[kn(e)]:[]}function kn(e){return 1e4*(0===e.type?1:0)+e.id}function En(e,t){fn("effect",e,t,void 0,!1)}function Tn(e){const t=de(e);if(!t)return;const r=e.node.body,n=Array.from(zr(t).values()),s=fe(t),o=e=>Mn(t,e.section);K(t.assignments,o),K(t.referencedHoists,o),K(t.referencedClosures,(e=>{if(e.sources){const r=Te(e);if(o(e),Gr(e.section,r),Se(t,e)){const n=sn(e.section,e);let s=Qr.get(n);s||(Qr.set(n,s=R(n.identifier.name+"_closures")),en(e.section).push(Jt.types.variableDeclaration("const",[Jt.types.variableDeclarator(s,Jt.types.newExpression(Jt.types.identifier("Set"),[]))])),Zr(e.section,ze().ClosureScopes+Ss(e),s,r)),Zr(t,ze().ClosureSignalIndex+Ss(e),Jt.types.numericLiteral(function(e,t){let r=0;return X(e.closureSections,(n=>n===t||(Se(n,e)&&r++,!1))),r}(e,t)),r),Yr(t,(e=>zt("writeSubscribe",s,e)))}}}));const a=new Set;K(t.hoisted,(e=>{for(const r of e.hoists.values()){r.downstreamExpressions.size&&en(r.section).push(Jt.types.variableDeclaration("const",[Jt.types.variableDeclarator(Jt.types.identifier(r.name),zt("hoist",fe(r.section),Jt.types.stringLiteral(bn(r.section,r,"hoist"))))]));let e=t;for(;e&&e!==r.section;){const t=e.parent;if(!e.sectionAccessor&&!a.has(e)){const r=R(`${e.name}_subscribers`);a.add(e),en(t).push(Jt.types.variableDeclaration("const",[Jt.types.variableDeclarator(r,Jt.types.newExpression(Jt.types.identifier("Set"),[]))])),Yr(e,(e=>zt("writeSubscribe",r,e))),Zr(t,ks(e),r,!0)}e=t}}e.hoists.size&&0!==e.type&&Zr(t,Ss(e),Or(e),!0)}));for(let e=n.length;e--;)if(n[e].effect.length){const o=n[e].referencedBindings;r.push(Jt.types.expressionStatement(zt("writeEffect",s,Jt.types.stringLiteral(bn(t,o)))))}const i=Jr(t),c=[];K(t.bindings,(e=>{if(e.serialize&&0!==e.type){const t=Ss(e);i.delete(t),c.push(Ft(t,Or(e)))}}));for(const[e,{expression:t}]of i)c.push(Ft(e,t));const l=Kr(t),p=qr(t);if(l||c.length||p){for(const e of c)"Identifier"===e.key.type&&"Identifier"===e.value.type&&e.key.name===e.value.name&&(e.shorthand=!0);const n=[s,Jt.types.objectExpression(c)];if(!Ue()){let r;K(t.bindings,(e=>{if(!e.serialize||0===e.type)return;let t=e,n="";for(;!t.loc&&!t.declared&&t.upstreamAlias;)void 0!==t.property&&(n=At(t.property)+n),t=t.upstreamAlias;const s=t.loc&&Jt.types.stringLiteral(`${t.loc.start.line}:${t.loc.start.column+1}`);(r||=[]).push(Ft(Ss(e),t!==e?Jt.types.arrayExpression(s?[Jt.types.stringLiteral(t.name+n),s]:[Jt.types.stringLiteral(t.name+n)]):s||Jt.types.numericLiteral(0)))})),n.push(Jt.types.stringLiteral(e.hub.file.opts.filenameRelative),t.loc&&null!=t.loc.start.line?Jt.types.stringLiteral(`${t.loc.start.line}:${t.loc.start.column+1}`):Jt.types.numericLiteral(0)),r&&n.push(Jt.types.objectExpression(r))}r.push(Jt.types.expressionStatement(l?l(zt("writeScope",...n)):zt("writeScope",...n)))}!t.isBranch&&(t.hasAbortSignal||t.referencedClosures||X(t.bindings,(e=>1===e.type)))&&r.push(Jt.types.expressionStatement(zt("resumeClosestBranch",s)));const d=en(t);(r.length||d.length)&&r.unshift(Jt.types.variableDeclaration("const",[Jt.types.variableDeclarator(s,zt("nextScopeId"))]),...d);const u=Ir(t);void 0!==u&&r.push(Jt.types.returnStatement(u))}function Mn(e,t){let r=e;for(;r!==t;){const e=r.parent;if(!e)break;const t=Jr(r);r=e,t.has("_")||t.set("_",{expression:zt("ensureScopeWithId",fe(r)),reason:!0})}}function Cn(e){return zr(e).get(void 0)?.identifier}function jn(e){return Bn(e)||In(e)||Nn(e)}function Pn(e){return Bn(e)||In(e)}function In(e){switch(e.type){case"Identifier":case"MemberExpression":return Ts(e)}}function Bn(e){switch(e.type){case"UpdateExpression":{const{extra:t}=e.argument;if(Ns(t)){const{buildAssignment:r}=sn(t.assignment.section,t.assignment);if(r){const n=r(t.section,Jt.types.binaryExpression("++"===e.operator?"+":"-",e.argument,Jt.types.numericLiteral(1)));return e.prefix?n:Jt.types.sequenceExpression([n,e.argument])}}break}case"AssignmentExpression":switch(e.left.type){case"Identifier":{const{extra:t}=e.left;if(Ns(t)){const{buildAssignment:r}=sn(t.assignment.section,t.assignment);if(r)return r(t.section,"="===e.operator?e.right:Jt.types.binaryExpression(e.operator.slice(0,-1),e.left,e.right))}break}case"ArrayPattern":case"ObjectPattern":{let t,r;if(Le(e.left,(e=>{const{extra:n}=e;if(Ns(n)){const s=sn(n.assignment.section,n.assignment);s?.buildAssignment&&(e.name=D(e.name),(t||=[]).push(Jt.types.identifier(e.name)),(r||=[]).push(s.buildAssignment(n.section,Jt.types.identifier(e.name))))}})),t&&r){const n=D("result");return Jt.types.callExpression(Jt.types.arrowFunctionExpression([Jt.types.identifier(n),...t],Jt.types.sequenceExpression([Jt.types.assignmentExpression("=",e.left,Jt.types.identifier(n)),...r,Jt.types.identifier(n)])),[e.right])}break}}}}var Ln=new WeakMap;function Nn(e){switch(e.type){case"ClassMethod":{const t=On(e);return t&&Jt.types.classProperty(e.key,t)}case"ClassPrivateMethod":{const t=On(e);return t&&Jt.types.classPrivateProperty(e.key,t)}case"ObjectMethod":{const t=On(e);return t&&Jt.types.objectProperty(e.key,t)}case"ArrowFunctionExpression":case"FunctionExpression":return On(e);case"FunctionDeclaration":{const t=On(e);if(t)return Jt.types.variableDeclaration("const",[Jt.types.variableDeclarator(e.id,t)]);break}}}function On(e){const{extra:t}=e;if(Os(t)){const r=t.name,n=t.referencesScope,s=t.referencedBindingsInFunction;let o=Ln.get((0,Zt.getProgram)().node);return o||Ln.set((0,Zt.getProgram)().node,o=[]),o.push({id:r,node:e,registerId:t.registerId,section:t.section,referencesScope:n,referencedBindings:s}),n||s?Jt.types.callExpression(Jt.types.identifier(r),[_n]):Jt.types.identifier(r)}}var $n={translate:{exit(e){hr(e);const t=de(e),{walks:r,writes:n,setup:s}=Cr(t),o=e.node.extra.domExports,a=Wt.types.identifier(o.template),i=Wt.types.identifier(o.walks),c=Wt.types.identifier(o.setup),l=e.node.params[0].extra?.binding,p=l&&Ye(l)?on(l):void 0,d=function(e){const{filename:t}=e.opts,r=e.markoOpts.fileSystem,n=function(e){const t=e.lastIndexOf(Ht.default.sep)+1,r=e.indexOf(".",t);if(-1===r)return e.slice(t);const n=e.lastIndexOf("."),s=r-1;if("]"===e[s]){const o=e.lastIndexOf("[",s);if(o>t)return e.slice(t,o)+e.slice(r,n)}return e.slice(t,n)}(t),s=new RegExp(`^(${o=n,o.replace(Gt,"\\$&")}\\.${"index"===n?"|":""})style\\.\\w+$`);var o;for(const e of r.readdirSync(Ht.default.dirname(t)).sort())if(s.test(e))return`./${e}`}(e.hub.file);d&&(0,qt.importDefault)(e.hub.file,d),function(e){const{sections:t}=(0,j.getProgram)().node.extra;for(let r=t.length;r--;)e(t[r])}((r=>{if(r!==t){const t=r.params&&on(r.params),{walks:o,writes:a,setup:i}=Cr(r),c=Wt.types.identifier(r.name),l=r.referencedClosures?Wt.types.arrowFunctionExpression([_n],Rr((s=e=>{const t=sn(r,e);return Wt.types.expressionStatement(Wt.types.callExpression(Se(r,e)?t.identifier:Wt.types.memberExpression(t.identifier,Wt.types.identifier("_")),[_n]))},(n=r.referencedClosures)?Array.isArray(n)?n.map(s):[s(n)]:[]))):void 0,p=me(r)?zt("createRenderer",...un([a,o,i,t?.identifier,l])):zt(xe(r)?"registerContent":"createContent",Wt.types.stringLiteral(bn(r,"renderer")),...un([a,o,i,t?.identifier,l,r.hoisted||r.isHoistThrough?Es(r):void 0]));xn(r),e.node.body.push(Wt.types.variableDeclaration("const",[Wt.types.variableDeclarator(c,p)]))}var n,s})),xn(t),function(){const e=Ln.get((0,Zt.getProgram)().node),t=[];if(e){for(const r of e){let e;const n=r.referencedBindings?r.referencesScope?[_n,Jt.types.assignmentPattern(Jn(r.section,r.referencedBindings),_n)]:[Jn(r.section,r.referencedBindings)]:r.referencesScope?[_n]:void 0;e=n?Jt.types.functionDeclaration(Jt.types.identifier(r.id),n,Jt.types.blockStatement(wn(r.node))):"FunctionDeclaration"===r.node.type&&r.node.id?.name===r.id?r.node:Jt.types.functionDeclaration(Jt.types.identifier(r.id),r.node.params,"BlockStatement"===r.node.body.type?r.node.body:Jt.types.blockStatement([Jt.types.returnStatement(r.node.body)]),r.node.generator,r.node.async),t.push(e)}for(const r of e)t.push(Jt.types.expressionStatement(zt("register",Jt.types.stringLiteral(r.registerId),Jt.types.identifier(r.id))));(0,Zt.getProgram)().node.body.push(...t)}}(),s||e.node.body.unshift(Wt.types.exportNamedDeclaration(Wt.types.variableDeclaration("const",[Wt.types.variableDeclarator(c,Wt.types.arrowFunctionExpression([],Wt.types.blockStatement([])))]))),e.node.body.unshift(Wt.types.exportNamedDeclaration(Wt.types.variableDeclaration("const",[Wt.types.variableDeclarator(a,n||Wt.types.stringLiteral(""))])),Wt.types.exportNamedDeclaration(Wt.types.variableDeclaration("const",[Wt.types.variableDeclarator(i,r||Wt.types.stringLiteral(""))]))),e.node.body.push(Wt.types.exportDefaultDeclaration(zt("createTemplate",Wt.types.stringLiteral(e.hub.file.metadata.marko.id),a,i,c,p?.identifier)))}}},Fn=r("../../browser-shims/compiler/index.js"),Dn=r("../../browser-shims/compiler/babel-utils.js"),Rn=new WeakMap,Un={translate:{exit(e){Mr(e),Tn(e),N(e.node,"body",zn);const t=[];for(const n of e.get("body"))(r=n).isImportDeclaration()||r.isExportDeclaration()||r.isMarkoScriptlet({static:!0})?n.isMarkoScriptlet()&&(n.node.target&&"server"!==n.node.target?n.remove():n.replaceWithMultiple(n.node.body)):(t.push(n.node),n.remove());var r;const n=Rn.get(e),s=Fn.types.arrowFunctionExpression([Fn.types.identifier("input")],Fn.types.blockStatement(t)),o=Fn.types.exportDefaultDeclaration(zt("createTemplate",Fn.types.stringLiteral(e.hub.file.metadata.marko.id),n?Fn.types.identifier(n):s));n?e.node.body.push(Fn.types.variableDeclaration("const",[Fn.types.variableDeclarator(Fn.types.identifier(n),s)]),o):e.node.body.push(o)}}};function zn(e,t){return function(e){switch(e.type){case"Identifier":case"MemberExpression":{const{extra:t}=e;if(t&&!(t.read&&!t.read.binding.declared||t.binding&&!t.binding.declared))return Ts(e)}}}(e)||function(e,t){switch(e.type){case"ClassMethod":{const t=Wn(e);return t&&Fn.types.classProperty(e.key,t)}case"ClassPrivateMethod":{const t=Wn(e);return t&&Fn.types.classPrivateProperty(e.key,t)}case"ObjectMethod":{const t=Wn(e);return t&&Fn.types.objectProperty(e.key,t)}case"FunctionDeclaration":{const{extra:r}=e;if(Os(r)){let n=Vn.get(t);n||Vn.set(t,n=[]),n.push({id:e.id.name,registerId:r.registerId})}break}case"ArrowFunctionExpression":case"FunctionExpression":return Wn(e);case"BlockStatement":case"MarkoScriptlet":!function(e){const t=Vn.get(e);if(t)for(const{id:r,registerId:n}of t)e.push(Fn.types.expressionStatement(zt("register",Fn.types.identifier(r),Fn.types.stringLiteral(n))))}(e.body)}}(e,t)}var _n,Vn=new WeakMap;function Wn(e){const{extra:t}=e;if(Os(t))return zt("register",Fr(e),Fn.types.stringLiteral(t.registerId),(t.referencedBindingsInFunction||t.referencesScope)&&fe(t.section))}function qn(e){return e===_n}var Hn={migrate:{enter(e){e.node.params=[Ze.types.identifier("input")]},exit(e){e.scope.crawl()}},analyze:{enter(e){le(e),ss(e,2);const t=e.node.params[0].extra?.binding;t&&(t.nullable=!1),(e.node.extra??={}).domExports={template:D("template"),walks:D("walks"),setup:D("setup"),input:void 0,closures:D("closures")}},exit(e){!function(){const e=Qn(),t=bs(),r=hs(),n=ps();if(n.size)for(const[e,r]of n){const n=e.extra;let a=t.get(n),{isEffect:i}=n;for(const e of r){const r=e?.extra;if(Ls(r)){i||=r.isEffect;const e=t.get(r);e&&(o=e,a=(s=a)?o?Array.isArray(s)?s.concat(o):Array.isArray(o)?[s,...o]:[s,o]:s:o,t.delete(r))}}t.set(n,a),n.isEffect=i}var s,o;const a=new Map;for(const[e,r]of t)Ls(e)&&(e.referencedBindings=Cs(e,r,a),K(e.referencedBindings,(t=>{t.downstreamExpressions.add(e)})));for(const[e,t]of r)e.referencedBindingsInFunction=Cs(e,t,a),K(e.referencedBindingsInFunction,(e=>{e.serialize=!0}));for(const t of e)0===t.type||t.upstreamAlias||Ms(e,t);for(const t of e){const{name:e,section:r}=t;0!==t.type&&(ys(t),X(r.bindings,(({name:e})=>e===t.name))&&(t.name=D(e))),r.bindings=gs.add(r.bindings,t);for(const{referencedBindings:e,isEffect:r,section:n}of t.downstreamExpressions)n!==t.section&&(t.closureSections=ce.add(t.closureSections,n),n.referencedClosures=gs.add(n.referencedClosures,t)),r&&K(e,(e=>{e.serialize=!0}))}be((e=>{const t=a.get(e);if(t)for(const e of t){const t=e.length;for(let r=0;r<t-1;r++)for(let n=r+1;n<t;n++){const t=e[r],s=e[n];t.serialize||gs.isSuperset(t.sources,s.sources)||(t.serialize=!0),s.serialize||gs.isSuperset(s.sources,t.sources)||(s.serialize=!0)}}K(e.referencedClosures,(t=>{if(!t.serialize){let r=!1;const n=t.section;let s=e;for(;s!==n&&!(r=!s.upstreamExpression||!!Me(s.upstreamExpression));)s=s.parent;t.serialize=r}}))})),be((e=>{let t=0;const r=a.get(e)||[],{id:n,bindings:s}=e,o=({section:e})=>e.id===n;let i,c=0;for(K(Z(s,o),((n,s)=>{for(n.id=(c=s)+t;t<r.length&&(i=r[t]).filter(o).at(-1)===n;)ms.set(i,{id:s+ ++t,scopeOffset:fs(i,e)})}));t<r.length;)i=r[t],ms.set(i,{id:c+ ++t,scopeOffset:fs(i,e)})})),n.clear(),t.clear(),r.clear()}();const t=e.node.extra,r=e.node.params[0].extra?.binding;r&&Ye(r)&&(t.domExports.input=Gn(r,e))}},translate:{enter(e){if(_n=De()?R("scope"):null,De()&&R("clean"),"hydrate"===Re().output){const t=e.hub.file,r=new Set([(0,Ke.resolveRelativePath)(t,t.opts.filename)]);return rt.visit(t,t,(function e(n){if(!r.has(n)){r.add(n);const s=(0,Ke.loadFileForImport)(t,n);s&&rt.visit(s,t,(r=>e(function(e,t,r){return t===e?(0,Ke.resolveRelativePath)(t,r):(0,Ke.resolveRelativePath)(e,"."===r[0]?Xe.default.join(t.opts.filename,"..",r):r)}(t,s,r))))}})),e.node.body=rt.build(t),void e.skip()}},exit(e){if(Fe()?Un.translate.exit(e):$n.translate.exit(e),e.node.extra?.needsCompat){const t=Vt(),r=[void 0];for(const n of e.node.body)"ImportDeclaration"===n.type&&n.source.value===t?r[0]=n:r.push(n);r[0]??=Ze.types.importDeclaration([],Ze.types.stringLiteral(t)),e.node.body=r}}}};function Gn(e,t){const r={id:e.export??=D(e.name),binding:e,props:void 0};if(!e.aliases.size&&!e.downstreamExpressions.size){r.props={};for(const[n,s]of e.propertyAliases)r.props[n]=Gn(s,t)}return r}function Jn(e,t){const r=e.depth,n=Je.types.objectPattern([]);let s;return K(t,(t=>{const o=t.name;if(!Ot(o))return;const a=Ss(t),i=a===o;let c=n;if(t.section!==e){s||(s=[n]);const e=r-t.section.depth;let o=s.length,a=s[o-1];for(;o<=e;o++){const e=Je.types.objectPattern([]);a.properties.push(Je.types.objectProperty(Je.types.identifier("_"),e)),s.push(e),a=e}c=s[e]}c.properties.push(Je.types.objectProperty($t(a),Je.types.identifier(o),!1,i))})),n}function Zn(e,t){let r=_n??Je.types.identifier("undefined");const n=e.depth-t.depth;for(let e=0;e<n;e++)r=Je.types.memberExpression(r,Je.types.identifier("_"));if(n<0)throw new Error("Unable to find scope for reference.");return r}function Kn(e,t){const r=$t(Ss(t));return Je.types.memberExpression(Zn(e,t.section),r,"Identifier"!==r.type)}function Xn(e,t){return e.start=t.start,e.loc=t.loc,e.end=t.end,e}var Yn=Symbol("hoist is invoked"),[Qn]=re((()=>new Set)),[es,ts]=re((()=>0));function rs(e,t,r,n,s,o,a=null,i=!1){const c=es(),l={id:c,name:e,type:t,loc:a,section:r,property:o,declared:i,closureSections:void 0,excludeProperties:void 0,serialize:!1,sources:void 0,aliases:new Set,hoists:new Map,propertyAliases:new Map,upstreamAlias:n,upstreamExpression:s,downstreamExpressions:new Set,scopeOffset:void 0,export:void 0,nullable:!s?.confident||null==s.computed};if(o){i&&(n.nullable=!1);const e=n.propertyAliases.get(o);e?(l.property=void 0,l.upstreamAlias=e,e.aliases.add(l)):n.propertyAliases.set(o,l)}else n&&n.aliases.add(l);return ts(c+1),Qn().add(l),l}function ns(e,t,r,n){const s=e.node.var;if(s){const o=pe(e),a=xs(r);r&&n&&(n.pruned=!0),cs(s,t,e.scope,o,a,n,void 0)}}function ss(e,t,r,n){const s=e.node.params;if(e.node.body.length&&s.length){r&&n&&(n.pruned=!0);const o=pe(e),a=xs(r),i=a||((e.node.extra??={}).binding=rs(D("params"),t,o,a,n,void 0));o.params=i;for(let r=0;r<s.length;r++)cs(s[r],t,e.scope,o,i,n,r+"")}}function os(e,t){const r=t.section,n=pe(e),s=function(e,t){let r=e;for(t.depth<e.depth&&(r=t,t=e);r;){if(t===r||!t.parent)return r;(t=t.parent).depth<r.depth&&(r=r.parent)}throw new Error("No common section")}(n,r),o=e.node.extra??={};let a=t.hoists.get(s);if(!a){t.hoists.set(s,a=rs(D("hoisted_"+e.node.name),5,s,void 0,void 0,void 0,t.loc,!0)),r.hoisted=gs.add(r.hoisted,t);let n=r.parent;for(;n&&n!==s;)n.isHoistThrough=!0,n=n.parent}o.hoistedBinding=a,Ge(e)?(o.read=Ps(a,void 0),o.section=n,o[Yn]=!0):ls(e,a),n.referencedHoists=gs.add(n.referencedHoists,a)}function as(e,t){const r=pe(e);is(e),Le(e.node,(e=>{if(e.name===t.name){const n=e.extra??={};r.assignments=gs.add(r.assignments,t),n.assignment=t,n.section=r}}))}function is(e){const t=We(e);t&&((t.node.extra??={}).referencesScope=!0)}function cs(e,t,r,n,s,o,a){switch(e.type){case"Identifier":(e.extra??={}).binding=rs(e.name,t,n,s,o,a,e.loc,!0),function(e){const{identifier:t,referencePaths:r,constantViolations:n}=e,s=t.extra.binding;for(const e of r){const t=pe(e);ke(s.section,t)?ls(e,s):os(e,s)}for(const e of n)if(e.isUpdateExpression())as(e.get("argument"),s);else if(e.isAssignmentExpression()&&(as(e.get("left"),s),"="!==e.node.operator)){const t=e.get("left");t.isIdentifier()&&ls(t,s)}}(r.getBinding(e.name));break;case"ObjectPattern":{const o=(a?s.propertyAliases.get(a):s)||((e.extra??={}).binding=rs(D(a||"pattern"),t,n,s,void 0,a,e.loc));for(const s of e.properties)if("RestElement"===s.type)cs(s.argument,t,r,n,o,void 0,a);else{let e;if("Identifier"===s.key.type)e=s.key.name;else{if("StringLiteral"!==s.key.type)throw new Error("computed keys not supported in object pattern");e=s.key.value}cs(s.value,t,r,n,o,void 0,e)}break}case"ArrayPattern":{const o=(a?s.propertyAliases.get(a):s)||((e.extra??={}).binding=rs(D(a||"pattern"),t,n,s,void 0,a,e.loc));let i=-1;for(const s of e.elements)i++,s&&("RestElement"===s.type?cs(s.argument,t,r,n,o,void 0,a):cs(s,t,r,n,o,void 0,`${i}`));break}case"AssignmentPattern":cs(e.left,t,r,n,s,void 0,a)}}function ls(e,t){let r=e,n=t,s=t.name;for(;;){const{parent:e}=r;if(!M.types.isMemberExpression(e))break;const t=Is(e);if(void 0===t)break;if(n.propertyAliases.has(t))r=r.parentPath,n=n.propertyAliases.get(t),s=n.name;else{if(Ge(r.parentPath)&&!Bs(t))break;r=r.parentPath,n=rs(s+=`_${t.replace(/[^a-zA-Z0-9_$]/g,"_")}`,n.type,n.section,n,void 0,t)}}const o=We(r),a=Ve(o||r),{section:i}=function(e,t,r){const n=e.node.extra??={},s=bs();return n.section=pe(e),s.set(n,J(s.get(n),{binding:t,node:r})),n}(a,n,r.node);if(o){const e=hs(),t=o.node.extra??={};t.section=i,e.set(t,J(e.get(t),{binding:n,node:r.node}))}}var[ps]=re((()=>new Map));function ds(e,t,r){(t.extra??={}).section=e,ps().set(t,r)}function us(e,t){const r=e.length,n=r-t.length;if(0!==n)return n;for(let n=0;n<r;n++){const r=gs.compare(e[n],t[n]);if(0!==r)return r}return 0}function fs(e,t){let r;for(const n of e)n.section===t&&K(n.sources,(e=>{e.scopeOffset&&(!r||r.id<e.scopeOffset.id)&&(r=e.scopeOffset)}));return r}var ms=new WeakMap;function ys(e){const t=new Set;let r;!function e(n){if(4===n.type||3===n.type){let s,o=n;for(;s=o.upstreamAlias;)o=s;if(o.upstreamExpression){if(t.has(o))return;t.add(o),K(o.upstreamExpression.referencedBindings,e)}else r=2===o.type?gs.add(r,n):gs.add(r,o)}else r=gs.add(r,n)}(e),e.sources=r}var gs=new G((function(e,t){return(e.section.id-t.section.id||e.type!==t.type&&(0===e.type||0===t.type))&&e.type-t.type||e.id-t.id})),[bs]=re((()=>new Map)),[hs]=re((()=>new Map));function vs(e){if(Array.isArray(e))for(const t of e)(t.extra??={}).pruned=!0;else(e.extra??={}).pruned=!0}function xs(e){return e&&(e.property?e:e.upstreamAlias||e)}function ws(e,t=[]){if(e.arguments)for(const r of e.arguments)t.push(r);for(const r of e.attributes)t.push(r.value);for(const r of e.body.attributeTags?e.body.body:e.attributeTags)switch(r.type){case"MarkoTag":ws(r,t);break;case"MarkoScriptlet":for(const e of r.body)t.push(e)}return t}function As(e,t){return Ue()?M.types.numericLiteral(e.id):M.types.stringLiteral(e.name+(t||0===e.type?`/${e.id}`:""))}function Ss(e,t){return Ue()?e.id+"":e.name+(t||0===e.type?`/${e.id}`:"")}function ks(e){return e.sectionAccessor?e.sectionAccessor.prefix+Ss(e.sectionAccessor.binding):ze().ClosureScopes+e.id}function Es(e){const t=ks(e);return t?"number"==typeof t?M.types.numericLiteral(t):M.types.stringLiteral(t):void 0}function Ts(e){const{extra:t}=e;if(!t)return;let r,{binding:n,read:s}=t;if(s&&(void 0===s.props?(n=s.binding,s=void 0):n=void 0),n)"Identifier"===e.type?5===n.type?r=e.extra?.[Yn]?M.types.callExpression(rn(n),[Zn(e.extra.section,n.section)]):M.types.identifier(Ss(n)):n.name!==e.name&&(e.name=n.name):r=M.types.identifier(n.name);else if(s&&(r=Dt(M.types.identifier(s.binding.name),Array.isArray(s.props)?s.props[0]:s.props),Array.isArray(s.props)))for(let e=1;e<s.props.length;e++)r=Dt(r,s.props[e]);return r&&Xn(r,e)}function Ms(e,t){let r=!t.downstreamExpressions.size;for(const n of t.aliases)Ms(e,n)?t.aliases.delete(n):r=!1;for(const[n,s]of t.propertyAliases)Ms(e,s)?t.propertyAliases.delete(n):r=!1;return r&&e.delete(t),r}function Cs(e,t,r){let n;if(Array.isArray(t))for(const e of t){let{binding:r}=e;if(e.node){const n=(e.node.extra??={}).read??=js(t,r,void 0);({binding:r}=(e.node.extra??={}).read=n)}n=gs.add(n,r)}else t&&(t.node&&((t.node.extra??={}).read=Ps(t.binding,void 0)),n=t.binding);if(Array.isArray(n)){const t=r.get(e.section)||[],s=Y(us,t,n);s?n=s:r.set(e.section,Q(us,t,n))}return n}function js(e,t,r){const{upstreamAlias:n}=t;if(n&&Array.isArray(e)){const o=(s=t).property??s.upstreamAlias?.property,a=void 0===o?r:J(r,o);for(const{binding:r}of e)if(r!==t){let t=n;for(;t;){if(r===t)return js(e,t,a);t=t.upstreamAlias}}}var s;return Ps(t,r)}function Ps(e,t){return{binding:e,props:t}}function Is(e){switch(e.property.type){case"StringLiteral":return e.property.value;case"NumericLiteral":return""+e.property.value;case"Identifier":if(e.computed)return;return e.property.name}}function Bs(e){return/^on[-A-Z][a-zA-Z0-9_$]|[a-zA-Z_$][a-zA-Z0-9_$]*Change$/.test(e)}function Ls(e){return!(!e||e.pruned||!e.section)}function Ns(e){return Ls(e)&&void 0!==e.assignment}function Os(e){return Ls(e)&&void 0!==e.registerId}var $s=Symbol("await tag dom binding"),Fs={analyze(e){(0,A.assertNoVar)(e),(0,A.assertNoArgs)(e),g(e),(0,A.assertNoAttributeTags)(e);const{node:t}=e,r=e.get("body"),n=pe(e),[s]=t.attributes,o=e.node.extra??={};if(o[$s]=rs("#text",0,n,void 0,o),!s)throw e.get("name").buildCodeFrameError("The `await` tag requires a value.");if(t.attributes.length>1||!w.types.isMarkoAttribute(s)||"value"!==s.name)throw e.get("name").buildCodeFrameError("The `await` tag only supports the `value` attribute.");if(!t.body.body.length)throw e.get("name").buildCodeFrameError("The `await` tag requires body content.");if(t.body.params.length&&(t.body.params.length>1||w.types.isSpreadElement(t.body.params[0])))throw e.get("name").buildCodeFrameError("The `await` tag only supports a single parameter.");const a=le(r);pe(e),ss(r,3,void 0,T(s.value)),a.upstreamExpression=s.value.extra},translate:or({html:{enter(e){const t=de(e.get("body"));t?(ye(t,!0),Tr(e)):e.remove()},exit(e){const{node:t}=e,[r]=t.attributes,n=t.extra[$s],s=e.get("body"),o=ue(e);Mr(e),Tn(s),e.replaceWith(w.types.expressionStatement(zt("fork",fe(o),As(n),r.value,w.types.arrowFunctionExpression(t.body.params,Rr(t.body.body)))))[0].skip()}},dom:{enter(e){const t=de(e.get("body"));t?(ye(t,!0),hr(e,37),br(e)):e.remove()},exit(e){const{node:t}=e,r=t.extra[$s],n=ue(e),s=de(e.get("body")),o=sn(n,r,"await");o.build=()=>zt("awaitTag",As(r),w.types.identifier(s.name)),gn(n,s.upstreamExpression?.referencedBindings,o,e.node.attributes[0].value),e.remove()}}}),attributes:{},autocomplete:[{description:"Use to consume asynchronous an data.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#await"}],types:f.name+"/tag-types/await.d.marko"},Ds=r("../../browser-shims/compiler/index.js"),Rs=r("../../browser-shims/compiler/babel-utils.js"),Us={parse(e){const{node:t,hub:{file:r}}=e,n=t.rawValue,s=n.replace(/^client\s*/,"").trim(),o=t.name.start+(n.length-s.length);let a=(0,Rs.parseStatements)(r,s,o,o+s.length);1===a.length&&Ds.types.isBlockStatement(a[0])&&(a=a[0].body),e.replaceWith(Ds.types.markoScriptlet(a,!0,"client"))},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:"client <statement>",description:"A JavaScript statement which is only evaluated once your template is loaded on the client.",descriptionMoreURL:"https://markojs.com/docs/syntax/#client-javascript"}]},zs=r("../../browser-shims/compiler/index.js"),_s=r("../../browser-shims/compiler/babel-utils.js"),Vs=r("../../browser-shims/compiler/index.js");function Ws(e,t,r="const"){const{node:{var:n}}=e;n&&e.insertBefore(Vs.types.variableDeclaration(r,[Vs.types.variableDeclarator(n,t)]))}var qs={analyze(e){(0,_s.assertNoArgs)(e),(0,_s.assertNoParams)(e),b(e);const{node:t}=e,[r]=t.attributes;if(!t.var)throw e.get("name").buildCodeFrameError("The `const` tag requires a tag variable.");if(!r)throw e.get("name").buildCodeFrameError("The `const` tag requires a value.");if(t.attributes.length>1||!zs.types.isMarkoAttribute(r)||!r.default&&"value"!==r.name)throw e.get("name").buildCodeFrameError("The `const` tag only supports the `value` attribute.");const n=zs.types.isIdentifier(r.value)?e.scope.getBinding(r.value.name)?.identifier.extra?.binding:void 0;ns(e,4,n,T(r.value))},translate:{exit(e){const{node:t}=e,[r]=t.attributes,{value:n}=r;if(De()){const r=ue(e),s=t.var.extra?.binding;if(s&&!s.upstreamAlias){const e=on(s);gn(r,n.extra?.referencedBindings,e,n)}}else Ws(e,n);e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Use to create an constant binding.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#const"}],types:f.name+"/tag-types/const.d.marko"},Hs=r("../../browser-shims/compiler/index.js"),Gs=r("../../browser-shims/compiler/babel-utils.js"),Js={analyze(e){const[t]=e.node.attributes;if((0,Gs.assertNoVar)(e),(0,Gs.assertNoArgs)(e),(0,Gs.assertNoParams)(e),b(e),e.node.attributes.length>1||1===e.node.attributes.length&&(!Hs.types.isMarkoAttribute(t)||!t.default&&"value"!==t.name))throw e.get("name").buildCodeFrameError("The `debug` tag only supports the `value` attribute.")},translate:{exit(e){const t=ue(e),[r]=e.node.attributes,n=r?.value.extra?.referencedBindings,s=Xn(Hs.types.debuggerStatement(),e.node);Fe()?e.insertBefore(s):fn("render",t,n,s),e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Debug on value change.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#debug"}],types:f.name+"/tag-types/debug.d.marko"},Zs=(r("../../browser-shims/compiler/index.js"),r("../../browser-shims/compiler/babel-utils.js")),Ks=r("../../browser-shims/compiler/index.js"),Xs=r("../../browser-shims/compiler/babel-utils.js"),Ys=new WeakMap;function Qs(e){let t=Ys.get(e);return t||(t=D(e.name),Ys.set(e,t)),Ks.types.identifier(t)}function eo(e){if(e.node.extra?.attributeTags)return e.node.extra.attributeTags;const t=e.node.body.attributeTags?e.get("body").get("body"):e.get("attributeTags");if(!t.length)return;const r=(e.node.extra??={}).attributeTags={},n={},s=new Map;for(const e of t)if(e.isMarkoTag())if((0,Xs.isAttributeTag)(e)){const t=_(e);r[t]||=to(t,[t]),(n[t]||=[]).push(e),eo(e)}else{const t=(0,Xs.isLoopTag)(e);let o;for(const a of ro(e,n)){const n=r[a];if(n)if(o){if(o!==n.group)for(const e of n.group)r[e].group=o,o.push(e)}else o=n.group;let i=r[a];i||(i=r[a]=to(a,[]),o=i.group,o.push(a)),i.dynamic=!0,t&&(i.repeated=!0),s.set(e,a)}}for(const[e,t]of s)(e.node.extra??={}).attributeTagGroup=r[t].group;for(const e in n){const t=r[e];if(!t.repeated){const r=n[e];r.length>1&&(t.repeated=!t.dynamic||no(r))}}return r}function to(e,t){return{name:e.slice(1),dynamic:!1,repeated:!1,group:t}}function ro(e,t,r=new Set){const n=e.node.body.attributeTags?e.get("body").get("body"):e.get("attributeTags");for(const e of n)if(e.isMarkoTag())if((0,Xs.isAttributeTag)(e)){const n=_(e);r.add(n),(t[n]||=[]).push(e),eo(e)}else ro(e,t,r);return r}function no(e){let t;const r=new Set;for(const n of e){const e=Qt(n);if(r.has(e)||!H(e))return!0;const s=so(e);if(s&&s!==(t||=s))return!0;r.add(e)}return!1}function so(e){if("if"===_(e))return e;let t=e.getPrevSibling();for(;t.node;){if(t.isMarkoTag()&&"if"===_(t))return t;t=t.getPrevSibling()}}var oo=r("../../browser-shims/compiler/index.js"),ao=r("../../browser-shims/compiler/babel-utils.js"),io=r("../../browser-shims/compiler/index.js"),co=r("../../browser-shims/compiler/babel-utils.js"),lo=(r("../../browser-shims/compiler/index.js"),r("../../browser-shims/compiler/babel-utils.js")),po=r("../../browser-shims/compiler/index.js"),uo=r("../../browser-shims/compiler/babel-utils.js"),fo=Symbol("native tag binding"),mo=Symbol("serialize marker"),yo=Symbol("node getter id"),go=new WeakMap;function bo(e,t){switch(e){case"input":if(t.checked||t.checkedChange)return{special:!1,helper:"controllable_input_checked",attrs:[t.checked,t.checkedChange]};if(t.checkedValue||t.checkedValueChange)return{special:!0,helper:"controllable_input_checkedValue",attrs:[t.checkedValue,t.checkedValueChange,t.value]};if(t.value||t.valueChange)return{special:!1,helper:"controllable_input_value",attrs:[t.value,t.valueChange]};break;case"select":if(t.value||t.valueChange)return{special:!0,helper:"controllable_select_value",attrs:[t.value,t.valueChange]};break;case"textarea":if(t.value||t.valueChange)return{special:!0,helper:"controllable_textarea_value",attrs:[t.value,t.valueChange]};break;case"details":case"dialog":if(t.open||t.openChange)return{special:!1,helper:"controllable_detailsOrDialog_open",attrs:[t.open,t.openChange]}}}var ho={transform:{enter(e){if("textarea"===_(e)&&e.node.body.body.length){const t=[];for(const r of e.node.body.body){if(!("MarkoText"===r.type||"MarkoPlaceholder"===r.type&&r.escape))throw e.hub.file.hub.buildError(r,"Unexpected content in textarea, only text and placeholders are supported.",SyntaxError);t.push(r.value)}e.node.attributes.push(po.types.markoAttribute("value",cr(t)||vo())),e.node.body.body=[]}}},analyze:{enter(e){(0,uo.assertNoArgs)(e),(0,uo.assertNoParams)(e),(0,uo.assertNoAttributeTags)(e);const{node:t}=e;if(t.var&&!po.types.isIdentifier(t.var))throw e.get("var").buildCodeFrameError("Tag variables on native elements cannot be destructured.");const r=_(e),n=pe(e);let s=!1,o=!1;const a={},{attributes:i}=e.node;let c,l;for(let e=i.length;e--;){const t=i[e];if(po.types.isMarkoAttribute(t)){if(a[t.name]){vs(t.value);continue}a[t.name]=t,ct(t.name)||(p=t.name,/^(?:value|checked(?:Value)?|open)Change/.test(p))?((t.value.extra??={}).isEffect=!0,s=!0):T(t.value).confident||(o=!0)}else po.types.isMarkoSpreadAttribute(t)&&(s=!0,o=!0,(t.value.extra??={}).isEffect=!0);l?l.push(t.value):po.types.isMarkoSpreadAttribute(t)&&(l=[t.value],c=bo(r,a))}var p;if(function(e,t){const r=[t.open||t.openChange,t.checked||t.checkedChange,t.checkedValue||t.checkedValueChange,t.valueChange].filter(Boolean);if(r.length>1)throw e.get("name").buildCodeFrameError(`The attributes ${r.map((e=>`"${e.name}"`)).join(", ")} are mutually exclusive.`)}(e,a),l){if(c&&!c.attrs.every(Boolean)){for(const e of c.attrs)e&&l.push(e.value);c=void 0}ds(n,e.node,l)}else c=bo(r,a);if(c&&ds(n,c.attrs.find(Boolean).value,c.attrs.map((e=>e?.value))),t.var||s||o){(0,uo.getProgram)().node.extra.isInteractive||=s;const r="StringLiteral"===t.name.type?t.name.value:po.types.toIdentifier(e.get("name")),o=t.extra??={},a="#"+r;(s||t.var)&&(o[mo]=!0);const i=o[fo]=rs(a,0,n);if(t.var){const r=e.scope.getBinding(t.var.name);for(const e of r.referencePaths){const t=ue(e);is(e),ke(n,t)?Ge(e)||(o[yo]||=vn(n,a)):os(e,i)}}}}},translate:{enter(e){const t=_(e),r=e.node.extra,n=r[fo],s=Fe(),o=e.get("name"),a=(0,uo.getTagDef)(e),i=kr(e),c=ue(e);if(s&&r.tagNameNullable&&Tr(e),e.has("var")){const t=e.node.var.name,o=e.scope.getBinding(t),a=r[yo];if(s){for(const e of o.referencePaths){const t=ue(e);e.node.extra?.hoist||Mn(t,c)}Gr(c,!0),Ws(e,zt("nodeRef",a&&fe(c),a&&po.types.stringLiteral(a)))}else{let r;a&&(r=R(`get_${t}`),(0,uo.getProgram)().node.body.push(po.types.variableDeclaration("const",[po.types.variableDeclarator(r,zt("nodeRef",po.types.stringLiteral(a),po.types.stringLiteral(ze().Getter+As(n).value)))])));for(const t of o.referencePaths)if(!t.node.extra?.hoistedBinding){const s=ue(t);Ge(t)?t.parentPath.replaceWith(po.types.expressionStatement(Kn(s,n))):r?t.replaceWith(po.types.callExpression(r,[Zn(s,ue(e))])):t.replaceWith(po.types.expressionStatement(po.types.memberExpression(Zn(c,s),po.types.stringLiteral(ze().Getter+As(n).value),!0)))}}}let l;n&&(l=As(n),hr(e,32)),i`<${o.node}`;const p=function(e,t){const r={},{attributes:n}=t,s=new Set;let o,a,i,c,l;for(let t=n.length;t--;){const o=n[t],{value:a}=o;if(po.types.isMarkoSpreadAttribute(o)){if(!i&&(i=[],l=bo(e,r),l&&!l.attrs.every(Boolean))){for(const e of l.attrs)e&&(i.push(Ft(e.name,e.value)),s.delete(e));l=void 0}i.push(po.types.spreadElement(a))}else r[o.name]||(r[o.name]=o,i?i.push(Ft(o.name,o.value)):s.add(o))}if(i||(l=bo(e,r),!1!==l?.special||l.attrs[1]||(l=void 0)),l)for(const e of l.attrs)e&&s.delete(e);const p=[...s].reverse();if(i){if(i.reverse(),l)for(const e of l.attrs)e&&(c||=[]).push(Ft(e.name,po.types.numericLiteral(1)));for(const{name:e}of p)(c||=[]).push(Ft(e,po.types.numericLiteral(1)));c&&(a=po.types.objectExpression(c)),o=Bo(i)}return{staticAttrs:p,staticControllable:l,spreadExpression:o,skipExpression:a}}(t,e.node),{staticAttrs:d,staticControllable:u,skipExpression:f}=p;let m,{spreadExpression:y}=p;if(u){const{helper:e,attrs:r}=u,n=r.find(Boolean),o=n.value.extra?.referencedBindings,a=r.map((e=>e?.value));s?("select"!==t&&"textarea"!==t&&i`${zt(e,fe(c),l,...a)}`,En(c,void 0)):(fn("render",c,o,po.types.expressionStatement(zt(e,_n,l,...a))),fn("effect",c,void 0,po.types.expressionStatement(zt(`${e}_effect`,_n,l))))}if(s)if("select"===t){if(u)go.set(e.node,{value:u.attrs[0]?.value||vo(),valueChange:u.attrs[1]?.value||vo()});else if(y){const t=R("select_input");e.insertBefore(po.types.variableDeclaration("const",[po.types.variableDeclarator(t,y)])),go.set(e.node,{value:po.types.memberExpression(t,po.types.identifier("value")),valueChange:po.types.memberExpression(t,po.types.identifier("valueChange"))}),y=t}}else if("textarea"===t){let t,r;if(u)t=u.attrs[0]?.value,r=u.attrs[1]?.value;else if(y){const n=R("textarea_input");e.insertBefore(po.types.variableDeclaration("const",[po.types.variableDeclarator(n,y)])),t=po.types.memberExpression(n,po.types.identifier("value")),r=po.types.memberExpression(n,po.types.identifier("valueChange")),y=n}(t||r)&&(m=zt("controllable_textarea_value",fe(ue(e)),As(n),t,r))}for(const e of d){const{name:r,value:n}=e,{confident:o,computed:a}=n.extra||{},p=n.extra?.referencedBindings;if(s&&"option"===t&&"value"===r)i`${zt("optionValueAttr",n)}`;else switch(r){case"class":case"style":{const e=`${r}Attr`;o?i`${_t()[e](a)}`:s?i`${zt(e,n)}`:fn("render",c,p,po.types.expressionStatement(zt(e,po.types.memberExpression(_n,l,!0),n)));break}default:o?i`${_t().attr(r,a)}`:s?ct(r)?En(c,p):i`${zt("attr",po.types.stringLiteral(r),n)}`:ct(r)?fn("effect",c,p,po.types.expressionStatement(zt("on",po.types.memberExpression(_n,l,!0),po.types.stringLiteral(lt(r)),n))):fn("render",c,p,po.types.expressionStatement(zt("attr",po.types.memberExpression(_n,l,!0),po.types.stringLiteral(r),n)))}}if(y&&(s?(En(c,r.referencedBindings),f?i`${zt("partialAttrs",y,f,l,fe(c),o.node)}`:i`${zt("attrs",y,l,fe(c),o.node)}`):(fn("render",c,r.referencedBindings,f?po.types.expressionStatement(zt("partialAttrs",_n,l,y,f)):po.types.expressionStatement(zt("attrs",_n,l,y))),fn("effect",c,r.referencedBindings,po.types.expressionStatement(zt("attrsEvents",_n,l)),!1))),a&&a.parseOptions?.openTagOnly)switch(a.htmlType){case"svg":case"math":i`/>`;break;default:i`>`}else i`>`;s&&r.tagNameNullable&&e.insertBefore(po.types.ifStatement(o.node,Er(e)))[0].skip(),m&&i`${m}`,yr(e)},exit(e){const t=e.node.extra,r=t[fo],n=Fe(),s=(0,uo.getTagDef)(e)?.parseOptions?.openTagOnly,o=n&&go.get(e.node),a=_(e);n&&t.tagNameNullable&&Mr(e),o?(kr(e)`</${e.node.name}>`,Mr(e),e.insertBefore(po.types.expressionStatement(zt("controllable_select_value",fe(ue(e)),As(r),o.value,o.valueChange,po.types.arrowFunctionExpression([],po.types.blockStatement(e.node.body.body)))))):e.insertBefore(e.node.body.body).forEach((e=>e.skip()));const i=[t];for(const t of e.node.attributes)t.value.extra&&i.push(t.value.extra);const c=Ce(i),l=r&&(t[mo]||void 0===t[mo]&&!!c);s||o||kr(e,n&&!l&&("html"===a||"body"===a))`</${e.node.name}>`,n&&t.tagNameNullable&&e.insertBefore(po.types.ifStatement(e.node.name,Er(e)))[0].skip(),l&&jr(e,r),gr(e),e.remove()}}};function vo(){return po.types.unaryExpression("void",po.types.numericLiteral(0))}var xo=Symbol("only child in parent"),wo=Symbol("potential only child node ref");function Ao(e,t=1){const r=e.node.extra;if(void 0!==r[xo])return r[xo];const n=Qt(e);return n&&(0,lo.getTagDef)(n)?.html?r[xo]=e.parent.body.length===t:r[xo]=!1}function So(e,t,r=1){if(Ao(e,r)){const r=Qt(e).node,n=r.name?.value;return(r.extra??={})[fo]??=rs("#"+n,0,t)}return(e.node.extra??={})[wo]??=rs("#text",0,t)}var ko={analyze(e){const t=e.node.extra??={},r=e.node.body.attributeTags;let n;switch((0,co.assertNoVar)(e),(0,co.assertNoArgs)(e),g(e),Eo(e.node)){case"of":n=["of"];break;case"in":n=["in"];break;case"to":n=["to","from","step"];break;default:throw e.buildCodeFrameError("Invalid `for` tag, missing an `of=`, `in=`, `to=` attribute.")}if(r||n.push("by"),(0,co.assertAllowedAttributes)(e,n),r)return;const s=e.get("body"),o=le(s);if(!o)return void vs(ws(e.node));const a=pe(e);ss(s,3,void 0,t),ds(a,e.node,ws(e.node)),o.sectionAccessor={binding:So(e,a),prefix:ze().LoopScopeMap},o.upstreamExpression=t,o.isBranch=!0},translate:or({html:{enter(e){if(e.node.body.attributeTags)return;const t=de(e.get("body"));t?(ye(t,!0),Ao(e)||(hr(e,37),br(e)),Tr(e)):e.remove()},exit(e){if(e.node.body.attributeTags)return;const t=e.get("body"),r=ue(e),n=de(t),{node:s}=e,o=Ao(e),a=So(e,r),i=Yt(s),c=Eo(s),l=s.body.params,p=[],d=s.body.body,u=je(n),f=we(n)||u?.all,m=null===n.content||n.content.singleChild&&4!==n.content.startType;f&&o&&(Qt(e).node.extra[mo]=!1),Mr(e),Tn(t);const y=Mo(c,i),g=f?function(e,t){if(t)switch(e){case"of":return"resumeSingleNodeForOf";case"in":return"resumeSingleNodeForIn";case"to":return"resumeSingleNodeForTo"}else switch(e){case"of":return"resumeForOf";case"in":return"resumeForIn";case"to":return"resumeForTo"}}(c,m):To(c);y.push(io.types.arrowFunctionExpression(l,io.types.blockStatement(d))),f&&(y.push(i.by||io.types.numericLiteral(0),fe(r),As(a)),o&&y.push(io.types.numericLiteral(1))),p.push(io.types.expressionStatement(zt(g,...y)));for(const t of e.replaceWithMultiple(p))t.skip()}},dom:{enter(e){if(e.node.body.attributeTags)return;const t=de(e.get("body"));t?(ye(t,!0),Ao(e)||(hr(e,37),br(e))):e.remove()},exit(e){if(e.node.body.attributeTags)return;const t=e.get("body"),r=ue(e),n=de(t),{node:s}=e,o=s.extra,{referencedBindings:a}=o,i=So(e,r);Wr(e,((e,t)=>zt("loopClosure",As(e),As(i),t)));const c=Eo(s),l=sn(r,i,"for");l.build=()=>zt(function(e){switch(e){case"of":return"loopOf";case"in":return"loopIn";case"to":return"loopTo"}}(c),As(i),io.types.identifier(n.name));const p=s.body.params;l.hasDownstreamIntersections=()=>{for(const e of p){const t=e.extra?.binding;if(t)for(const{referencedBindings:e}of t.downstreamExpressions)if(sn(n,e).hasDownstreamIntersections())return!0}return!1};const d=Yt(s),u=Mo(c,d);d.by&&u.push(d.by),gn(r,a,l,io.types.arrayExpression(u)),e.remove()}}}),parseOptions:{controlFlow:!0},attributes:{of:{type:"expression",autocomplete:[{description:"Iterates over a list of items."}]},in:{type:"expression",autocomplete:[{description:"Iterates over the keys and values of an object."}]},to:{type:"number",autocomplete:[{description:"Iterates up to the provided number (inclusive)"}]},from:{type:"number",autocomplete:[{description:"Iterates starting from the provided number (inclusive)"}]},step:{type:"number",autocomplete:[{description:"The amount to increment during each interation (with from/to)"}]}},autocomplete:[{snippet:"for|${1:value, index}| of=${3:array}",description:"Use to iterate over lists, object properties, or between ranges.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#iterating-over-a-list"},{snippet:"for|${1:name, value}| in=${3:object}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#iterating-over-an-objects-properties"},{snippet:"for|${1:index}| to=${2:number}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#iterating-between-a-range-of-numbers"}]};function Eo(e){for(const t of e.attributes)if("MarkoAttribute"===t.type)switch(t.name){case"of":case"in":case"to":return t.name}}function To(e){switch(e){case"of":return"forOf";case"in":return"forIn";case"to":return"forTo"}}function Mo(e,t){switch(e){case"in":return[t.in];case"of":return[t.of];case"to":return[t.to,t.from||io.types.numericLiteral(0),t.step||io.types.numericLiteral(1)]}}var Co=new WeakSet;function jo(e,t,r=[],n="content"){const s=new Set,o=[],a=e.node.extra?.attributeTags;if(a){for(const e in a){const n=a[e];No(t,n.name)&&(s.add(n.name),n.dynamic&&(r.push(oo.types.variableDeclaration("let",[oo.types.variableDeclarator(Qs(n))])),o.push(Ft(n.name,Qs(n)))))}const i=e.node.body.attributeTags?e.get("body").get("body"):e.get("attributeTags");for(let e=0;e<i.length;e++){const s=i[e];if(s.isMarkoTag())if((0,ao.isAttributeTag)(s)){const c=a[_(s)];if(c.dynamic)e=Io(i,e,a,r,t,n);else{const e=jo(s,t?.[c.name]?.props,r,n);if(c.repeated){const t=Oo(c.name,o);t?t.value=zt("attrTags",t.value,Bo(e.properties)):o.push(Ft(c.name,zt("attrTag",Bo(e.properties))))}else o.push(Ft(c.name,zt("attrTag",Bo(e.properties))))}}else e=Io(i,e,a,r,t,n)}}if(!s.has(n)&&No(t,n)){s.add(n);const t=function(e){const t=e.node.extra?.section;if(t){if(Fe()){const r=xe(t);return zt(r?"registerContent":"createContent",oo.types.stringLiteral(bn(t,"renderer")),oo.types.arrowFunctionExpression(e.node.params,oo.types.blockStatement(e.node.body)),r?fe(ue(function(e){let t=e;for(;(0,ao.isAttributeTag)(t)||(0,ao.isTransparentTag)(t);)t=Qt(t);return t}(e.parentPath))):void 0)}return oo.types.callExpression(oo.types.identifier(t.name),[_n])}}(e.get("body"));if(t){const e=oo.types.objectProperty(oo.types.identifier(n),t);Co.add(e),o.push(e)}}const{attributes:i}=e.node;for(let e=i.length;e--;){const r=i[e],{value:n}=r;oo.types.isMarkoSpreadAttribute(r)?o.push(oo.types.spreadElement(n)):!s.has(r.name)&&No(t,r.name)&&(s.add(r.name),o.push(Ft(r.name,n)))}return o.reverse(),{properties:o,statements:r}}function Po(e){for(const t of e)if(Co.has(t))return t}function Io(e,t,r,n,s,o="content"){const a=e[t];if(a.isMarkoTag())if((0,ao.isAttributeTag)(a)){const e=r[_(a)];if(No(s,e.name)&&e.dynamic){const t=jo(a,s?.[e.name]?.props,n,o);e.repeated?n.push(oo.types.expressionStatement(oo.types.assignmentExpression("=",Qs(e),zt("attrTags",Qs(e),Bo(t.properties))))):n.push(oo.types.expressionStatement(oo.types.assignmentExpression("=",Qs(e),zt("attrTag",Bo(t.properties)))))}}else switch(_(a)){case"if":return function(e,t,r,n,s,o){const a=e[t],i=[];let c=oo.types.ifStatement($o(a),oo.types.blockStatement(i));n.push(c),Lo(a,r,i,s,o);let l=t+1;for(;l<e.length;){const t=e[l];if(t.isMarkoTag())switch(_(t)){case"else-if":case"else":{const e=$o(t),n=[];if(Lo(t,r,n,s,o),e){c.alternate=c=oo.types.ifStatement(e,oo.types.blockStatement(n)),l++;continue}c.alternate=oo.types.blockStatement(n);break}}break}return l-1}(e,t,r,n,s,o);case"for":return function(e,t,r,n,s,o){const a=e[t],i=[];return Lo(a,r,i,s,o),n.push(function(e,t,r,n){return io.types.expressionStatement(zt(To(e),...Mo(e,t),io.types.arrowFunctionExpression(r,io.types.blockStatement(n))))}(Eo(a.node),Yt(a.node),a.node.body.params,i)),t}(e,t,r,n,s,o)}return t}function Bo(e){return 1===e.length&&oo.types.isSpreadElement(e[0])?e[0].argument:oo.types.objectExpression(e)}function Lo(e,t,r,n,s){const o=e.node.body.attributeTags?e.get("body").get("body"):e.get("attributeTags");for(let e=0;e<o.length;e++)e=Io(o,e,t,r,n,s)}function No(e,t){return!e||!!e[t]}function Oo(e,t){for(const r of t)if("ObjectProperty"===r.type)switch(r.key.type){case"StringLiteral":if(r.key.value===e)return r;break;case"Identifier":if(r.key.name===e)return r}return!1}function $o({node:{attributes:e}}){return 1===e.length?e[0].value:void 0}var Fo={analyze(e){if((0,Zs.assertNoArgs)(e),!e.node.var)throw e.get("name").buildCodeFrameError("The `define` tag requires a tag variable.");const t=e.get("body"),r=le(t);if(ns(e,4),r){const t=e.node.var?.extra?.binding;t&&(r.downstreamBinding=t.propertyAliases.get("content")||t)}ss(t,3),eo(e),ds(pe(e),e.node,ws(e.node))},translate:{enter(e){Fe()&&Tr(e)},exit(e){const{node:t}=e,r=jo(e);if(Fe())Mr(e),Tn(e.get("body")),e.insertBefore(r.statements),Ws(e,Bo(r.properties));else{const n=ue(e),s=t.extra?.referencedBindings,o=on(e.get("var").node.extra.binding);r.statements.length&&fn("render",n,s,r.statements),gn(n,s,o,Bo(r.properties))}e.remove()}},attributes:{},autocomplete:[{description:"Use to create a constant object binding that can be rendered.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#define"}],types:f.name+"/tag-types/define.d.marko"},Do=r("../../browser-shims/compiler/index.js"),Ro=r("../../browser-shims/compiler/babel-utils.js"),Uo={migrate:[e=>{(0,Ro.assertNoArgs)(e),(0,Ro.assertNoParams)(e),b(e),(0,Ro.assertNoAttributeTags)(e),g(e),(0,Ro.assertAllowedAttributes)(e,["value"]),(0,Ro.diagnosticDeprecate)(e,{label:"The 'effect' tag has been replaced by the 'script' tag.",fix(){const{node:t}=e;e.replaceWith(Do.types.markoTag(Xn(Do.types.stringLiteral("script"),t.name),t.attributes,t.body,t.arguments,t.var,t.attributeTags))}})}],attributes:{},types:f.name+"/tag-types/effect.d.marko"},zo=r("../../browser-shims/compiler/babel-utils.js"),_o={parse(e){const{node:t}=e;e.replaceWith((0,zo.parseStatements)(e.hub.file,t.rawValue,t.start,t.end)[0])},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:"export <value>"}]},Vo=r("../../browser-shims/compiler/index.js"),Wo=r("../../browser-shims/compiler/babel-utils.js"),qo=Symbol("comment tag binding"),Ho=Symbol("node getter id"),Go={analyze(e){(0,Wo.assertNoArgs)(e),(0,Wo.assertNoParams)(e),(0,Wo.assertNoAttributes)(e);const t=e.node.var;let r=!1,n=!1;if(t){if(!Vo.types.isIdentifier(t))throw e.get("var").buildCodeFrameError("The `html-comment` tag variable cannot be destructured.");r=!0;for(const r of e.scope.getBinding(t.name).referencePaths)if(!Ge(r)){n=!0;break}}const s=[];for(const t of e.get("body").get("body"))if(t.isMarkoPlaceholder())s.push(t.node.value),r=!0;else if(!t.isMarkoText())throw t.buildCodeFrameError("Invalid child. Only text is allowed inside an html comment.");if(r){const t=pe(e),r=e.node.extra??={};n&&(r[Ho]=vn(t,"comment")),r[qo]=rs("#comment",0,t),ds(t,e.node,s)}e.skip()},translate:{enter(e){const t=e.node.extra,r=t[qo];if(e.node.var){const n=t[Ho];if(Fe())Ws(e,zt("nodeRef",n&&fe(ue(e)),n&&Vo.types.stringLiteral(n)));else{const t=e.node.var.name,s=e.scope.getBinding(t).referencePaths;let o;n&&(o=R(`get_${t}`),(0,Wo.getProgram)().node.body.push(Vo.types.variableDeclaration("const",[Vo.types.variableDeclarator(o,zt("nodeRef",Vo.types.stringLiteral(n),As(r)))])));for(const t of s){const n=ue(t);Ge(t)?t.parentPath.replaceWith(Vo.types.expressionStatement(Kn(n,r))):o&&t.replaceWith(Vo.types.callExpression(o,[Zn(n,ue(e))]))}}}t[qo]&&hr(e,32),yr(e),kr(e)`<!--`},exit(e){const t=e.node.extra,r=t[qo],n=kr(e);if(Fe())for(const t of e.node.body.body)Vo.types.isMarkoText(t)?n`${t.value}`:Vo.types.isMarkoPlaceholder(t)&&n`${zt("escapeXML",t.value)}`;else{const s=[],o=[];let a="";for(const t of e.node.body.body)Vo.types.isMarkoText(t)?a+=t.value:Vo.types.isMarkoPlaceholder(t)&&(s.push(Vo.types.templateElement({raw:a})),o.push(t.value),a="");0===o.length?n`${a}`:(s.push(Vo.types.templateElement({raw:a})),fn("render",ue(e),t.referencedBindings,Vo.types.expressionStatement(zt("data",Vo.types.memberExpression(_n,As(r),!0),Vo.types.templateLiteral(s,o)))))}gr(e),n`-->`,r&&jr(e,r),e.remove()}},parseOptions:{text:!0},attributes:{},autocomplete:[{description:"Use to create an html comment that is not stripped from the output.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#html-comment"}]},Jo=r("../../browser-shims/compiler/index.js"),Zo=r("../../browser-shims/compiler/babel-utils.js"),Ko=Symbol("node getter id"),Xo={analyze(e){(0,Zo.assertNoArgs)(e),(0,Zo.assertNoParams)(e);const{node:t}=e;if(t.var&&!Jo.types.isIdentifier(t.var))throw e.get("var").buildCodeFrameError("Tag variables on native elements cannot be destructured.");const r=pe(e);let n=!1,s=!1;const o={},{attributes:a}=e.node;let i;for(let e=a.length;e--;){const t=a[e];if(Jo.types.isMarkoAttribute(t)){if(o[t.name]){vs(t.value);continue}o[t.name]=t,ct(t.name)?((t.value.extra??={}).isEffect=!0,n=!0):T(t.value).confident||(s=!0)}else Jo.types.isMarkoSpreadAttribute(t)&&(n=!0,s=!0,(t.value.extra??={}).isEffect=!0);i?i.push(t.value):Jo.types.isMarkoSpreadAttribute(t)&&(i=[t.value])}i&&ds(r,e.node,i);const c=[];let l=!1;for(const t of e.node.body.body)if(Jo.types.isMarkoPlaceholder(t))c.push(t.value),l=!0;else if(!Jo.types.isMarkoText(t))throw e.hub.buildError(t,"Invalid child. Only text is allowed inside an html-script.");if(c.length>1&&ds(r,c[0],c.slice(1)),t.var||n||s||l){(0,Zo.getProgram)().node.extra.isInteractive||=n;const s=t.extra??={},o="#script";if(s[mo]=n||!!t.var,s[fo]=rs(o,0,r),t.var)for(const n of e.scope.getBinding(t.var.name).referencePaths)if(!Ge(n)){s[Ko]=vn(r,o);break}}},translate:{enter(e){const t=e.node.extra,r=t[fo],n=Fe(),s=kr(e),o=ue(e);if(e.node.var){const s=t[Ko];if(n){const t=e.node.var.name,r=e.scope.getBinding(t).referencePaths;for(const e of r)Mn(ue(e),o);Ws(e,zt("nodeRef",s&&fe(o),s&&Jo.types.stringLiteral(s)))}else{const t=e.node.var.name,n=e.scope.getBinding(t).referencePaths;let o;s&&(o=R(`get_${t}`),(0,Zo.getProgram)().node.body.push(Jo.types.variableDeclaration("const",[Jo.types.variableDeclarator(o,zt("nodeRef",Jo.types.stringLiteral(s),As(r)))])));for(const t of n){const n=ue(t);Ge(t)?t.parentPath.replaceWith(Jo.types.expressionStatement(Kn(n,r))):o&&t.replaceWith(Jo.types.callExpression(o,[Zn(n,ue(e))]))}}}let a;r&&(a=As(r),hr(e,32)),s`<script`;const i=function(e){const t={},{attributes:r}=e,n=new Set;let s,o,a,i;for(let e=r.length;e--;){const s=r[e],{value:o}=s;Jo.types.isMarkoSpreadAttribute(s)?(a||(a=[]),a.push(Jo.types.spreadElement(o))):t[s.name]||(t[s.name]=s,a?a.push(Ft(s.name,s.value)):n.add(s))}const c=[...n].reverse();if(a){a.reverse();for(const{name:e}of c)(i||=[]).push(Ft(e,Jo.types.numericLiteral(1)));i&&(o=Jo.types.objectExpression(i)),s=Bo(a)}return{staticAttrs:c,spreadExpression:s,skipExpression:o}}(e.node),{staticAttrs:c,skipExpression:l,spreadExpression:p}=i;for(const e of c){const{name:t,value:r}=e,{confident:i,computed:c}=r.extra||{},l=r.extra?.referencedBindings;switch(t){case"class":case"style":{const e=`${t}Attr`;i?s`${_t()[e](c)}`:n?s`${zt(e,r)}`:fn("render",o,l,Jo.types.expressionStatement(zt(e,Jo.types.memberExpression(_n,a,!0),r)));break}default:i?s`${_t().attr(t,c)}`:n?ct(t)?En(o,l):s`${zt("attr",Jo.types.stringLiteral(t),r)}`:ct(t)?fn("effect",o,l,Jo.types.expressionStatement(zt("on",Jo.types.memberExpression(_n,a,!0),Jo.types.stringLiteral(lt(t)),r))):fn("render",o,l,Jo.types.expressionStatement(zt("attr",Jo.types.memberExpression(_n,a,!0),Jo.types.stringLiteral(t),r)))}}p&&(n?(En(o,t.referencedBindings),l?s`${zt("partialAttrs",p,l,a,fe(o),Jo.types.stringLiteral("script"))}`:s`${zt("attrs",p,a,fe(o),Jo.types.stringLiteral("script"))}`):(fn("render",o,t.referencedBindings,l?Jo.types.expressionStatement(zt("partialAttrs",_n,a,p,l)):Jo.types.expressionStatement(zt("attrs",_n,a,p))),fn("effect",o,t.referencedBindings,Jo.types.expressionStatement(zt("attrsEvents",_n,a)),!1))),s`>`,yr(e)},exit(e){const t=e.node.extra[fo],r=kr(e),n=t&&As(t);if(Fe())for(const t of e.node.body.body)Jo.types.isMarkoText(t)?r`${t.value}`:Jo.types.isMarkoPlaceholder(t)&&r`${zt("escapeScript",t.value)}`;else{const t=[],s=[];let o,a="";for(const r of e.node.body.body)Jo.types.isMarkoText(r)?a+=r.value:Jo.types.isMarkoPlaceholder(r)&&(o||=r,t.push(Jo.types.templateElement({raw:a})),s.push(r.value),a="");o?(t.push(Jo.types.templateElement({raw:a})),fn("render",ue(e),o.value.extra?.referencedBindings,Jo.types.expressionStatement(zt("textContent",Jo.types.memberExpression(_n,n,!0),Jo.types.templateLiteral(t,s))))):r`${a}`}r`</script>`,t&&jr(e,t),gr(e),e.remove()}},"@async":"#html-async","@crossorigin":"#html-crossorigin","@defer":"#html-defer","@integrity":"#html-integrity","@nomodule":"#html-nomodule","@nonce":"#html-nonce","@referrerpolicy":"#html-referrerpolicy","@src":"#html-src","@type":"#html-type","attribute-groups":["html-attributes"],parseOptions:{text:!0,preserveWhitespace:!0}},Yo=r("../../browser-shims/compiler/index.js"),Qo=r("../../browser-shims/compiler/babel-utils.js"),ea=Symbol("node getter id"),ta={analyze(e){(0,Qo.assertNoArgs)(e),(0,Qo.assertNoParams)(e);const{node:t}=e;if(t.var&&!Yo.types.isIdentifier(t.var))throw e.get("var").buildCodeFrameError("Tag variables on native elements cannot be destructured.");const r=pe(e);let n=!1,s=!1;const o={},{attributes:a}=e.node;let i;for(let e=a.length;e--;){const t=a[e];if(Yo.types.isMarkoAttribute(t)){if(o[t.name]){vs(t.value);continue}o[t.name]=t,ct(t.name)?((t.value.extra??={}).isEffect=!0,n=!0):T(t.value).confident||(s=!0)}else Yo.types.isMarkoSpreadAttribute(t)&&(n=!0,s=!0,(t.value.extra??={}).isEffect=!0);i?i.push(t.value):Yo.types.isMarkoSpreadAttribute(t)&&(i=[t.value])}i&&ds(r,e.node,i);const c=[];let l=!1;for(const t of e.node.body.body)if(Yo.types.isMarkoPlaceholder(t))c.push(t.value),l=!0;else if(!Yo.types.isMarkoText(t))throw e.hub.buildError(t,"Invalid child. Only text is allowed inside an html-style.");if(c.length>1&&ds(r,c[0],c.slice(1)),t.var||n||s||l){(0,Qo.getProgram)().node.extra.isInteractive||=n;const s=t.extra??={},o="#style";if(s[mo]=n||!!t.var,s[fo]=rs(o,0,r),t.var)for(const n of e.scope.getBinding(t.var.name).referencePaths)if(!Ge(n)){s[ea]=vn(r,o);break}}},translate:{enter(e){const t=e.node.extra,r=t[fo],n=Fe(),s=kr(e),o=ue(e);if(e.node.var){const s=t[ea];if(n){const t=e.node.var.name,r=e.scope.getBinding(t).referencePaths;for(const e of r)Mn(ue(e),o);Ws(e,zt("nodeRef",s&&fe(o),s&&Yo.types.stringLiteral(s)))}else{const t=e.node.var.name,n=e.scope.getBinding(t).referencePaths;let o;s&&(o=R(`get_${t}`),(0,Qo.getProgram)().node.body.push(Yo.types.variableDeclaration("const",[Yo.types.variableDeclarator(o,zt("nodeRef",Yo.types.stringLiteral(s),As(r)))])));for(const t of n){const n=ue(t);Ge(t)?t.parentPath.replaceWith(Yo.types.expressionStatement(Kn(n,r))):o&&t.replaceWith(Yo.types.callExpression(o,[Zn(n,ue(e))]))}}}let a;r&&(a=As(r),hr(e,32)),s`<style`;const i=function(e){const t={},{attributes:r}=e,n=new Set;let s,o,a,i;for(let e=r.length;e--;){const s=r[e],{value:o}=s;Yo.types.isMarkoSpreadAttribute(s)?(a||(a=[]),a.push(Yo.types.spreadElement(o))):t[s.name]||(t[s.name]=s,a?a.push(Ft(s.name,s.value)):n.add(s))}const c=[...n].reverse();if(a){a.reverse();for(const{name:e}of c)(i||=[]).push(Ft(e,Yo.types.numericLiteral(1)));i&&(o=Yo.types.objectExpression(i)),s=Bo(a)}return{staticAttrs:c,spreadExpression:s,skipExpression:o}}(e.node),{staticAttrs:c,skipExpression:l,spreadExpression:p}=i;for(const e of c){const{name:t,value:r}=e,{confident:i,computed:c}=r.extra||{},l=r.extra?.referencedBindings;switch(t){case"class":case"style":{const e=`${t}Attr`;i?s`${_t()[e](c)}`:n?s`${zt(e,r)}`:fn("render",o,l,Yo.types.expressionStatement(zt(e,Yo.types.memberExpression(_n,a,!0),r)));break}default:i?s`${_t().attr(t,c)}`:n?ct(t)?En(o,l):s`${zt("attr",Yo.types.stringLiteral(t),r)}`:ct(t)?fn("effect",o,l,Yo.types.expressionStatement(zt("on",Yo.types.memberExpression(_n,a,!0),Yo.types.stringLiteral(lt(t)),r))):fn("render",o,l,Yo.types.expressionStatement(zt("attr",Yo.types.memberExpression(_n,a,!0),Yo.types.stringLiteral(t),r)))}}p&&(n?(En(o,t.referencedBindings),l?s`${zt("partialAttrs",p,l,a,fe(o),Yo.types.stringLiteral("style"))}`:s`${zt("attrs",p,a,fe(o),Yo.types.stringLiteral("style"))}`):(fn("render",o,t.referencedBindings,l?Yo.types.expressionStatement(zt("partialAttrs",_n,a,p,l)):Yo.types.expressionStatement(zt("attrs",_n,a,p))),fn("effect",o,t.referencedBindings,Yo.types.expressionStatement(zt("attrsEvents",_n,a)),!1)))},exit(e){const t=e.node.extra[fo],r=kr(e),n=t&&As(t);if(r`>`,yr(e),Fe())for(const t of e.node.body.body)Yo.types.isMarkoText(t)?r`${t.value}`:Yo.types.isMarkoPlaceholder(t)&&r`${zt("escapeStyle",t.value)}`;else{const t=[],s=[];let o,a="";for(const r of e.node.body.body)Yo.types.isMarkoText(r)?a+=r.value:Yo.types.isMarkoPlaceholder(r)&&(o||=r,t.push(Yo.types.templateElement({raw:a})),s.push(r.value),a="");o?(t.push(Yo.types.templateElement({raw:a})),fn("render",ue(e),o.value.extra?.referencedBindings,Yo.types.expressionStatement(zt("textContent",Yo.types.memberExpression(_n,n,!0),Yo.types.templateLiteral(t,s))))):r`${a}`}r`</style>`,t&&jr(e,t),gr(e),e.remove()}},"@disabled":"#html-disabled","@media":"#html-media","@nonce":"#html-nonce","@type":"#html-type","attribute-groups":["html-attributes"],parseOptions:{text:!0,preserveWhitespace:!0}},ra=r("../../browser-shims/compiler/index.js"),na=r("../../browser-shims/compiler/babel-utils.js"),sa={analyze(e){(0,na.assertNoArgs)(e),(0,na.assertNoParams)(e),(0,na.assertNoAttributes)(e),b(e),(0,na.assertNoAttributeTags)(e);const{node:t}=e;if(!t.var)throw e.get("name").buildCodeFrameError("The `id` tag requires a tag variable.");if(!ra.types.isIdentifier(t.var))throw e.get("var").buildCodeFrameError("The `id` tag cannot be destructured");ns(e,4)},translate:{exit(e){const{node:t}=e,r=Fe()?zt("nextTagId"):zt("nextTagId",_n);if(Fe())e.replaceWith(ra.types.variableDeclaration("const",[ra.types.variableDeclarator(t.var,r)]));else{const n=on(t.var.extra.binding);gn(ue(e),void 0,n,r),e.remove()}}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{displayText:"id/<name>",description:"Use to create a unique identifier.",snippet:"id/${1:name}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#id"}],types:f.name+"/tag-types/id.d.marko"},oa=r("../../browser-shims/compiler/index.js"),aa=r("../../browser-shims/compiler/babel-utils.js"),ia=r("../../browser-shims/compiler/index.js"),ca=new WeakMap,la={analyze(e){if(function(e){switch((0,aa.assertNoVar)(e),(0,aa.assertNoArgs)(e),(0,aa.assertNoParams)(e),function(e){if(!e.node.body.body.length&&!e.node.attributeTags.length)throw e.get("name").buildCodeFrameError(`The \`${_(e)}\` tag requires body content.`)}(e),g(e),_(e)){case"if":fa(e);break;case"else-if":fa(e),ua(e);break;case"else":!function(e){const{node:t}=e,[r]=t.attributes;if(t.attributes.length>1||r&&"if"!==r.name){const r=t.attributes[1].loc?.start,n=t.attributes[t.attributes.length-1].loc?.end,s=`The \`${_(e)}\` tag only supports an \`if=\` attribute.`;throw null==r||null==n?e.get("name").buildCodeFrameError(s):e.hub.buildError({loc:{start:r,end:n}},s,Error)}}(e),ua(e)}}(e),e.node.body.attributeTags)return;const t=le(e.get("body")),[r,n]=ma(e,t);if(r){const[r]=n[0],s=r.node.extra??={},o=[];let a=!0;for(const[e,t]of n)t&&(t.isBranch=!0,t.upstreamExpression=s,null===t.content||t.content?.singleChild&&4!==t.content.startType||(a=!1)),e.node.attributes.length&&o.push(e.node.attributes[0].value);const i=pe(e);ds(i,r.node,o),t.sectionAccessor={binding:So(r,i,n.length),prefix:ze().ConditionalScope},s.singleNodeOptimization=a}},translate:or({html:{enter(e){if(e.node.body.attributeTags)return;const t=de(e.get("body"));ya(e)&&!Ao(e)&&(hr(e,37),br(e)),Tr(e),t&&ye(t,!0)},exit(e){if(e.node.body.attributeTags)return;const t=e.get("body"),r=ue(e),n=de(t),[s,o]=ma(e,n),[a]=o[0],i=a.node.extra.singleNodeOptimization,c=function(e){if(1===e.length)return je(e[0][1]);const t=[];for(const[,r]of e)t.push(r);return function(e){let t,r;for(const n of e){const e=n&&je(n);e&&(r?(r.referenced=Ie(r.referenced,e.referenced),r.closures=Ie(r.closures,e.closures),r.all=Ie(r.all,e.all)):t?r={referenced:Ie(t.referenced,e.referenced),closures:Ie(t.closures,e.closures),all:Ie(t.all,e.all)}:t=e)}return r||t}(t)}(o),l=function(e){for(const[,t]of e)if(t&&we(t))return!0}(o),p=l||c?.all;if(n&&(Mr(e),Tn(t)),s){const t=So(a,r),n=Ao(a),s=e.getNextSibling();let l;c?.referenced&&n&&(Qt(a).node.extra[mo]=!1);for(let e=o.length;e--;){const[t]=o[e],r=t.node.body.body;p&&r.push(oa.types.returnStatement(oa.types.numericLiteral(e)));const[n]=t.node.attributes,s=(d=r,Array.isArray(d)?1===d.length?d[0]:ia.types.blockStatement(d):d);l=n?oa.types.ifStatement(n.value,s,l):s,t.remove()}if(p){const e=c?.referenced,s=oa.types.arrowFunctionExpression([],oa.types.blockStatement([l]));l=oa.types.expressionStatement(i?zt("resumeSingleNodeConditional",s,fe(r),As(t),e?oa.types.numericLiteral(1):n?oa.types.numericLiteral(0):void 0,n&&oa.types.numericLiteral(1)):zt("resumeConditional",s,fe(r),As(t),e?oa.types.numericLiteral(1):void 0))}s.insertBefore(l)}var d}},dom:{enter(e){if(e.node.body.attributeTags)return;const t=de(e.get("body"));t&&ye(t,!0),ya(e)&&!Ao(e)&&(hr(e,37),br(e))},exit(e){if(e.node.body.attributeTags)return;const[t,r]=ma(e,de(e.get("body")));if(t){const[e]=r[0],t=ue(e),n=r[0][0].node.extra,s=So(e,t),o=[];let a=oa.types.numericLiteral(r.length);for(let e=r.length;e--;){const[t,n]=r[e],[i]=t.node.attributes,c=oa.types.numericLiteral(n?e:-1);n&&(o.push(oa.types.identifier(n.name)),Wr(t,((t,r)=>zt("conditionalClosure",As(t),As(s),oa.types.numericLiteral(e),r)))),t.remove(),a=i?oa.types.conditionalExpression(i.value,c,a):c}const i=sn(t,s,"if");i.build=()=>zt("conditional",As(s),...o.reverse()),gn(t,n.referencedBindings,i,a)}}}}),parseOptions:{controlFlow:!0},autocomplete:[{snippet:"if=${1:condition}",description:"Use to display content only if the condition is met.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#if-else-if-else"}]},pa={...la,autocomplete:[{snippet:"else-if=${1:condition}",description:"Use after an <if> or <else-if> tag to display content if those conditions do not match and this one does.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#if-else-if-else"}]},da={...la,autocomplete:[{description:"Use after an <if> or <else-if> tag to display content if those conditions do not match.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#if-else-if-else"}]};function ua(e){let t=e.getPrevSibling();for(;t.node&&t.isMarkoComment();)t=t.getPrevSibling();if(!H(t)||"else"!==_(t)&&!t.node.attributes.length)throw e.buildCodeFrameError(`The \`<${_(e)}>\` must have a preceding \`<if=cond>\`, \`<else-if=cond>\`, or \`<else if=cond>\`.`)}function fa(e){const{node:t}=e,[r]=t.attributes;if(!oa.types.isMarkoAttribute(r)||!r.default)throw e.get("name").buildCodeFrameError(`The \`${_(e)}\` tag requires a value.`);if(t.attributes.length>1){const r=t.attributes[1].loc?.start,n=t.attributes[t.attributes.length-1].loc?.end,s=`The \`${_(e)}\` tag only supports the \`value\` attribute.`;throw null==r||null==n?e.get("name").buildCodeFrameError(s):e.hub.buildError({loc:{start:r,end:n}},s,Error)}}function ma(e,t){const r=ca.get(e)??[];let n=e.getNextSibling();for(;n.isMarkoComment();)n=n.getNextSibling();const s=!(q(n,"else")||q(n,"else-if"));return r.push([e,t]),s||ca.set(n,r),[s,r]}function ya(e){return q(e,"if")}var ga=r("../../browser-shims/compiler/babel-utils.js"),ba={parse(e){const{node:t}=e;e.replaceWith((0,ga.parseStatements)(e.hub.file,t.rawValue,t.start,t.end)[0])},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:'import <scope> from "<path>"',description:"Use to import external modules, follows the same syntax as JavaScript imports.",snippet:'import ${2} from "${1:path}"',descriptionMoreURL:"https://markojs.com/docs/syntax/#importing-external-files"}]},ha=r("../../browser-shims/compiler/index.js"),va=r("../../browser-shims/compiler/babel-utils.js"),xa={analyze(e){const{node:t}=e,r=t.var;let n,s;for(const r of t.attributes)if(ha.types.isMarkoAttribute(r))if("value"===r.name)n=r;else{if("valueChange"!==r.name){const t=r.loc?.start,n=r.loc?.end,s="The `let` tag only supports the `value` attribute and its change handler.";throw null==t||null==n?e.get("name").buildCodeFrameError(s):e.hub.buildError({loc:{start:t,end:n}},s,Error)}s=r}if((0,va.assertNoArgs)(e),(0,va.assertNoParams)(e),b(e),g(e),!r)throw e.get("name").buildCodeFrameError("The `let` tag requires a tag variable.");if(!ha.types.isIdentifier(r))throw e.get("var").buildCodeFrameError("The `let` tag variable cannot be destructured.");if(s&&(0,va.computeNode)(s.value))throw e.get("attributes").find((e=>e.node===s)).get("value").buildCodeFrameError("The `let` tag `valueChange` attribute must be a function.");ds(pe(e),e.node,[n?.value,s?.value]),ns(e,1,void 0,e.node.extra)},translate:{exit(e){const{node:t}=e,r=t.var,n=t.attributes.find((e=>ha.types.isMarkoAttribute(e)&&(e.default||"value"===e.name)))??ha.types.markoAttribute("value",ha.types.identifier("undefined")),s=t.attributes.find((e=>ha.types.isMarkoAttribute(e)&&"valueChange"===e.name)),o=ue(e),a=r.extra.binding;if(De()){const t=on(a,"state");gn(o,e.node.extra.referencedBindings,t,n.value),s&&(t.extraArgs=[s.value]),t.buildAssignment=(e,r)=>{const n=Zn(e,t.section);return ha.types.callExpression(t.identifier,[n,r])}}else Ws(e,n.value,"let"),s&&Zr(o,ze().TagVariableChange+Ss(a),s.value,!0);e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Use to create a mutable binding.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#let"}],types:f.name+"/tag-types/let.d.marko"},wa=r("../../browser-shims/compiler/index.js"),Aa=r("../../browser-shims/compiler/babel-utils.js"),Sa=Symbol("lifecycle attrs reference"),ka={analyze(e){(0,Aa.assertNoArgs)(e),(0,Aa.assertNoVar)(e),(0,Aa.assertNoParams)(e),b(e);const{node:t}=e,r=t.extra??={},n=pe(e);if(r[Sa]=rs(D("lifecycle"),4,n,void 0,r),0===t.attributes.length)throw e.get("name").buildCodeFrameError("The `lifecycle` tag requires at least one attribute.");for(const r of t.attributes){if(wa.types.isMarkoSpreadAttribute(r))throw e.get("name").buildCodeFrameError("The `lifecycle` tag does not support `...spread` attributes.");(r.value.extra??={}).isEffect=!0}((0,Aa.getProgram)().node.extra??={}).isInteractive=!0,ds(n,e.node,ws(e.node))},translate:{exit(e){const{node:t}=e,r=ue(e),n=t.extra,{referencedBindings:s}=n,o=n[Sa];if(De()){const t=jo(e);t.statements.push(wa.types.expressionStatement(zt("lifecycle",_n,As(o),Bo(t.properties)))),fn("effect",r,s,t.statements)}else En(r,s);e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Use to create a side effects.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#effect"}],types:f.name+"/tag-types/lifecycle.d.marko"},Ea=r("../../browser-shims/compiler/index.js"),Ta=r("../../browser-shims/compiler/babel-utils.js"),Ma={analyze(e){const[t]=e.node.attributes;if((0,Ta.assertNoArgs)(e),(0,Ta.assertNoVar)(e),(0,Ta.assertNoParams)(e),b(e),!t)throw e.get("name").buildCodeFrameError("The `log` tag requires a value.");if(e.node.attributes.length>1||!Ea.types.isMarkoAttribute(t)||!t.default&&"value"!==t.name)throw e.get("name").buildCodeFrameError("The `log` tag only supports the `value` attribute.")},translate:{exit(e){const t=ue(e),[r]=e.node.attributes,{value:n}=r,s=n.extra?.referencedBindings,o=Ea.types.expressionStatement(Ea.types.callExpression(Ea.types.memberExpression(Ea.types.identifier("console"),Ea.types.identifier("log")),[n]));Fe()?e.insertBefore(o):fn("render",t,s,o),e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Use to log a value to the console.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#log"}],types:f.name+"/tag-types/log.d.marko"},Ca=r("../../browser-shims/compiler/index.js"),ja=r("../../browser-shims/compiler/babel-utils.js"),Pa=" For a native html `script` tag use the `html-script` core tag instead.",Ia={parse(e){const{node:t}=e,{body:r}=t.body;if(r.length){let n="";for(const t of r){if("MarkoText"!==t.type)throw e.hub.file.hub.buildError(t,"Unexpected content in `script` tag. Only javascript and typescript is supported."+Pa,SyntaxError);n+=t.value}const s=r[0]?.start,o=r[r.length-1]?.end,a=(0,ja.parseStatements)(e.hub.file,n,s,o),i=Ca.types.arrowFunctionExpression([],Ca.types.blockStatement(a),O(a,Ba));t.attributes.push(Ca.types.markoAttribute("value",i)),t.body.body=[]}},analyze(e){const{node:t}=e;if((0,ja.assertNoArgs)(e),(0,ja.assertNoParams)(e),b(e),(0,ja.assertNoAttributeTags)(e),t.var)throw e.hub.buildError(t.var,"The `script` tag does not support a tag variable reference."+Pa);let r=!1;for(const n of t.attributes){if("MarkoAttribute"!==n.type||"value"!==n.name)throw e.hub.buildError(n,"The `script` tag does not support html attributes."+Pa);if(r)throw e.hub.buildError(n,"Invalid duplicate value attribute.");r=!0,(n.value.extra??={}).isEffect=!0,((0,ja.getProgram)().node.extra??={}).isInteractive=!0}r||vs(ws(t))},translate:{exit(e){const{node:t}=e,[r]=t.attributes;if(!r)return void e.remove();const n=ue(e),{value:s}=r,o=s.extra?.referencedBindings;if(De()){const{value:e}=r,t=Ca.types.isFunctionExpression(e)||Ca.types.isArrowFunctionExpression(e);let s=null;if(t&&!e.async&&!e.generator)if(Ca.types.isBlockStatement(e.body)){let t=!1;for(const r of e.body.body)if(Ca.types.isDeclaration(r)){t=!0;break}s=t?e.body:e.body.body}else s=Ca.types.expressionStatement(e.body);fn("effect",n,o,s||Ca.types.expressionStatement(Ca.types.callExpression(e,t?[]:[_n])))}else En(n,o);e.remove()}},html:!1,parseOptions:{text:!0,preserveWhitespace:!0},attributes:{},autocomplete:[{description:"Use to create a side effects.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#script"}],types:f.name+"/tag-types/script.d.marko"};function Ba(e){switch(e.type){case"ForOfStatement":return e.await;case"FunctionDeclaration":case"FunctionExpression":case"ArrowFunctionExpression":case"ClassMethod":case"ObjectMethod":case"ClassPrivateMethod":return L;case"AwaitExpression":return!0;default:return!1}}var La=r("../../browser-shims/compiler/index.js"),Na=r("../../browser-shims/compiler/babel-utils.js"),Oa={parse(e){const{node:t,hub:{file:r}}=e,n=t.rawValue,s=n.replace(/^server\s*/,"").trim(),o=t.name.start+(n.length-s.length);let a=(0,Na.parseStatements)(r,s,o,o+s.length);1===a.length&&La.types.isBlockStatement(a[0])&&(a=a[0].body),e.replaceWith(La.types.markoScriptlet(a,!0,"server"))},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:"server <statement>",description:"A JavaScript statement which is only evaluated once your template is loaded on the server.",descriptionMoreURL:"https://markojs.com/docs/syntax/#server-javascript"}]},$a=r("../../browser-shims/compiler/index.js"),Fa=r("../../browser-shims/compiler/babel-utils.js"),Da={parse(e){const{node:t,hub:{file:r}}=e,n=t.rawValue,s=n.replace(/^static\s*/,"").trim(),o=t.name.start+(n.length-s.length);let a=(0,Fa.parseStatements)(r,s,o,o+s.length);1===a.length&&$a.types.isBlockStatement(a[0])&&(a=a[0].body),e.replaceWith($a.types.markoScriptlet(a,!0))},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:"static <statement>",description:"A JavaScript statement which is only evaluated once your template is loaded.",descriptionMoreURL:"https://markojs.com/docs/syntax/#static-javascript"}]},Ra=r("../../browser-shims/compiler/index.js"),Ua=r("../../browser-shims/compiler/babel-utils.js"),za=d(r("../../node_modules/magic-string/dist/magic-string.cjs.js")),_a=d(r("../../node_modules/path-browserify/index.js")),Va=/^style((?:\.[a-zA-Z0-9$_-]+)+)?/,Wa=" For a native html `style` tag use the `html-style` core tag instead.",qa={analyze(e){(0,Ua.assertNoArgs)(e),(0,Ua.assertNoParams)(e),(0,Ua.assertNoAttributeTags)(e);const{node:t}=e,r=Va.exec(t.rawValue||"")?.[1]?.slice(1);for(const n of t.attributes)if(null!=n.start||"MarkoAttribute"!==n.type||"class"!==n.name||"StringLiteral"!==n.value.type||n.value.value!==r)throw e.hub.buildError(n.value,"The `style` does not support html attributes."+Wa);for(const r of t.body.body)if("MarkoText"!==r.type)throw e.hub.buildError(r,"The `style` tag currently only supports static content."+Wa);if(t.body.body.length>1)throw e.hub.buildError(t.name,"The `style` tag currently only supports static content."+Wa)},translate(e){const{node:t,hub:{file:r}}=e,{filename:n,sourceMaps:s}=r.opts;let o=Va.exec(t.rawValue||"")?.[1]||".css";t.var&&!/\.module\./.test(o)&&(o=".module"+o);const a=t.body.body[0],{resolveVirtualDependency:i}=Re(),c=(0,Ua.getStart)(r,a),l=(0,Ua.getEnd)(r,a);let p,d=a.value;if(i&&s&&null!==c&&null!==l){const e=new za.default(r.code,{filename:n});e.remove(0,c),e.remove(l,r.code.length),p=e.generateMap({source:n,includeContent:!0}),"inline"!==s&&"both"!==s||(d+=`\n/*# sourceMappingURL=${p.toUrl()}*/`,"inline"===s&&(p=void 0))}const u=i?.(n,{virtualPath:`./${_a.default.basename(n)+o}`,code:d,map:p});u&&(t.var?Ra.types.isIdentifier(t.var)?(0,Ua.getProgram)().node.body.push(Ra.types.importDeclaration([Ra.types.importDefaultSpecifier(t.var)],Ra.types.stringLiteral(u))):(0,Ua.getProgram)().node.body.push(Ra.types.variableDeclaration("const",[Ra.types.variableDeclarator(t.var,(0,Ua.importDefault)(r,u,"style"))])):(0,Ua.getProgram)().node.body.push(Ra.types.importDeclaration([],Ra.types.stringLiteral(u)))),e.remove()},parseOptions:{html:!1,text:!0,rawOpenTag:!0,preserveWhitespace:!0},attributes:{}},Ha=r("../../browser-shims/compiler/index.js"),Ga=r("../../browser-shims/compiler/babel-utils.js"),Ja=Symbol("try tag dom binding"),Za={analyze(e){(0,Ga.assertNoVar)(e),(0,Ga.assertNoArgs)(e),(0,Ga.assertNoParams)(e),(0,Ga.assertNoAttributes)(e),g(e),eo(e);const{node:t}=e,r=pe(e),n=e.node.extra??={},s=e.get("body");if(n[Ja]=rs("#text",0,r,void 0,n),!t.body.body.length)throw e.get("name").buildCodeFrameError("The `try` tag requires body content.");le(s),ds(r,e.node,ws(e.node))},translate:or({html:{enter(e){if(!de(e.get("body")))return void e.remove();const t=de(e.get("body"));ye(t,!0),Tr(e)},exit(e){const{node:t}=e,r=ue(e),n=t.extra,s=e.get("body"),o=jo(e),a=n[Ja],i=Po(o.properties);i&&o.properties.splice(o.properties.indexOf(i),1),Mr(e),Tn(s),e.insertBefore(o.statements),e.replaceWith(Ha.types.expressionStatement(zt("tryContent",fe(r),As(a),i?.value,Bo(o.properties))))[0].skip()}},dom:{enter(e){const t=de(e.get("body"));ye(t,!0),hr(e,37),br(e)},exit(e){const{node:t}=e,r=t.extra,n=r[Ja],s=r.referencedBindings,o=jo(e),a=Po(o.properties);a&&o.properties.splice(o.properties.indexOf(a),1);const i=ue(e),c=de(e.get("body")),l=sn(i,n,"try");l.build=()=>zt("createTry",As(n),Ha.types.identifier(c.name)),o.statements.length&&fn("render",i,s,o.statements),(0,Ga.getProgram)().node.body.push(Ha.types.expressionStatement(zt("enableCatch"))),gn(i,s,l,Bo(o.properties)),l.hasDownstreamIntersections=()=>!0,e.remove()}}}),attributes:{},autocomplete:[{description:"Used to capture errors and display placeholders for nested content.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#try"}],types:f.name+"/tag-types/try.d.marko"},Ka={taglibId:f.taglibId,"<attrs>":x,"<await>":Fs,"<client>":Us,"<const>":qs,"<debug>":Js,"<define>":Fo,"<effect>":Uo,"<else-if>":pa,"<else>":da,"<export>":_o,"<for>":ko,"<html-comment>":Go,"<html-script>":Xo,"<html-style>":ta,"<id>":sa,"<if>":la,"<import>":ba,"<let>":xa,"<lifecycle>":ka,"<log>":Ma,"<return>":Lr,"<script>":Ia,"<server>":Oa,"<static>":Da,"<style>":qa,"<try>":Za},Xa={translate:{enter(e){throw e.buildCodeFrameError("CDATA sections are not supported in Marko.")}}},Ya={translate:{exit(e){e.remove()}}},Qa={translate:{enter(e){throw e.buildCodeFrameError("XML declarations sections are not supported in Marko.")}}},ei={translate:{exit(e){Fe()&&kr(e)`<!${e.node.value}>`,e.remove()}}},ti=r("../../browser-shims/compiler/index.js"),ri=r("../../browser-shims/compiler/babel-utils.js"),ni={analyze(e){if(e!==We(e))return;const t=_e(e);if(t&&(t.isMarkoPlaceholder()||t.isMarkoScriptlet()&&"server"===t.node.target))return;if(si(t)&&((0,ri.isNativeTag)(t.parentPath)&&/^on[A-Z-]/.test(t.node.name)||q(t.parentPath,"script")||q(t.parentPath,"lifecycle")||q(t.parentPath,"for")))return;const{node:r}=e,n=ue(e),s=r.extra??={},{markoOpts:o,opts:{filename:a}}=(0,ri.getFile)(),i=s.name=D(e.node.id?.name||(si(t)?t.node.default?ti.types.toIdentifier(t.parentPath.has("var")?t.parentPath.get("var"):t.parentPath.get("name")):t.node.name:ti.types.isVariableDeclarator(e.parent)&&ti.types.isIdentifier(e.parent.id)?e.parent.id.name:ti.types.isObjectMethod(r)&&ti.types.isIdentifier(r.key)?r.key.name:"anonymous"));s.section=n,s.registerId=(0,ri.getTemplateId)(o,a,`${n.id}/${i.slice(1)}`)}};function si(e){return!!e&&e.isMarkoAttribute()}var oi=r("../../browser-shims/compiler/babel-utils.js"),ai={analyze(e){const{node:t}=e,{source:r}=t,{value:n}=r,s=(0,oi.resolveTagImport)(e,n);if(s){t.extra??={},t.extra.tagImport=s;const r=e.hub.file.metadata.marko.tags;r.includes(s)||r.push(s)}},translate:{exit(e){const{node:t}=e,{extra:r}=t,n=r?.tagImport;n&&(t.source.value=n)}}},ii=r("../../browser-shims/compiler/index.js");function ci(e){const t=e.parentPath.isMarkoTagBody()&&e.parentPath.parentPath;if(t&&W(t))switch(t.node.name.value){case"html-comment":case"html-script":case"html-style":return!0}return!1}r("../../browser-shims/compiler/index.js");var li=Symbol("placeholder node binding"),pi=Symbol("placeholder has sibling text"),di={analyze(e){if(ci(e))return;const{node:t}=e,{confident:r,computed:n}=T(t.value);r&&(t.escape||ui(n))||((t.extra??={})[li]=rs("#text",0,pe(e),void 0,t.value.extra),function(e){const t=e.node.extra;let r=e.getPrevSibling();for(;r.node;){const e=ve(r,"endType");if(null!==e){if(4===e||1===e||2===e)return t[pi]=1;break}r=r.getPrevSibling()}if(!r.node&&ii.types.isProgram(e.parentPath))return t[pi]=1;let n=e.getNextSibling();for(;n.node;){const e=ve(n,"startType");if(null!==e){if(4===e||1===e||2===e)return t[pi]=2;break}n=n.getNextSibling()}if(!n.node&&ii.types.isProgram(e.parentPath))return t[pi]=2;t[pi]=0}(e))},translate:{exit(e){if(ci(e))return;const{node:t}=e,{value:r}=t,n=T(r),{confident:s,computed:o}=n;if(s&&ui(o))return void e.remove();const a=Fe(),i=kr(e),c=t.extra||{},l=c[li],p=a||s&&t.escape,d=p?t.escape?"escapeXML":"toString":t.escape?"data":"html",u=Me(n),f=c[pi];s&&p?i`${_t()[d](o)}`:(1===f?(a&&u&&i`<!>`,hr(e,37)):2===f?hr(e,37):(a||i` `,hr(e,32)),a?(i`${zt(d,r)}`,u&&jr(e,l)):fn("render",ue(e),n.referencedBindings,ii.types.expressionStatement("data"===d?zt("data",ii.types.memberExpression(_n,As(l),!0),r):zt("html",_n,r,As(l))))),br(e),e.remove()}}};function ui(e){return null==e||!1===e}var fi=r("../../browser-shims/compiler/index.js"),mi=new WeakMap,yi={migrate(e){const{name:t}=e.node;if(!e.scope.hasBinding(t)&&"out"===t){if(!fi.types.isMemberExpression(e.parent)||!fi.types.isIdentifier(e.parent.property)||"global"!==e.parent.property.name)throw e.buildCodeFrameError("Only `out.global` is supported for compatibility.");e.parentPath.replaceWith(fi.types.identifier("$global"))}},analyze(e){const{name:t}=e.node;e.scope.hasBinding(t)||("$global"===t?is(e):"$signal"===t&&(pe(e).hasAbortSignal=!0,is(e)))},translate(e){const{name:t}=e.node;if(!e.scope.hasBinding(t))switch(t){case"$global":Fe()?e.replaceWith(fi.types.callExpression(Ut("$global"),[])):e.replaceWith(fi.types.memberExpression(_n,fi.types.identifier("$global")));break;case"$signal":if(Fe())e.replaceWith(fi.types.callExpression(fi.types.arrowFunctionExpression([],fi.types.blockStatement([fi.types.throwStatement(fi.types.newExpression(fi.types.identifier("Error"),[fi.types.stringLiteral("Cannot use $signal in a server render.")]))])),[]));else{const t=ue(e),r=Ve(e);let n,s=mi.get(t);s?n=s.get(r):(s=new Map,mi.set(t,s)),n||(n=s.size,s.set(r,n),fn("render",t,r.node.extra?.referencedBindings,fi.types.expressionStatement(fi.types.callExpression(Ut("resetAbortSignal"),[_n,fi.types.numericLiteral(n)])),!1)),e.replaceWith(fi.types.callExpression(Ut("getAbortSignal"),[_n,fi.types.numericLiteral(n)]))}}}},gi={analyze(e){if(!e.node.static)throw e.buildCodeFrameError("Scriptlets are not supported when using the tags api.");ds(pe(e),e.node,e.node.body)},translate:{exit(e){const{node:t}=e,r=Fe();t.target&&t.target!==(r?"server":"client")?e.remove():r||(N(t,"body",Nn),e.replaceWithMultiple(t.body))}}},bi=r("../../browser-shims/compiler/index.js"),hi=r("../../browser-shims/compiler/babel-utils.js"),vi=(r("../../browser-shims/compiler/index.js"),r("../../browser-shims/compiler/babel-utils.js")),xi={analyze:{enter(e){(0,vi.assertNoVar)(e),(0,vi.assertNoArgs)(e);const t=e.get("body");if(le(t),ss(t,3),!(0,vi.findParentTag)(e))throw e.get("name").buildCodeFrameError("@tags must be nested within another tag.")}},translate:{enter(e){Fe()&&Tr(e)},exit(e){Fe()&&(Mr(e),Tn(e.get("body")))}}},wi=r("../../browser-shims/compiler/index.js"),Ai=r("../../browser-shims/compiler/babel-utils.js"),Si=d(r("../../node_modules/path-browserify/index.js")),ki=Symbol("custom tag child scope"),Ei=Symbol("custom tag scope offset"),Ti=Symbol("custom tag child attribute expressions"),Mi={analyze:{enter(e){if((0,Ai.assertAttributesOrSingleArg)(e),eo(e),!(0,Ai.getTagTemplate)(e)){const t=_(e);if(t&&e.scope.hasBinding(t))throw e.get("name").buildCodeFrameError(`Local variables must be in a dynamic tag unless they are PascalCase. Use \`<\${${t}}/>\` or rename to \`${t.charAt(0).toUpperCase()+t.slice(1)}\`.`);throw e.get("name").buildCodeFrameError("Unable to find entry point for custom tag.")}const t=pe(e),r=e.get("body"),n=e.node.extra??={};n[ki]=rs("#childScope",0,t,void 0,n),n[Ti]=new Set([n]),e.has("var")&&(ns(e,4),e.node.var.extra.binding.scopeOffset=n[Ei]=rs("#scopeOffset",0,t,void 0,n)),le(r),ss(r,3);const s=(0,Ai.loadFileForTag)(e);if(s.opts.filename===e.hub.file.opts.filename)ds(t,e.node,ws(e.node));else{const r=s.ast.program.extra;ji(n,t,e,r?.domExports.input),(0,Ai.getProgram)().node.extra.hasInteractiveChild=r?.isInteractive||r?.hasInteractiveChild||!1}}},translate:{enter(e){hr(e),Fe()&&Tr(e)},exit(e){Fe()?function(e){const t=e.get("body"),{node:r}=e,n=r.extra;let s;if(Mr(e),Tn(t),wi.types.isStringLiteral(r.name)){const t=Ci(e);s=Bi(e.hub.file,t)?wi.types.identifier(function(){let e=Rn.get((0,Dn.getProgram)());return e||Rn.set((0,Dn.getProgram)(),e=D("content")),e}()):(0,Ai.importDefault)(e.hub.file,t,_(e))}else s=r.name;const o=r.var,a=ue(e),i=(0,Ai.loadFileForTag)(e)?.ast.program.extra?.domExports?.input,{properties:c,statements:l}=i?jo(e,i.props):{properties:[],statements:[]},p=!!o||Ce(n[Ti]);if(p){const t=n[ki],s=R(t?.name);e.insertBefore(wi.types.variableDeclaration("const",[wi.types.variableDeclarator(s,zt("peekNextScope"))])),Zr(a,Ss(t),zt("writeExistingScope",s),p),o&&l.push(wi.types.expressionStatement(zt("setTagVar",fe(a),As(e.node.extra[Ei]),s,wi.types.stringLiteral(bn(a,r.var.extra?.binding,"var")))))}if(r.extra.tagNameNullable){const t=Po(c);let r;if(t){const n=t.value;t.value=r=R("content");const[s]=e.insertBefore(wi.types.variableDeclaration("const",[wi.types.variableDeclarator(r,n)]));s.skip()}let n=Ni(s,Bo(c));o&&(Ws(e,wi.types.unaryExpression("void",wi.types.numericLiteral(0)),"let"),n=wi.types.assignmentExpression("=",o,n)),l.push(wi.types.ifStatement(s,wi.types.expressionStatement(n),r&&Li(r)))}else o?(Ws(e,Ni(s,Bo(c))),Gr(a,!0)):l.push(Li(s,Bo(c)));for(const t of e.replaceWithMultiple(l))t.skip()}(e):function(e){const t=ue(e),{node:r}=e,n=r.extra[ki],s=kr(e),{file:o}=e.hub,a=wi.types.isIdentifier(r.name)?r.name.name:wi.types.isStringLiteral(r.name)?r.name.value:"tag",i=Ci(e),c=(0,Ai.loadFileForTag)(e),l=c.ast.program.extra.domExports,p=Ii(o,i,l.setup,a),d=l.input;if(d&&Pi(e,d,`${_(e)||"tag"}_input`,{circular:c.opts.filename===o.opts.filename,tagSection:t,relativePath:i,childScopeBinding:n,attrTagCallsByTag:void 0}),s`${(0,Ai.importNamed)(o,i,l.template,`${a}_template`)}`,function(e,t){const r=dr(ue(e));ur(ue(e)).push(`${mr[e.node.var?48:47]}`,t.name,mr[38]),lr(r,String.fromCharCode(e.node.var?48:47)),r.push(t,String.fromCharCode(38))}(e,(0,Ai.importNamed)(o,i,l.walks,`${a}_walks`)),r.var){const e=on(r.var.extra.binding);e.register=!0,e.buildAssignment=(e,t)=>wi.types.callExpression(Ut("tagVarSignalChange"),[Kn(e,n),t]),fn("render",t,void 0,wi.types.expressionStatement(zt("setTagVar",_n,As(n),e.identifier)))}fn("render",t,void 0,wi.types.expressionStatement(wi.types.callExpression(p,[Kn(t,n)]))),e.remove()}(e)}}};function Ci(e){const{node:t,hub:{file:r}}=e;let n;if(wi.types.isStringLiteral(t.name)){const t=(0,Ai.getTagTemplate)(e);n=t&&(0,Ai.resolveRelativePath)(r,t)}else t.extra?.tagNameImported&&(n=t.extra.tagNameImported);if(!n){const t=_(e);if(t&&e.scope.hasBinding(t))throw e.get("name").buildCodeFrameError(`Local variables must be in a dynamic tag unless they are PascalCase. Use \`<\${${t}}/>\` or rename to \`${t.charAt(0).toUpperCase()+t.slice(1)}\`.`);throw e.get("name").buildCodeFrameError("Unable to find entry point for custom tag.")}return n}function ji(e,t,r,n){if(!n)return void vs(ws(r.node));if(!n.props||r.node.arguments?.length)return void ds(t,r.node,ws(r.node));const s=de(r.get("body"));s&&(s.downstreamBinding=(n.props.content||n.props).binding);const o=eo(r),a=new Set;if(o){const s=new Map,i=(e,t)=>{const r=ws(t.node),n=s.get(e);n?n.referenceNodes=n.referenceNodes.concat(r):s.set(e,{firstTag:t,referenceNodes:r})};for(const e in o)a.add(o[e].name);const c=r.node.body.attributeTags?r.get("body").get("body"):r.get("attributeTags");for(const r of c)if(r.isMarkoTag())if((0,Ai.isAttributeTag)(r)){const s=o[_(r)],a=n.props[s.name];a?a.props&&!s.dynamic?ji(e,t,r,a):i(s.group,r):vs(ws(r.node))}else{const e=r.node.extra.attributeTagGroup;let t=!1;for(const r of e)if(n.props[o[r].name]){t=!0;break}t?i(e,r):vs(ws(r.node))}for(const{firstTag:{node:r},referenceNodes:n}of s.values())ds(t,r,n),e[Ti].add(r.extra)}const{attributes:i}=r.node;let c;for(let t=i.length;t--;){const r=i[t];if(wi.types.isMarkoAttribute(r)){if(a.has(r.name)||!n.props[r.name]){vs(r.value);continue}a.add(r.name)}c?c.push(r.value):wi.types.isMarkoSpreadAttribute(r)?c=[r.value]:e[Ti].add(r.value.extra??={})}c&&ds(t,r.node,c)}function Pi(e,t,r,n){if(e.node.arguments?.length){const[s]=e.node.arguments,o=Ii(e.hub.file,n.relativePath,t.id,r);return void gn(n.tagSection,e.node.extra?.referencedBindings,Oi(o),wi.types.isSpreadElement(s)?wi.types.memberExpression(s.argument,wi.types.numericLiteral(0),!0):s,Kn(n.tagSection,n.childScopeBinding))}if(!t.props||n.circular){const s=e.node.extra?.referencedBindings,o=Ii(e.hub.file,n.relativePath,t.id,r),a=jo(e);a.statements.length&&fn("render",n.tagSection,s,a.statements);let i=Bo(a.properties);if((0,Ai.isAttributeTag)(e)){const t=_(e),r=e.parentPath,s=eo(r)?.[t]?.repeated;if(s){let e=(n.attrTagCallsByTag||=new Map).get(r);e||n.attrTagCallsByTag.set(r,e=new Map);const s=e.get(t);if(s)return void(s.expression=zt("attrTags",s.expression,i));e.set(t,i=wi.types.parenthesizedExpression(zt("attrTag",i)))}else i=zt("attrTag",i)}return void gn(n.tagSection,s,Oi(o),i,Kn(n.tagSection,n.childScopeBinding))}const s=new Set,o=eo(e);if(o){const a=e.get("attributeTags"),i=new Map,c=(e,r)=>{const n=a[r];let s=i.get(e)?.statements;return s||(s=[],i.set(e,{referencedBindings:n.node.extra?.referencedBindings,statements:s})),Io(a,r,o,s,t.props)};for(const e in o)s.add(o[e].name);for(let e=0;e<a.length;e++){const s=a[e];if(s.isMarkoTag())if((0,Ai.isAttributeTag)(s)){const a=o[_(s)],i=t.props[a.name];i&&(a.dynamic?e=c(a.group,e):Pi(s,i,`${r}_${a.name}`,n))}else s.node.extra?.attributeTagGroup&&(e=c(s.node.extra.attributeTagGroup,e))}for(const[s,{referencedBindings:a,statements:c}]of i){const i=[];for(const c of s){const s=o[c],l=t.props[s.name];if(!l)continue;const p=Ii(e.hub.file,n.relativePath,l.id,`${r}_${s.name}`);i.push(wi.types.variableDeclarator(Qs(s))),gn(n.tagSection,a,Oi(p),Qs(s),Kn(n.tagSection,n.childScopeBinding))}fn("render",n.tagSection,a,[wi.types.variableDeclaration("let",i),...c])}}const a=e.node.body.extra?.section;if(a&&!s.has("content")&&(s.add("content"),t.props.content)){const s=(0,Ai.importNamed)(e.hub.file,n.relativePath,t.props.content.id,`${r}_content`);gn(n.tagSection,void 0,Oi(s),wi.types.callExpression(wi.types.identifier(a.name),[_n]),Kn(n.tagSection,n.childScopeBinding))}const{attributes:i}=e.node,c=[];let l;for(let e=i.length;e--;){const r=i[e];if(wi.types.isMarkoAttribute(r)){if(!t.props[r.name]||s.has(r.name))continue;if(s.add(r.name),l){l.push(Ft(r.name,r.value));continue}c.push(r)}else l?l.push(wi.types.spreadElement(r.value)):l=[wi.types.spreadElement(r.value)]}for(const s of c.reverse()){const o=t.props[s.name],a=Ii(e.hub.file,n.relativePath,o.id,`${r}_${s.name}`);gn(n.tagSection,s.value.extra?.referencedBindings,Oi(a),s.value,Kn(n.tagSection,n.childScopeBinding))}const p=new Set(Object.keys(t.props));for(const e of s)p.delete(e);if(p.size){const s=e.node.extra?.referencedBindings;let o=$i;if(l){const e=R(`${r}_spread`);l.reverse(),o=t=>Dt(e,t),fn("render",n.tagSection,s,[wi.types.variableDeclaration("const",[wi.types.variableDeclarator(e,Bo(l))])])}for(const a of p){const i=t.props[a],c=Ii(e.hub.file,n.relativePath,i.id,`${r}_${a}`);gn(n.tagSection,s,Oi(c),o(a),Kn(n.tagSection,n.childScopeBinding))}}}function Ii(e,t,r,n){return Bi(e,t)?wi.types.identifier(r):(0,Ai.importNamed)(e,t,r,n)}function Bi(e,t){const{filename:r}=e.opts;return t===r||"."===t[0]&&Si.default.resolve(r,"..",t)===r}function Li(e,...t){return wi.types.expressionStatement(Ni(e,...t))}function Ni(e,...t){return wi.types.callExpression(e,t.filter(Boolean))}function Oi(e){return{identifier:e,hasDownstreamIntersections:Fi}}function $i(){return wi.types.unaryExpression("void",wi.types.numericLiteral(0))}function Fi(){return!0}var Di=r("../../browser-shims/compiler/index.js"),Ri=r("../../browser-shims/compiler/babel-utils.js"),Ui=Symbol("dynamic tag dom binding"),zi=Symbol("custom tag scope offset"),_i={analyze:{enter(e){(0,Ri.assertAttributesOrArgs)(e),eo(e);const t=pe(e),r=e.node.extra??={},n=e.get("body");r[Ui]=rs("#text",0,t,void 0,r),e.has("var")&&(ns(e,4),e.node.var.extra.binding.scopeOffset=r[zi]=rs("#scopeOffset",0,t,void 0,r)),le(n),ss(n,3),ds(t,e.node,[e.node.name,...ws(e.node)])}},translate:{enter(e){hr(e,e.node.var?49:37),br(e),Fe()&&Tr(e)},exit(e){const{node:t}=e,r=t.extra,n=r[Ui],s=ue(e),o="class"===r.featureType;let a=t.name;Di.types.isStringLiteral(a)&&(a=(0,Ri.importDefault)(e.hub.file,Ci(e),a.value)),o&&(Fe()?(0,Ri.getProgram)().node.body.push(Di.types.markoScriptlet([Di.types.expressionStatement(Di.types.callExpression((0,Ri.importNamed)(e.hub.file,Vt(),"s"),[Di.types.identifier(a.name),Di.types.stringLiteral((0,Ri.loadFileForTag)(e).metadata.marko.id)]))],!0)):(0,Ri.getProgram)().node.body.push(Di.types.expressionStatement(zt("register",Di.types.stringLiteral((0,Ri.loadFileForTag)(e).metadata.marko.id),Di.types.identifier(a.name)))));const{properties:i,statements:c}=jo(e,void 0,void 0,o?"renderBody":"content"),l=[];let p=!1;if(t.arguments)p=!0,l.push(...t.arguments),i.length&&l.push(Bo(i));else{const e=Po(i);e?(i.splice(i.indexOf(e),1),l.push(Bo(i),e.value)):l.push(Bo(i))}if(Fe()){Mr(e),Tn(e.get("body"));const i=o||!!t.var||Me(r),d=p?zt("dynamicTag",fe(s),As(n),a,Di.types.arrayExpression(l),Di.types.numericLiteral(0),Di.types.numericLiteral(1),i?Di.types.numericLiteral(1):void 0):zt("dynamicTag",fe(s),As(n),a,l[0],l[1]||(i?Di.types.numericLiteral(0):void 0),i?Di.types.numericLiteral(0):void 0,i?Di.types.numericLiteral(1):void 0);if(t.var){const r=R("dynamicScope");c.push(Di.types.variableDeclaration("const",[Di.types.variableDeclarator(r,zt("peekNextScope"))])),c.push(Di.types.variableDeclaration("const",[Di.types.variableDeclarator(t.var,d)]),Di.types.expressionStatement(zt("setTagVar",fe(s),As(e.node.extra[zi]),r,Di.types.stringLiteral(bn(s,t.var.extra?.binding,"var")))))}else c.push(Di.types.expressionStatement(d));for(const t of e.replaceWithMultiple(c))t.skip()}else{const t=ue(e),s=de(e.get("body")),o=sn(t,n,"dynamicTag");let i;if(e.node.var&&(i=on(e.node.var.extra.binding),i.register=!0,i.buildAssignment=(e,t)=>Di.types.callExpression(Ut("tagVarSignalChange"),[Di.types.memberExpression(Zn(i.section,e),Di.types.stringLiteral(ze().ConditionalScope+Ss(n)),!0),t])),o.build=()=>zt("dynamicTag",As(n),s&&Di.types.identifier(s.name),i?Di.types.arrowFunctionExpression([],i.identifier):void 0,p&&Di.types.numericLiteral(1)),l.length){const e=p?Di.types.arrayExpression(l):l[0];Di.types.isObjectExpression(e)&&!e.properties.length||(o.extraArgs=[Di.types.arrowFunctionExpression([],c.length?Di.types.blockStatement(c.concat(Di.types.returnStatement(e))):e)])}o.hasDownstreamIntersections=()=>!0,gn(t,r.referencedBindings,o,a),e.remove()}}}},Vi=/^[A-Z][a-zA-Z0-9_$]*$/,Wi=new WeakMap,qi={transform:{enter(e){const{node:t}=e,{name:r,attributes:n}=e.node;let s=!1;if(bi.types.isStringLiteral(r)){const n=r.value;e.scope.getBinding(n)&&Vi.test(n)&&(t.name=Xn(bi.types.identifier(n),r),s=!0)}for(let t=0;t<n.length;t++){const r=n[t];bi.types.isMarkoAttribute(r)&&r.bound&&(r.bound=!1,n.splice(++t,0,Hi(e,r)),s=!0)}s&&e.scope.crawl()}},analyze:{enter(e){const t=(0,hi.getTagDef)(e),r=ie(e),n=t?.analyzer?.hook;if(n)tr(n,e);else if(0!==r)switch(r){case 1:Mi.analyze.enter(e);break;case 3:xi.analyze.enter(e);break;case 2:_i.analyze.enter(e)}else ho.analyze.enter(e)},exit(e){const t=(0,hi.getTagDef)(e)?.analyzer?.hook;t&&rr(t,e)}},translate:{enter(e){const t=(0,hi.getTagDef)(e),r=e.node.extra;if(t?.translator)return t.translator.path&&e.hub.file.metadata.marko.watchFiles.push(t.translator.path),void tr(t.translator.hook,e);for(const t of e.get("attributes"))if(t.isMarkoAttribute()){if(t.node.arguments)throw t.buildCodeFrameError(`Unsupported arguments on the \`${t.node.name}\` attribute.`);if(t.node.modifier){if(!(0,hi.isNativeTag)(t.parentPath))throw t.buildCodeFrameError(`Unsupported modifier \`${t.node.modifier}\`.`);t.node.name+=`:${t.node.modifier}`}}if(r.tagNameDynamic&&r.tagNameNullable&&!e.get("name").isIdentifier()&&Fe()){const t=R("tagName"),[r]=e.insertBefore(bi.types.variableDeclaration("const",[bi.types.variableDeclarator(t,e.node.name)]));r.skip(),e.set("name",t)}switch(r.tagNameType){case 0:ho.translate.enter(e);break;case 1:Mi.translate.enter(e);break;case 2:_i.translate.enter(e);break;case 3:xi.translate.enter(e)}},exit(e){const t=(0,hi.getTagDef)(e)?.translator;if(t)rr(t.hook,e);else switch(e.node.extra.tagNameType){case 0:ho.translate.exit(e);break;case 1:Mi.translate.exit(e);break;case 2:_i.translate.exit(e);break;case 3:xi.translate.exit(e)}}}};function Hi(e,t){const r=t.name+"Change";if(bi.types.isIdentifier(t.value)){const n=e.scope.getBinding(t.value.name);if(!n)return bi.types.markoAttribute(r,Gi(t.value));const s=Wi.get(n.identifier);if(!s){const e=bi.types.markoAttribute(r,Gi(t.value));return Wi.set(n.identifier,e),e}if("Identifier"===s.type)return bi.types.markoAttribute(r,Xn(bi.types.identifier(s.name),t.value));const o=qe(n.path)?n.path:_e(n.path);if(!o?.isMarkoTag()&&!o?.isMarkoTagBody())throw e.hub.buildError(t.value,"Unable to bind to value.");const a=D(r),i=bi.types.markoTag(bi.types.stringLiteral("const"),[bi.types.markoAttribute("value",s.value,null,null,!0)],bi.types.markoTagBody([]),null,bi.types.identifier(a));return Wi.set(n.identifier,s.value=bi.types.identifier(a)),o.isMarkoTag()?o.insertAfter(i):o.unshiftContainer("body",i),bi.types.markoAttribute(r,Xn(bi.types.identifier(a),t.value))}if(bi.types.isMemberExpression(t.value)){const e=t.value.property;if(!bi.types.isPrivateName(t.value.property))return bi.types.markoAttribute(r,bi.types.memberExpression(bi.types.cloneNode(t.value.object),"Identifier"===e.type?Xn(bi.types.identifier(e.name+"Change"),e):bi.types.binaryExpression("+",bi.types.cloneNode(e),bi.types.stringLiteral("Change")),"Identifier"!==e.type))}throw e.hub.buildError(t.value,"Attributes may only be bound to identifiers or member expressions")}function Gi(e){const t="_new_"+e.name;return bi.types.arrowFunctionExpression([Xn(bi.types.identifier(t),e)],bi.types.blockStatement([bi.types.expressionStatement(bi.types.assignmentExpression("=",Xn(bi.types.identifier(e.name),e),Xn(bi.types.identifier(t),e)))]))}r("../../browser-shims/compiler/index.js");var Ji=function(e){const t={migrate:{},transform:{},analyze:{},translate:{}};for(const r in e){const n=r,s=e[n];s.migrate&&(t.migrate[n]=s.migrate),s.transform&&(t.transform[n]=s.transform),s.analyze&&(t.analyze[n]=s.analyze),s.translate&&(t.translate[n]=s.translate)}return t}({Program:Hn,Function:ni,ReferencedIdentifier:yi,ImportDeclaration:ai,MarkoDocumentType:ei,MarkoDeclaration:Qa,MarkoCDATA:Xa,MarkoText:{translate:{exit(e){ci(e)||(kr(e)`${e.node.value}`,br(e),e.remove())}}},MarkoTag:qi,MarkoPlaceholder:di,MarkoScriptlet:gi,MarkoComment:Ya}),Zi=["tags"],Ki="tags",{transform:Xi,analyze:Yi,translate:Qi}=Ji,ec=[["../../node_modules/@marko/runtime-tags/dist/translator",{...Ka,migrate:Ji.migrate}]];function tc(e,t){return[`${f.name}${t?"":"/debug"}/${"html"===e?"html":"dom"}`]}},"../../node_modules/@marko/runtime-tags/package.json":e=>{e.exports=JSON.parse('{"name":"@marko/runtime-tags","version":"0.3.83","description":"Optimized runtime for Marko templates.","keywords":["api","marko","runtime","tags"],"homepage":"https://github.com/marko-js/marko","bugs":"https://github.com/marko-js/marko/issues","repository":{"type":"git","url":"git+https://github.com/marko-js/marko.git","directory":"packages/runtime-tags"},"license":"MIT","exports":{".":{"types":"./index.d.ts"},"./package.json":"./package.json","./translator":"./dist/translator/index.js","./tag-types/*":"./tag-types/*","./debug/*":{"types":"./dist/*.d.ts","import":"./dist/debug/*.mjs","default":"./dist/debug/*.js"},"./*":{"types":"./dist/*.d.ts","import":"./dist/*.mjs","default":"./dist/*.js"}},"types":"index.d.ts","files":["dist","tag-types","index.d.ts","tags-html.d.ts","!**/meta.*.json","!**/__tests__","!**/*.tsbuildinfo"],"scripts":{"build":"node -r ~ts ./scripts/bundle.ts"},"dependencies":{"@marko/compiler":"^5.39.17","csstype":"^3.1.3","magic-string":"^0.30.17"},"engines":{"node":"18 || 20 || >=22"},"exports:override":{".":{"types":"./index.d.ts"},"./translator":"./src/translator/index.ts","./tag-types/*":"./tag-types/*","./debug/*":"./src/*.ts","./*":"./src/*.ts"}}')}}]);
//# sourceMappingURL=420.ccd65e3a.js.map