"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[420],{"../../node_modules/@marko/runtime-tags/dist/translator/index.js":(e,t,r)=>{var s,n=Object.create,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,c=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,p=(e,t,r,s)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of i(t))l.call(e,n)||n===r||o(e,n,{get:()=>t[n],enumerable:!(s=a(t,n))||s.enumerable});return e},d=(e,t,r)=>(r=null!=e?n(c(e)):{},p(!t&&e&&e.__esModule?r:o(r,"default",{value:e,enumerable:!0}),e)),u={};((e,t)=>{for(var r in t)o(e,r,{get:t[r],enumerable:!0})})(u,{analyze:()=>Ti,getRuntimeEntryFiles:()=>ji,internalEntryBuilder:()=>P,preferAPI:()=>Ei,tagDiscoveryDirs:()=>ki,taglibs:()=>Ii,transform:()=>Si,translate:()=>Mi}),e.exports=(s=u,p(o({},"__esModule",{value:!0}),s));var f={name:r("../../node_modules/@marko/runtime-tags/package.json").name,taglibId:"marko-core"},m=r("../../browser-shims/compiler/index.js"),y=r("../../browser-shims/compiler/babel-utils.js");function g(e){for(const t of e.get("attributes"))if(t.isMarkoSpreadAttribute())throw t.buildCodeFrameError(`The \`${e.get("name").node.value}\` tag does not support \`...spread\` attributes.`)}function b(e){if(e.node.body.body.length)throw e.get("name").buildCodeFrameError(`The \`${e.get("name").node.value}\` tag does not support body content.`)}var h={migrate:[e=>{(0,y.assertNoArgs)(e),(0,y.assertNoParams)(e),(0,y.assertNoAttributes)(e),b(e),(0,y.assertNoAttributeTags)(e),(0,y.diagnosticDeprecate)(e,{label:"The `attrs` tag is deprecated, prefer destructuring `input` via the `const` tag.",fix(){const t=e.node.var;if(!t||"Identifier"===t.type&&"input"===t.name)e.remove();else{const r=m.types.markoTag(m.types.stringLiteral("const"),[m.types.markoAttribute("value",m.types.identifier("input"))],m.types.markoTagBody([]));r.var=t,e.replaceWith(r)}}})}],attributes:{},autocomplete:[{displayText:"attrs/{ ... }",description:"Use to receive the attributes passed into this template.",snippet:"attrs/{ $1 }$2"}]},v=r("../../browser-shims/compiler/index.js"),x=r("../../browser-shims/compiler/babel-utils.js"),w=r("../../browser-shims/compiler/babel-utils.js");function A(e){let{extra:t}=e;if(t||(t=e.extra={}),void 0===t.confident){const r=(0,w.computeNode)(e);r?(t.computed=r.value,t.confident=!0):(t.computed=void 0,t.confident=!1)}return t}var k=r("../../browser-shims/compiler/index.js"),E=r("../../browser-shims/compiler/index.js"),S=r("../../browser-shims/compiler/babel-utils.js"),T=d(r("../../node_modules/path-browserify/index.js"));function M(e){if(e.downstreamExpressions.size)return!0;for(const t of e.aliases)if(M(t))return!0;for(const t of e.propertyAliases.values())if(M(t))return!0;return!1}var I=r("../../browser-shims/compiler/index.js"),j=r("../../browser-shims/compiler/babel-utils.js"),C=Symbol(),P={build(e){const t=e[C];if(!t)throw e.path.buildCodeFrameError("Unable to build hydrate code, no files were visited before finalizing the build");const r=t.imports.map((e=>I.types.importDeclaration([],I.types.stringLiteral(e))));return t.init&&(r.unshift(I.types.importDeclaration([I.types.importSpecifier(I.types.identifier("init"),I.types.identifier("init"))],I.types.stringLiteral(`${f.name}/${e.markoOpts.optimize?"":"debug/"}dom`))),r.push(I.types.expressionStatement(I.types.callExpression(I.types.identifier("init"),[])))),r},visit(e,t,r){const s=t[C]||={imports:[],init:!1},{analyzedTags:n}=e.metadata.marko;s.imports.push((0,j.resolveRelativePath)(t,e.opts.filename)),s.init||=e.path.node.extra.hasInteractiveChild||e.path.node.extra.isInteractive||!1;for(const e of n||[])r(e)}};function B(){return"html"===O().output}function N(){return!B()}function O(){return cs.hub.file.markoOpts}function $(){return O().optimize}var D=r("../../browser-shims/compiler/index.js"),L=r("../../browser-shims/compiler/babel-utils.js");function F(e,t){return t?e:""}function U(e,t){return t||0===t?`${e}:${"number"==typeof t&&t&&!/^(--|ta|or|li|z)|cou|nk|it|ag|we|do|w$/.test(e)?t+"px":t}`:""}function R(e,t,r){switch(typeof e){case"string":return e;case"object":if(null!==e){let s="",n="";if(Array.isArray(e))for(const o of e){const e=R(o,t,r);""!==e&&(s+=n+e,n=t)}else for(const o in e){const a=r(o,e[o]);""!==a&&(s+=n+a,n=t)}return s}}return""}function _(e){return/^on[A-Z-]/.test(e)}function z(e){return"-"===e[2]?e.slice(3):e.slice(2).toLowerCase()}function W(e){return e?e+"":0===e?"0":""}Symbol();var V=/[<&]/g,q=e=>"&"===e?"&amp;":"&lt;";function H(e){return e?(t=e+"",V.test(t)?t.replace(V,q):t):0===e?"0":"&zwj;";var t}var J=/<\/script/g;function Z(e){return e?(t=e+"",J.test(t)?t.replace(J,"\\x3C/script"):t):0===e?"0":"";var t}var G=/<\/style/g;function K(e){return e?(t=e+"",G.test(t)?t.replace(G,"\\3C/style"):t):0===e?"0":"";var t}var{hasOwnProperty:X}={};function Y(e){const t=e[0];return'"'===t||t>="0"&&t<="9"?"["+e+"]":"."+e}function Q(e){return re("class",function(e){return R(e," ",F)}(e))}function ee(e){return re("style",function(e){return R(e,";",U)}(e))}function te(e,t){return function(e){return null==e||!1===e}(t)?"":function(e,t){switch(typeof t){case"string":return" "+e+ae(t);case"boolean":return" "+e;case"number":return" "+e+"="+t;case"object":if(t instanceof RegExp)return" "+e+ae(t.source)}return" "+e+ae(t+"")}(e,t)}function re(e,t){return t&&" "+e+ae(t)}(function*(){})().constructor,async function*(){}().constructor,(()=>{const e=new Map;for(const t of Object.getOwnPropertyNames(Symbol)){const r=Symbol[t];"symbol"==typeof r&&e.set(r,"Symbol."+t)}})(),new Map([[AggregateError,"AggregateError"],[Array,"Array"],[Array.from,"Array.from"],[Array.isArray,"Array.isArray"],[Array.of,"Array.of"],[ArrayBuffer,"ArrayBuffer"],[ArrayBuffer.isView,"ArrayBuffer.isView"],[Atomics.add,"Atomics.add"],[Atomics.and,"Atomics.and"],[Atomics.compareExchange,"Atomics.compareExchange"],[Atomics.exchange,"Atomics.exchange"],[Atomics.isLockFree,"Atomics.isLockFree"],[Atomics.load,"Atomics.load"],[Atomics.notify,"Atomics.notify"],[Atomics.or,"Atomics.or"],[Atomics.store,"Atomics.store"],[Atomics.sub,"Atomics.sub"],[Atomics.wait,"Atomics.wait"],[BigInt,"BigInt"],[BigInt.asIntN,"BigInt.asIntN"],[BigInt.asUintN,"BigInt.asUintN"],[BigInt64Array,"BigInt64Array"],[BigInt64Array.from,"BigInt64Array.from"],[BigInt64Array.of,"BigInt64Array.of"],[BigUint64Array,"BigUint64Array"],[BigUint64Array.from,"BigUint64Array.from"],[BigUint64Array.of,"BigUint64Array.of"],[Boolean,"Boolean"],[console.assert,"console.assert"],[console.clear,"console.clear"],[console.count,"console.count"],[console.countReset,"console.countReset"],[console.debug,"console.debug"],[console.dir,"console.dir"],[console.dirxml,"console.dirxml"],[console.error,"console.error"],[console.group,"console.group"],[console.groupCollapsed,"console.groupCollapsed"],[console.groupEnd,"console.groupEnd"],[console.info,"console.info"],[console.log,"console.log"],[console.table,"console.table"],[console.time,"console.time"],[console.timeEnd,"console.timeEnd"],[console.timeLog,"console.timeLog"],[console.timeStamp,"console.timeStamp"],[console.trace,"console.trace"],[console.warn,"console.warn"],[DataView,"DataView"],[Date,"Date"],[Date.now,"Date.now"],[Date.parse,"Date.parse"],[Date.UTC,"Date.UTC"],[decodeURI,"decodeURI"],[decodeURIComponent,"decodeURIComponent"],[encodeURI,"encodeURI"],[encodeURIComponent,"encodeURIComponent"],[Error,"Error"],[EvalError,"EvalError"],[Float32Array,"Float32Array"],[Float32Array.from,"Float32Array.from"],[Float32Array.of,"Float32Array.of"],[Float64Array,"Float64Array"],[Float64Array.from,"Float64Array.from"],[Float64Array.of,"Float64Array.of"],[Function,"Function"],[globalThis.atob,"atob"],[globalThis.btoa,"btoa"],[globalThis.clearImmediate,"clearImmediate"],[globalThis.clearInterval,"clearInterval"],[globalThis.clearTimeout,"clearTimeout"],[globalThis.crypto?.getRandomValues,"crypto.getRandomValues"],[globalThis.crypto?.randomUUID,"crypto.randomUUID"],[globalThis.fetch,"fetch"],[globalThis.performance?.now,"performance.now"],[globalThis.queueMicrotask,"queueMicrotask"],[globalThis.setImmediate,"setImmediate"],[globalThis.setInterval,"setInterval"],[globalThis.setTimeout,"setTimeout"],[globalThis.structuredClone,"structuredClone"],[globalThis.URL,"URL"],[globalThis.URLSearchParams,"URLSearchParams"],[globalThis.WritableStream,"WritableStream"],[Int16Array,"Int16Array"],[Int16Array.from,"Int16Array.from"],[Int16Array.of,"Int16Array.of"],[Int32Array,"Int32Array"],[Int32Array.from,"Int32Array.from"],[Int32Array.of,"Int32Array.of"],[Int8Array,"Int8Array"],[Int8Array.from,"Int8Array.from"],[Int8Array.of,"Int8Array.of"],[Intl.Collator,"Intl.Collator"],[Intl.DateTimeFormat,"Intl.DateTimeFormat"],[Intl.DisplayNames,"Intl.DisplayNames"],[Intl.getCanonicalLocales,"Intl.getCanonicalLocales"],[Intl.ListFormat,"Intl.ListFormat"],[Intl.Locale,"Intl.Locale"],[Intl.NumberFormat,"Intl.NumberFormat"],[Intl.PluralRules,"Intl.PluralRules"],[Intl.RelativeTimeFormat,"Intl.RelativeTimeFormat"],[Intl.Segmenter,"Intl.Segmenter"],[Intl.supportedValuesOf,"Intl.supportedValuesOf"],[isFinite,"isFinite"],[isNaN,"isNaN"],[JSON.parse,"JSON.parse"],[JSON.stringify,"JSON.stringify"],[Map,"Map"],[Map.groupBy,"Map.groupBy"],[Math.abs,"Math.abs"],[Math.acos,"Math.acos"],[Math.acosh,"Math.acosh"],[Math.asin,"Math.asin"],[Math.asinh,"Math.asinh"],[Math.atan,"Math.atan"],[Math.atan2,"Math.atan2"],[Math.atanh,"Math.atanh"],[Math.cbrt,"Math.cbrt"],[Math.ceil,"Math.ceil"],[Math.clz32,"Math.clz32"],[Math.cos,"Math.cos"],[Math.cosh,"Math.cosh"],[Math.exp,"Math.exp"],[Math.expm1,"Math.expm1"],[Math.floor,"Math.floor"],[Math.fround,"Math.fround"],[Math.hypot,"Math.hypot"],[Math.imul,"Math.imul"],[Math.log,"Math.log"],[Math.log10,"Math.log10"],[Math.log1p,"Math.log1p"],[Math.log2,"Math.log2"],[Math.max,"Math.max"],[Math.min,"Math.min"],[Math.pow,"Math.pow"],[Math.random,"Math.random"],[Math.round,"Math.round"],[Math.sign,"Math.sign"],[Math.sin,"Math.sin"],[Math.sinh,"Math.sinh"],[Math.sqrt,"Math.sqrt"],[Math.tan,"Math.tan"],[Math.tanh,"Math.tanh"],[Math.trunc,"Math.trunc"],[Number,"Number"],[Number.isFinite,"Number.isFinite"],[Number.isInteger,"Number.isInteger"],[Number.isNaN,"Number.isNaN"],[Number.isSafeInteger,"Number.isSafeInteger"],[Number.parseFloat,"Number.parseFloat"],[Number.parseInt,"Number.parseInt"],[Object,"Object"],[Object.assign,"Object.assign"],[Object.create,"Object.create"],[Object.defineProperties,"Object.defineProperties"],[Object.defineProperty,"Object.defineProperty"],[Object.entries,"Object.entries"],[Object.freeze,"Object.freeze"],[Object.fromEntries,"Object.fromEntries"],[Object.getOwnPropertyDescriptor,"Object.getOwnPropertyDescriptor"],[Object.getOwnPropertyDescriptors,"Object.getOwnPropertyDescriptors"],[Object.getOwnPropertyNames,"Object.getOwnPropertyNames"],[Object.getOwnPropertySymbols,"Object.getOwnPropertySymbols"],[Object.getPrototypeOf,"Object.getPrototypeOf"],[Object.is,"Object.is"],[Object.isExtensible,"Object.isExtensible"],[Object.isFrozen,"Object.isFrozen"],[Object.isSealed,"Object.isSealed"],[Object.keys,"Object.keys"],[Object.preventExtensions,"Object.preventExtensions"],[Object.seal,"Object.seal"],[Object.setPrototypeOf,"Object.setPrototypeOf"],[Object.values,"Object.values"],[parseFloat,"parseFloat"],[parseInt,"parseInt"],[Promise,"Promise"],[Proxy,"Proxy"],[RangeError,"RangeError"],[ReferenceError,"ReferenceError"],[Reflect.apply,"Reflect.apply"],[Reflect.construct,"Reflect.construct"],[Reflect.defineProperty,"Reflect.defineProperty"],[Reflect.deleteProperty,"Reflect.deleteProperty"],[Reflect.get,"Reflect.get"],[Reflect.getOwnPropertyDescriptor,"Reflect.getOwnPropertyDescriptor"],[Reflect.getPrototypeOf,"Reflect.getPrototypeOf"],[Reflect.has,"Reflect.has"],[Reflect.isExtensible,"Reflect.isExtensible"],[Reflect.ownKeys,"Reflect.ownKeys"],[Reflect.preventExtensions,"Reflect.preventExtensions"],[Reflect.set,"Reflect.set"],[Reflect.setPrototypeOf,"Reflect.setPrototypeOf"],[RegExp,"RegExp"],[Set,"Set"],[String,"String"],[String.fromCharCode,"String.fromCharCode"],[String.fromCodePoint,"String.fromCodePoint"],[String.raw,"String.raw"],[Symbol,"Symbol"],[Symbol.for,"Symbol.for"],[SyntaxError,"SyntaxError"],[TypeError,"TypeError"],[Uint16Array,"Uint16Array"],[Uint16Array.from,"Uint16Array.from"],[Uint16Array.of,"Uint16Array.of"],[Uint32Array,"Uint32Array"],[Uint32Array.from,"Uint32Array.from"],[Uint32Array.of,"Uint32Array.of"],[Uint8Array,"Uint8Array"],[Uint8Array.from,"Uint8Array.from"],[Uint8Array.of,"Uint8Array.of"],[Uint8ClampedArray,"Uint8ClampedArray"],[Uint8ClampedArray.from,"Uint8ClampedArray.from"],[Uint8ClampedArray.of,"Uint8ClampedArray.of"],[URIError,"URIError"],[WeakMap,"WeakMap"],[WeakSet,"WeakSet"]]),new Map([[Atomics,"Atomics"],[console,"console"],[globalThis,"globalThis"],[globalThis.crypto,"crypto"],[Intl,"Intl"],[JSON,"JSON"],[Math,"Math"],[Reflect,"Reflect"]]),Symbol("Scope ID"),Symbol("Pending Contexts"),Symbol(),globalThis.setImmediate||globalThis.setTimeout||globalThis.queueMicrotask,Symbol("selectedValue");var se=/'|&(?=#?\w+;)/g,ne=/"|&(?=#?\w+;)/g,oe=/["'>\s]|&#?\w+;|\/$/g;function ae(e){return e?oe.test(e)?e[oe.lastIndex-1]===(oe.lastIndex=0,'"')?"='"+function(e){return se.test(e)?e.replace(se,ie):e}(e)+"'":'="'+function(e){return ne.test(e)?e.replace(ne,ce):e}(e)+'"':"="+e:""}function ie(e){return"'"===e?"&#39;":"&amp;"}function ce(e){return'"'===e?"&#34;":"&amp;"}Symbol();var le=r("../../browser-shims/compiler/index.js");function pe(e){return/^[a-z_$][a-z0-9_$]*$/i.test(e)}function de(e){return pe(e)?le.types.identifier(e):/^(?:0|[1-9][0-9]*)$/.test(e)?le.types.numericLiteral(parseInt(e,10)):le.types.stringLiteral(e)}function ue(e,t){return le.types.objectProperty(de(e),t)}function fe(e,t,r){const s=de(t),n="Identifier"!==s.type;return r?le.types.optionalMemberExpression(e,s,n,!0):le.types.memberExpression(e,s,n)}var me=["conditional","conditionalClosure","dynamicTag","createRenderer","createContent","createTemplate","dynamicClosure","dynamicClosureRead","intersection","loopClosure","loopIn","loopOf","loopTo","state","value"];function ye(e){const{output:t}=O();return fe((0,L.importStar)(cs.hub.file,function(e){const{optimize:t}=O();return`${f.name}/${t?"":"debug/"}${"html"===e?"html":"dom"}`}(t),"$"),e)}function ge(e,...t){const r=D.types.callExpression(ye(e),function(e){const t=[];for(let r=e.length;r--;){const s=e[r];(s||t.length)&&(t[r]=s||D.types.unaryExpression("void",D.types.numericLiteral(0)))}return t}(t));return me.includes(e)&&(r.leadingComments=[{type:"CommentBlock",value:" @__PURE__ "}]),r}function be(){return{escapeXML:H,toString:W,attr:te,classAttr:Q,styleAttr:ee,escapeScript:Z,escapeStyle:K}}function he(){const e=O();return`marko/src/runtime/helpers/tags-compat/${B()?"html":"dom"}${e.optimize?"":"-debug"}.${"esm"===e.modules?"mjs":"js"}`}var ve=r("../../browser-shims/compiler/index.js"),xe=r("../../browser-shims/compiler/babel-utils.js"),we=r("../../browser-shims/compiler/babel-utils.js");function Ae(e){return e.node.name.value}var{taglibId:ke}=f;function Ee(e){if(e.isMarkoTag()){const t=(0,we.getTagDef)(e);if(t)switch(t.taglibId){case ke:case"@marko/translator-interop-class-tags":return!0;case"marko-html":switch(t.name){case"script":case"style":return!0}}}return!1}function Se(e,t){return Ee(e)&&Ae(e)===t}function Te(e){if(Ee(e))switch(Ae(e)){case"if":case"else-if":case"else":return!0}return!1}var Me=class{constructor(e){this.compare=e}add(e,t){return e?Array.isArray(e)?Be(this.compare,e,t):Ne(this.compare,e,t):t}union(e,t){return e?Array.isArray(e)?t?Array.isArray(t)?function(e,t,r){const s=t.length,n=r.length;let o=0,a=0;const i=[];for(;o<s&&a<n;){const s=t[o],n=r[a],c=e(s,n);0===c?(o++,a++,i.push(s)):c<0?(o++,i.push(s)):(a++,i.push(n))}if(s===n&&o===s)return t;for(;o<s;)i.push(t[o++]);for(;a<n;)i.push(r[a++]);return i}(this.compare,e,t):Be(this.compare,e,t):e:t?Array.isArray(t)?Be(this.compare,[...t],e):Ne(this.compare,t,e):e:t}find(e,t){if(e){if(Array.isArray(e))return Pe(this.compare,e,t);if(0===this.compare(e,t))return e}}};function Ie(e,t){return e?Array.isArray(e)?(e.push(t),e):[e,t]:t}function je(e,t){if(e)if(Array.isArray(e)){let r=0;for(const s of e)t(s,r++)}else t(e,0)}function Ce(e,t){if(e){if(Array.isArray(e))return e.find(t);if(t(e,0))return e}}function Pe(e,t,r){let s=t.length,n=0;for(;n<s;){const o=n+s>>>1,a=t[o],i=e(a,r);if(0===i)return a;i>0?s=o:n=o+1}}function Be(e,t,r){const s=t.length;let n=s,o=0;for(;o<n;){const s=o+n>>>1,a=e(t[s],r);if(0===a)return t;a>0?n=s:o=s+1}const a=new Array(s+1);for(let e=0;e<o;e++)a[e]=t[e];let i=r;for(;o<s;){const e=i;i=t[o],a[o++]=e}return a[s]=i,a}function Ne(e,t,r){const s=e(t,r);return 0===s?t:s<0?[t,r]:[r,t]}var Oe=e=>{const t=new WeakMap;return[()=>{let r=t.get(cs);return r||t.set(cs,r=e()),r},e=>{t.set(cs,e)}]};function $e(e,t){return[r=>{const s=cs.state[e]??={};return s[r.id]??=t&&t(r)},(t,r)=>{(cs.state[e]??={})[t.id]=r}]}var De=r("../../browser-shims/compiler/index.js"),Le=r("../../browser-shims/compiler/babel-utils.js"),Fe=/^<.*>$|\.marko$/;function Ue(e){const t=e.node.extra??={};if(void 0===t.tagNameType){const r=e.get("name");if(r.isStringLiteral()?(t.tagNameType="@"===r.node.value[0]?3:(0,Le.isNativeTag)(e)?0:1,t.tagNameNullable=t.tagNameNullable=!1):r.isIdentifier()?(function(e,t){const r=[e];let s,n,o,a=!1;for(;(s=r.pop())&&2!==n;)if(s.isConditionalExpression())r.push(s.get("consequent")),s.node.alternate&&r.push(s.get("alternate"));else if(s.isLogicalExpression())"||"===s.node.operator?r.push(s.get("left")):a=!0,r.push(s.get("right"));else if(s.isAssignmentExpression())r.push(s.get("right"));else if(s.isBinaryExpression())n="+"!==s.node.operator||void 0!==n?2:0;else if(s.isStringLiteral()||s.isTemplateLiteral())n=void 0!==n?2:0;else if(s.isNullLiteral())a=!0;else if(s.isIdentifier()){if("undefined"===s.node.name){a=!0;continue}const t=s.scope.getBinding(s.node.name);if(!t){n=2;continue}if("module"===t.kind){const r=t.path.parent;if(Fe.test(r.source.value)&&r.specifiers.some((e=>De.types.isImportDefaultSpecifier(e)))){const t=(0,Le.resolveTagImport)(e,r.source.value)||r.source.value;0===n||o&&o!==t?(n=2,o=void 0):(n=1,o=t)}else n=2;continue}const i=t.path;if(i.isMarkoTag()&&"local"===t.kind){const e=i.get("name").node.value;if("const"===e){r.push(i.get("attributes")[0].get("value"));continue}if("let"===e){n=2;continue}continue}n=2}else n=2;t.tagNameType=n,t.tagNameNullable=a,t.tagNameDynamic=!0,1===n&&o&&(t.tagNameImported=o)}(r,t),0===t.tagNameType&&(t.tagNameType=2)):r.isTemplateLiteral()&&!r.node.expressions.length?t.tagNameType=0:t.tagNameType=2,void 0===t.tagNameType&&(t.tagNameType=2),1===t.tagNameType){const r=(0,Le.loadFileForTag)(e);r?"class"===r.ast.program.extra.featureType&&(t.tagNameType=2,t.featureType="class",(cs.node.extra??={}).needsCompat=!0):t.tagNameType=2}}return t.tagNameType}var Re=new Me((function(e,t){return e.id-t.id}));function _e(e){const t=e.node.extra??={};let r=t.section;if(!r&&("Program"===e.type||e.get("body").length)){const s=e.parentPath?ze(e.parentPath):void 0,n=e.parentPath?.get("name"),o=e.isProgram()?"":cs.scope.generateUid(n.toString()+"_content"),a=e.hub.file.path.node.extra??={},i=a.sections??=[];r=t.section={id:i.length,name:o,loc:n?.node.loc||void 0,depth:s?s.depth+1:0,parent:s,sectionAccessor:void 0,params:void 0,referencedClosures:void 0,referencedHoists:void 0,bindings:void 0,hoisted:void 0,isHoistThrough:void 0,assignments:void 0,content:Ke(e),upstreamExpression:void 0,downstreamBinding:void 0,hasAbortSignal:!1,isBranch:!1},i.push(r)}return r}function ze(e){let t=e;for(;;){if("Program"===t.type||"MarkoTagBody"===t.type&&!t.node.attributeTags&&!st(t.parentPath))return _e(t);t=t.parentPath}}function We(e){return e.node.extra?.section}function Ve(e){let t,r=e;for(;void 0===(t=r.node.extra?.section);)r=r.parentPath;return t}var[qe]=$e("scopeIdIdentifier",(e=>cs.scope.generateUidIdentifier(`scope${e.id}_id`))),[He,Je]=$e("parentIsOwner",(()=>!1)),[Ze]=$e("scopeIdentifier",(()=>ve.types.identifier("undefined")));function Ge(e){const{sections:t}=cs.node.extra;t?.forEach(e)}function Ke(e){const t=e.get("body"),r={startType:null,endType:null,singleChild:!0};for(let e=t.length;e--;){const s=Xe(t[e],"endType",r);if(null!==s){r.endType=s;for(let s=0;s<e;s++){const e=Xe(t[s],"startType");if(null!==e)return r.startType=e,r.singleChild=!1,r}return r.startType=Xe(t[e],"startType"),r}}return null}function Xe(e,t,r){switch(e.type){case"MarkoText":return 4;case"MarkoPlaceholder":return 2;case"MarkoScriptlet":case"MarkoComment":case"ImportDeclaration":case"ExportAllDeclaration":case"ExportNamedDeclaration":return null;case"MarkoTag":{const s=e;if(Ee(s))switch(s.node.name.value){case"html-comment":return 0;case"html-script":case"html-style":return 3;case"for":case"if":return 1;default:return null}else{if((0,xe.isNativeTag)(s))return 3;if((0,xe.isAttributeTag)(s))return null;if(ve.types.isStringLiteral(s.node.name)){const e=(0,xe.loadFileForTag)(s)?.ast.program.extra.section;if(e)return e.content?(r&&!e.content.singleChild&&"endType"===t&&(r.startType=e.content.startType,r.singleChild=!1),e.content[t]):null}}}}return 1}var Ye=e=>!(e.isBranch||!1===e.downstreamBinding?.serialize),Qe=(e,t)=>!!Ce(e.referencedClosures,(r=>(!t||e.parent===r.section)&&ln(r)));function et(e,t){return e.parent?.id===t.section.id}function tt(e,t){return!e.isBranch||!et(e,t)}function rt(e,t){do{if(t===e)return!0}while(t=t.parent);return!1}function st(e){if(Ee(e))switch(e.node.name.value){case"html-comment":case"html-script":case"html-style":return!0;default:return!1}return 0===Ue(e)}var nt=r("../../browser-shims/compiler/index.js"),ot=r("../../browser-shims/compiler/babel-utils.js"),at=d(r("../../node_modules/path-browserify/index.js"));var it=/[\\^$.*+?()[\]{}|]/g,ct=r("../../browser-shims/compiler/index.js"),lt=r("../../browser-shims/compiler/babel-utils.js"),pt=r("../../browser-shims/compiler/index.js"),dt=r("../../browser-shims/compiler/babel-utils.js");function ut(e){const t={};for(const r of e.attributes)"MarkoAttribute"===r.type&&(t[r.name]=r.value);return t}function ft(e){const t="MarkoTagBody"===e.parent.type?e.parentPath.parentPath:e.parentPath;if("MarkoTag"===t.type)return t}var mt=r("../../browser-shims/compiler/index.js");function yt(e,t){if(!e)return!1;const{node:r}=t,s=bt(e)?e.default:e;return ht(s)?s(t,mt.types):s.enter&&s.enter(t,mt.types),r!==t.node}function gt(e,t){if(!e)return!1;const{node:r}=t,s=bt(e)?e.default:e;return!ht(s)&&s.exit&&s.exit(t,mt.types),r!==t.node}function bt(e){return Boolean(e.default)}function ht(e){return"function"==typeof e}function vt({html:e,dom:t}){return{enter(r){yt(B()?e:t,r)},exit(r){gt(B()?e:t,r)}}}var xt=r("../../browser-shims/compiler/index.js"),wt=r("../../browser-shims/compiler/index.js");function At(e){const t=[],r=[];let s=e[0];for(let n=1;n<e.length;n++){let o=e[n];if("object"==typeof o){if(!wt.types.isStringLiteral(o)){if(wt.types.isTemplateLiteral(o)){let t=n+1;const r=o.expressions.length;Et(e,t,o.quasis.length+r);for(let s=0;s<r;s++)e[t++]=o.quasis[s].value.raw,e[t++]=o.expressions[s];e[t]=o.quasis[r].value.raw;continue}r.push(o),t.push(s),s="";continue}o=o.value}s+=o}return r.length?1!==r.length||s||t[0]?(t.push(s),wt.types.templateLiteral(t.map((e=>wt.types.templateElement({raw:e}))),r)):r[0]:s?wt.types.stringLiteral(s):void 0}function kt(e,t){e[e.length-1]+=t}function Et(e,t,r){for(let s=e.length-1;s>=t;s--)e[s+r]=e[s]}r("../../browser-shims/compiler/index.js");var[St]=$e("walks",(()=>[""])),[Tt]=$e("walkComment",(()=>[])),[Mt]=$e("steps",(()=>[])),It={32:"get",36:"inside",37:"replace",38:"endChild",47:"beginChild",48:"beginChildWithVar",49:"dynamicTagWithVar",67:"next",97:"over",107:"out",117:"multiplier",91:"nextEnd",106:"overEnd",116:"outEnd",126:"multiplierEnd"};function jt(e){Mt(Ve(e)).push(0)}function Ct(e){Mt(Ve(e)).push(1)}function Pt(e){Mt(Ve(e)).push(0,1)}function Bt(e,t){if(B())return;const r=Ve(e),s=Mt(r),n=St(r),o=Tt(r);let a="";if(s.length){const e=[];let t=0;for(const r of s)0===r?(t++,e.push(67)):(t--,t>=0?(e.length=e.lastIndexOf(67),e.push(97)):(e.length=e.lastIndexOf(107)+1,e.push(107),t=0));let r=e[0],n=0;for(const t of e)t!==r?(o.push(`${It[r]}(${n})`),a+=Nt(r,n),r=t,n=1):n++;o.push(`${It[r]}(${n})`),a+=Nt(r,n),s.length=0}void 0!==t&&(32!==t&&Ft(e)`<!>`,o.push(`${It[t]}`),a+=String.fromCharCode(t)),kt(n,a)}function Nt(e,t){switch(e){case 67:return Ot(t,e,20);case 97:case 107:return Ot(t,e,10);default:throw new Error(`Unexpected walk code: ${e}`)}}function Ot(e,t,r){let s="";if(e>=r){const t=Math.floor(e/r);s+=Ot(t,117,10),e-=t*r}return s+=String.fromCharCode(t+e),s}function $t(e){const t=1===e.content?.startType?String.fromCharCode(68):"",r=1===e.content?.endType?String.fromCharCode(68):"",s=At([t,...St(e),r]);return s&&""!==s.value&&(s.leadingComments=[{type:"CommentBlock",value:" "+Tt(e).join(", ")+" "}]),s}var[Dt]=$e("writes",(()=>[""])),[Lt]=$e("trailerWrites",(()=>[""]));function Ft(e,t){const r=Ve(e),s=t?Lt:Dt;return(e,...t)=>{const n=t.length,o=s(r);kt(o,e[0]);for(let r=0;r<n;r++)o.push(t[r],e[r+1])}}function Ut(e){const t=Ve(e),r=Dt(t),s=Lt(t),n=At(r),o=At(s);return r.length=0,r[0]="",s.length=0,s[0]="",n&&o?xt.types.expressionStatement(xt.types.sequenceExpression([ge("write",n),ge("writeTrailers",o)])):n?xt.types.expressionStatement(ge("write",n)):o?xt.types.expressionStatement(ge("writeTrailers",o)):void 0}function Rt(e){const t=Ut(e);t&&e.insertBefore(t)[0].skip()}function _t(e){const t=e.isProgram()?e:e.get("body"),r=Ut(t);r&&t.pushContainer("body",r)[0].skip()}function zt(e){const t=1===e.content?.startType?"<!>":"",r=1===e.content?.endType?"<!>":"",s=Dt(e);return{setup:Gr(e),walks:$t(e),writes:At([t,...s,r])}}function Wt(e,t){const r=Ve(e);if(0!==t.type)throw e.buildCodeFrameError("Tried to mark a node that was not determined to need a mark during analyze.");B()&&Ft(e)`${ge("markResumeNode",qe(r),Zs(t))}`}var Vt=new WeakSet,[qt,Ht]=$e("returnValue"),Jt={analyze(e){(0,dt.assertNoArgs)(e),(0,dt.assertNoVar)(e),(0,dt.assertNoParams)(e),b(e),(0,dt.assertAllowedAttributes)(e,["value","valueChange"]);const t=ft(e);if(t){if((0,dt.isNativeTag)(t))throw e.get("name").buildCodeFrameError("The `return` tag can not be used in a native tag.");if(function(e){if(Ee(e))switch(Ae(e)){case"if":case"else-if":case"else":case"for":case"await":case"try":return!0}return!1}(t))throw e.get("name").buildCodeFrameError(`The \`return\` tag can not be used under an \`${t.get("name").toString()}\` tag.`)}if(Vt.has(e.parentPath))throw e.get("name").buildCodeFrameError(`Cannot have multiple \`return\` tags ${"Program"===e.parent.type?"for the template":"within a tag's body content"}.`);if(Vt.add(e.parentPath),!ut(e.node).value)throw e.get("name").buildCodeFrameError("The `return` tag requires a value.")},translate:vt({html:{exit(e){const t=Ve(e),r=ut(e.node);if(Rt(e),r.valueChange&&hr(t,"@",r.valueChange),r.value){const s=e.scope.generateUidIdentifier("return");Ht(t,s),e.replaceWith(pt.types.variableDeclaration("const",[pt.types.variableDeclarator(s,r.value)]))[0].skip()}}},dom:{exit(e){const t=Ve(e),r=ut(e.node);r.value&&Fr(t,r.value.extra?.referencedBindings,{identifier:ye("tagVarSignal"),hasDownstreamIntersections:()=>!0},r.value),r.valueChange&&Fr(t,r.valueChange.extra?.referencedBindings,{identifier:ye("setTagVarChange"),hasDownstreamIntersections:()=>!1},r.valueChange),e.remove()}}}),parseOptions:{openTagOnly:!0},autocomplete:[{displayText:"return=<value>",description:"Provides a value for use in a parent template.",snippet:"return=${1:value}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#return"}]};function Zt(e,t){switch(e.type){case"ObjectPattern":for(const r of e.properties)switch(r.type){case"ObjectProperty":"AssignmentPattern"===r.value.type?Zt(r.value.left,t):Zt(r.value,t);break;case"RestElement":Zt(r.argument,t)}break;case"ArrayPattern":for(const r of e.elements)if(null!=r)switch(r.type){case"RestElement":Zt(r.argument,t);break;case"AssignmentPattern":Zt(r.left,t);break;default:Zt(r,t)}break;case"Identifier":t(e)}}var Gt=r("../../browser-shims/compiler/index.js");function Kt(e){return e.declared||!e.upstreamAlias?Gt.types.identifier(e.name):void 0!==e.property?fe(Kt(e.upstreamAlias),e.property,e.upstreamAlias.nullable):Kt(e.upstreamAlias)}var Xt=r("../../browser-shims/compiler/index.js");function Yt(e,t){const r=e.depth,s=Xt.types.objectPattern([]);let n;return je(t,(t=>{const o=t.name;if(!pe(o))return;const a=Gs(t),i=a===o;let c=s;if(t.section!==e){n||(n=[s]);const e=r-t.section.depth;let o=n.length,a=n[o-1];for(;o<=e;o++){const e=Xt.types.objectPattern([]);a.properties.push(Xt.types.objectProperty(Xt.types.identifier("_"),e)),n.push(e),a=e}c=n[e]}c.properties.push(Xt.types.objectProperty(de(a),Xt.types.identifier(o),!1,i))})),s}function Qt(e,t){let r=ls??Xt.types.identifier("undefined");const s=e.depth-t.depth;for(let e=0;e<s;e++)r=Xt.types.memberExpression(r,Xt.types.identifier("_"));if(s<0)throw new Error("Unable to find scope for reference.");return r}function er(e,t){const r=de(Gs(t));return Xt.types.memberExpression(Qt(e,t.section),r,"Identifier"!==r.type)}var tr=r("../../browser-shims/compiler/index.js");function rr(e){switch(e.type){case"FunctionDeclaration":case"FunctionExpression":case"ArrowFunctionExpression":return e;default:return tr.types.functionExpression(null,e.params,e.body,e.async,e.generator)}}var sr=r("../../browser-shims/compiler/index.js");function nr(e){if(1===e.length&&sr.types.isExpressionStatement(e[0])){const{expression:t}=e[0];switch(t.type){case"ObjectExpression":case"AssignmentExpression":return or(t);default:return t}}return sr.types.blockStatement(e)}function or(e){switch(e.type){case"ObjectExpression":case"AssignmentExpression":return sr.types.parenthesizedExpression(e);default:return e}}var ar=r("../../browser-shims/compiler/index.js"),ir=Symbol("skip");function cr(e,t,r){const s=e[t];if(s)if(Array.isArray(s))for(let e=s.length;e--;)cr(s,e,r);else{const n=ar.types.VISITOR_KEYS[s.type];for(let e=n.length;e--;)cr(s,n[e],r);const o=r(s,e,t);o&&(e[t]=o)}}function lr(e,t){if(e)if(Array.isArray(e)){for(const r of e)if(lr(r,t))return!0}else{switch(t(e)){case!0:return!0;case ir:return!1}for(const r of ar.types.VISITOR_KEYS[e.type])if(lr(e[r],t))return!0}return!1}var[pr]=$e("signals",(()=>new Map)),[dr,ur]=$e("queue");function fr(e,t){ur(We(e.get("body")),t)}var[mr,yr]=$e("forceResumeScope");function gr(e){yr(e,!0)}var[br]=$e("serializedScopeProperties",(()=>new Map));function hr(e,t,r){br(e).set(t,r)}var[vr,xr]=$e("sectionWriteScopeBuilder");function wr(e,t){const r=vr(e);xr(e,r?e=>t(r(e)):t)}var Ar=new WeakMap,[kr]=$e("htmlScopeStatements",(()=>[])),[Er]=$e("hoistFunctionsIdsMap",(()=>new Map));function Sr(e){const t=Er(e.section);let r=t.get(e);return r||t.set(e,r=cs.scope.generateUidIdentifier(`get${e.name}`)),r}var Tr=()=>ct.types.stringLiteral("SIGNAL NOT INITIALIZED");function Mr(e,t,r=function(e){let t;if(e)if(Array.isArray(e)){t="expr";for(const r of e)t+=`_${r.name}`}else t=e.name;else t="setup";return t}(t)){const s=pr(e);let n=s.get(t);if(!n){const o=t?!Array.isArray(t)&&t.section===e&&t.export:!e.parent&&cs.node.extra.domExports?.setup;if(s.set(t,n={identifier:o?ct.types.identifier(o):cs.scope.generateUidIdentifier(r+e.name.replace("_","$")),referencedBindings:t,section:e,values:[],intersection:void 0,render:[],renderReferencedBindings:void 0,effect:[],effectReferencedBindings:void 0,subscribers:[],hasDownstreamIntersections:()=>{let r=!!n.intersection;if(!r)for(const e of n.values)if(e.signal.hasDownstreamIntersections()){r=!0;break}if(!r&&!Array.isArray(t)&&t){for(const s of t.aliases)if(Mr(e,s).hasDownstreamIntersections()){r=!0;break}if(!r)for(const[,s]of t.propertyAliases)if(Mr(e,s).hasDownstreamIntersections()){r=!0;break}}return n.hasDownstreamIntersections=()=>r,r},build:Tr,export:!!o}),B())return n;t?Array.isArray(t)?(Nr(t,n),n.build=()=>{const{id:e,scopeOffset:r}=Us.get(t);return ge("intersection",ct.types.numericLiteral(e),jr(n,[ls],t),r||t.length>2?ct.types.numericLiteral(t.length-1):void 0,r&&Zs(r))}):t.section!==e&&zs.find(e.referencedClosures,t)&&(n.build=()=>{const r=jr(n,[ls,ct.types.identifier(t.name)]);return tt(e,t)?ge("dynamicClosureRead",Zs(t),r,et(e,t)?void 0:ct.types.arrowFunctionExpression([ls],Qt(e,t.section))):dr(e)(t,r)}):n.build=()=>jr(n,[ls])}return n}function Ir(e,t="value"){const r=Mr(e.section,e);r.build=()=>{const s=jr(r,[ls,ct.types.identifier(e.name)]),n=!e.upstreamAlias&&(3===e.type||2===e.type),o=!(e.upstreamAlias&&!e.property)&&(e.downstreamExpressions.size||s.body.body.length>0)||r.intersection,a=n||r.intersection;return o||a||e.hoists.size?ge(t,Zs(e,"state"===t),s):s},r.valueAccessor=Zs(e);for(const t of e.aliases)Ir(t);for(const t of e.propertyAliases.values())Ir(t);return r}function jr(e,t,r){const s=e.section,n=e.referencedBindings,[o,a]=t,i=n&&!Array.isArray(n)&&n.section===s;if(i){for(const t of n.aliases){const r=Mr(t.section,t);e.render.push(ct.types.expressionStatement(ct.types.callExpression(r.identifier,[o,a,...Br(r)])))}for(const[t,r]of n.propertyAliases){const s=Mr(r.section,r);e.render.push(ct.types.expressionStatement(ct.types.callExpression(s.identifier,[o,fe(a,t,n.nullable),...Br(s)])))}}for(const t of e.values)e.render.push(ct.types.expressionStatement(ct.types.callExpression(t.signal.identifier,[t.scope,t.value,...Br(t.signal)])));if(je(e.intersection,(t=>{e.render.push(ct.types.expressionStatement(ct.types.callExpression(t,[o])))})),i){let t,r;je(n.closureSections,(s=>{ln(n)&&(tt(s,n)?(t||(t=[],r=cs.scope.generateUidIdentifier(e.identifier.name+"_closure"),e.render.push(ct.types.expressionStatement(ct.types.callExpression(r,[o])))),t.push(Mr(s,n).identifier)):e.render.push(ct.types.expressionStatement(ct.types.callExpression(Mr(s,n).identifier,[o]))))})),r&&(e.prependStatements||=[]).push(ct.types.variableDeclaration("const",[ct.types.variableDeclarator(r,ge("dynamicClosure",...t))]))}if(e.effect.length){const t=ct.types.identifier(`${e.identifier.name}_effect`);e.render.push(ct.types.expressionStatement(ct.types.callExpression(t,[o])))}return r&&e.render.unshift(ct.types.variableDeclaration("const",[ct.types.variableDeclarator(Yt(s,r),o)])),ct.types.arrowFunctionExpression(t,ct.types.blockStatement(e.render))}var Cr=new WeakSet,Pr=[];function Br(e){return e.extraArgs?(Cr.has(e)||(Cr.add(e),cr(e,"extraArgs",Kr)),e.extraArgs):Pr}function Nr(e,t){if(Array.isArray(e))return void e.forEach((e=>Nr(e,t)));const r=Mr(t.section,e);r.intersection=Ie(r.intersection,t.identifier)}function Or(e){for(let t=e.length;t--;){const r=e[t];if(r)if(ct.types.isArrowFunctionExpression(r)&&ct.types.isBlockStatement(r.body)){const s=r.body.body;0===s.length?e[t]=ct.types.numericLiteral(0):1===s.length&&ct.types.isExpressionStatement(s[0])&&(r.body=or(s[0].expression))}else(ct.types.isNullLiteral(r)||ct.types.isUnaryExpression(r)&&"void"===r.operator)&&(e[t]=ct.types.numericLiteral(0));else e[t]=ct.types.numericLiteral(0)}for(let t=e.length-1;ct.types.isNumericLiteral(e[t])&&0===e[t].value;)e.length=t--;return e}function $r(e,t,r,s,n){const o=Mr(t,r),a=o[e]??=[],i="effect"===e?Dr:Lr;if(Array.isArray(s)?a.push(...s):a.push(s),!1!==n)if(n)for(const e of n)i(o,e);else i(o,r)}function Dr(e,t){e.effectReferencedBindings=zs.union(e.effectReferencedBindings,t)}function Lr(e,t){e.renderReferencedBindings=zs.union(e.renderReferencedBindings,t)}function Fr(e,t,r,s,n=ls){Mr(e,t).values.push({signal:r,value:s,scope:n})}function Ur(e,t,r){const{markoOpts:s,opts:{filename:n}}=cs.hub.file;let o="";if(t)if("string"==typeof t)o+=`_${t}`;else if(Array.isArray(t))for(const e of t)o+=`_${e.name}`;else o+=`_${t.name}`;return(0,lt.getTemplateId)(s,n,`${e.id}${o}${r?"/"+r:""}`)}var Rr=new WeakMap;function _r(e,t){const{markoOpts:r,opts:{filename:s}}=cs.hub.file;let n=Rr.get(e);n||Rr.set(e,n=new Set);const o=(0,lt.getTemplateId)(r,s,`${e.id}/${t}`);let a=0,i=o;for(;n.has(i);)i=o+"_"+ ++a;return n.add(i),i}function zr(e){je(e.hoisted,(t=>{for(const r of t.hoists.values()){const s=[0===t.type?ct.types.stringLiteral(Gs(t)+">"):Zs(t)];let n=e;for(;n&&n!==r.section;){const e=n.parent;e&&s.push(Xs(n)),n=e}const o=Sr(r);cs.pushContainer("body",ct.types.variableDeclaration("const",[ct.types.variableDeclarator(o,r.downstreamExpressions.size?ge("register",ct.types.stringLiteral(Ur(r.section,r,"hoist")),ge("hoist",...s)):ge("hoist",...s))])),r.downstreamExpressions.size&&Fr(r.section,void 0,Ir(r),ct.types.callExpression(o,[ls]))}}));const t=[...pr(e).values()].sort(Vr);for(const r of t){cr(r,"render",Kr);for(const e of r.values)cr(e,"value",Kr);let t;if(r.effect.length){cr(r,"effect",Xr);const s=ct.types.identifier(`${r.identifier.name}_effect`),n=r.effectReferencedBindings,o=lr(r.effect,us);t=ct.types.variableDeclarator(s,ge("effect",ct.types.stringLiteral(Ur(e,r.referencedBindings)),ct.types.arrowFunctionExpression(n?o?[ls,Yt(e,n)]:[Yt(e,n)]:o?[ls]:[],nr(r.effect))))}let s=r.build();ct.types.isCallExpression(s)&&Or(s.arguments),r.register&&(s=ge("registerBoundSignal",ct.types.stringLiteral(Ur(e,r.referencedBindings,"var")),s));const n=ct.types.variableDeclarator(r.identifier,s);let o=e.parent||r.referencedBindings||!ct.types.isFunctionExpression(s)&&!ct.types.isArrowFunctionExpression(s)?ct.types.variableDeclaration("const",[n]):ct.types.functionDeclaration(r.identifier,s.params,ct.types.isExpression(s.body)?ct.types.blockStatement([ct.types.expressionStatement(s.body)]):s.body);r.export&&(o=ct.types.exportNamedDeclaration(o));const a=r.prependStatements||[];t&&a.push(ct.types.variableDeclaration("const",[t])),a.push(o),cs.pushContainer("body",a)}}function Wr(e){const t=rr(e);return"FunctionDeclaration"===t.type?[t,ct.types.returnStatement(t.id)]:[ct.types.returnStatement(t)]}function Vr(e,t){const r=qr(e),s=qr(t);for(let e=Math.max(r.length,s.length)-1;e>=0;e--){const t=(s[e]??-1)-(r[e]??-1);if(0!==t)return t}return 0}function qr({referencedBindings:e}){return e?Array.isArray(e)?e.map(Hr).sort():[Hr(e)]:[]}function Hr(e){return 1e4*(0===e.type?1:0)+e.id}function Jr(e,t){$r("effect",e,t,void 0,!1)}function Zr(e){const t=We(e);if(!t)return;const r=Array.from(pr(t).values()),s=qe(t),n=e=>{let r=t;for(;r!==e.section;){const e=br(r);r=r.parent,e.has("_")||e.set("_",ge("ensureScopeWithId",qe(r)))}};je(t.assignments,n),je(t.referencedHoists,n),je(t.referencedClosures,(e=>{if(ln(e)&&(n(e),gr(e.section),tt(t,e))){const r=Mr(e.section,e);let s=Ar.get(r);s||(Ar.set(r,s=cs.scope.generateUidIdentifier(r.identifier.name+"_closures")),kr(e.section).push(ct.types.variableDeclaration("const",[ct.types.variableDeclarator(s,ct.types.newExpression(ct.types.identifier("Set"),[]))])),hr(e.section,Gs(e)+"!",s)),hr(t,Gs(e)+"(",ct.types.numericLiteral(function(e,t){let r=0;return Ce(e.closureSections,(s=>s===t||(tt(s,e)&&r++,!1))),r}(e,t))),wr(t,(e=>ge("writeSubscribe",s,e)))}}));const o=new Set;je(t.hoisted,(e=>{for(const r of e.hoists.values()){r.downstreamExpressions.size&&kr(r.section).push(ct.types.variableDeclaration("const",[ct.types.variableDeclarator(ct.types.identifier(r.name),ge("hoist",qe(r.section),ct.types.stringLiteral(Ur(r.section,r,"hoist"))))]));let e=t;for(;e&&e!==r.section;){const t=e.parent;if(!e.sectionAccessor&&!o.has(e)){const r=cs.scope.generateUidIdentifier(`${e.name}_subscribers`);o.add(e),kr(t).push(ct.types.variableDeclaration("const",[ct.types.variableDeclarator(r,ct.types.newExpression(ct.types.identifier("Set"),[]))])),wr(e,(e=>ge("writeSubscribe",r,e))),hr(t,Ks(e),r)}e=t}}e.hoists.size&&0!==e.type&&hr(t,Gs(e),Kt(e))}));for(let n=r.length;n--;)if(r[n].effect.length){const o=r[n].referencedBindings;e.pushContainer("body",ct.types.expressionStatement(ge("writeEffect",s,ct.types.stringLiteral(Ur(t,o)))))}const a=br(t),i=[];je(t.bindings,(e=>{if(e.serialize&&0!==e.type){const t=Gs(e);a.delete(t),i.push(ue(t,Kt(e)))}}));for(const[e,t]of a)i.push(ue(e,t));const c=vr(t);if(c||i.length||mr(t)){for(const e of i)"Identifier"===e.key.type&&"Identifier"===e.value.type&&e.key.name===e.value.name&&(e.shorthand=!0);const r=[s,ct.types.objectExpression(i)];if(!$()){let s;je(t.bindings,(e=>{if(!e.serialize||0===e.type)return;let t=e,r="";for(;!t.loc&&!t.declared&&t.upstreamAlias;)void 0!==t.property&&(r=Y(t.property)+r),t=t.upstreamAlias;const n=t.loc&&ct.types.stringLiteral(`${t.loc.start.line}:${t.loc.start.column+1}`);(s||=[]).push(ue(Gs(e),t!==e?ct.types.arrayExpression(n?[ct.types.stringLiteral(t.name+r),n]:[ct.types.stringLiteral(t.name+r)]):n||ct.types.numericLiteral(0)))})),r.push(ct.types.stringLiteral(e.hub.file.opts.filenameRelative),t.loc&&null!=t.loc.start.line?ct.types.stringLiteral(`${t.loc.start.line}:${t.loc.start.column+1}`):ct.types.numericLiteral(0)),s&&r.push(ct.types.objectExpression(s))}e.pushContainer("body",ct.types.expressionStatement(c?c(ge("writeScope",...r)):ge("writeScope",...r)))}!t.isBranch&&(t.hasAbortSignal||t.referencedClosures||Ce(t.bindings,(e=>1===e.type)))&&e.pushContainer("body",ct.types.expressionStatement(ge("resumeClosestBranch",s)));const l=kr(t);(e.get("body").length||l.length)&&e.unshiftContainer("body",[ct.types.variableDeclaration("const",[ct.types.variableDeclarator(s,ge("nextScopeId"))]),...l]);const p=qt(t);void 0!==p&&e.pushContainer("body",ct.types.returnStatement(p))}function Gr(e){return pr(e).get(void 0)?.identifier}function Kr(e){return Qr(e)||Yr(e)||ts(e)}function Xr(e){return Qr(e)||Yr(e)}function Yr(e){switch(e.type){case"Identifier":case"MemberExpression":return Ys(e)}}function Qr(e){switch(e.type){case"UpdateExpression":{const{extra:t}=e.argument;if(an(t)){const{buildAssignment:r}=Mr(t.assignment.section,t.assignment);if(r){const s=r(t.section,ct.types.binaryExpression("++"===e.operator?"+":"-",e.argument,ct.types.numericLiteral(1)));return e.prefix?s:ct.types.sequenceExpression([s,e.argument])}}break}case"AssignmentExpression":switch(e.left.type){case"Identifier":{const{extra:t}=e.left;if(an(t)){const{buildAssignment:r}=Mr(t.assignment.section,t.assignment);if(r)return r(t.section,"="===e.operator?e.right:ct.types.binaryExpression(e.operator.slice(0,-1),e.left,e.right))}break}case"ArrayPattern":case"ObjectPattern":{let t,r;if(Zt(e.left,(e=>{const{extra:s}=e;if(an(s)){const n=Mr(s.assignment.section,s.assignment);n?.buildAssignment&&(e.name=cs.scope.generateUid(e.name),(t||=[]).push(ct.types.identifier(e.name)),(r||=[]).push(n.buildAssignment(s.section,ct.types.identifier(e.name))))}})),t&&r){const s=cs.scope.generateUid("result");return ct.types.callExpression(ct.types.arrowFunctionExpression([ct.types.identifier(s),...t],ct.types.sequenceExpression([ct.types.assignmentExpression("=",e.left,ct.types.identifier(s)),...r,ct.types.identifier(s)])),[e.right])}break}}}}var es=new WeakMap;function ts(e){switch(e.type){case"ClassMethod":{const t=rs(e);return t&&ct.types.classProperty(e.key,t)}case"ClassPrivateMethod":{const t=rs(e);return t&&ct.types.classPrivateProperty(e.key,t)}case"ObjectMethod":{const t=rs(e);return t&&ct.types.objectProperty(e.key,t)}case"ArrowFunctionExpression":case"FunctionExpression":return rs(e);case"FunctionDeclaration":{const t=rs(e);if(t)return ct.types.variableDeclaration("const",[ct.types.variableDeclarator(e.id,t)]);break}}}function rs(e){const{extra:t}=e;if(cn(t)){const r=cs.scope.generateUid(t.name),s=t.referencesScope,n=t.referencedBindingsInFunction;let o=es.get(cs.node);return o||es.set(cs.node,o=[]),o.push({id:r,node:e,registerId:t.registerId,section:t.section,referencesScope:s,referencedBindings:n}),s||n?ct.types.callExpression(ct.types.identifier(r),[ls]):ct.types.identifier(r)}}var ss={translate:{exit(e){Bt(e);const t=We(e),{walks:r,writes:s,setup:n}=zt(t),o=e.node.extra.domExports,a=nt.types.identifier(o.template),i=nt.types.identifier(o.walks),c=nt.types.identifier(o.setup),l=e.node.params[0].extra?.binding,p=l&&M(l)?Ir(l):void 0,d=function(e){const{filename:t}=e.opts,r=e.markoOpts.fileSystem,s=function(e){const t=e.lastIndexOf(at.default.sep)+1,r=e.indexOf(".",t);if(-1===r)return e.slice(t);const s=e.lastIndexOf("."),n=r-1;if("]"===e[n]){const o=e.lastIndexOf("[",n);if(o>t)return e.slice(t,o)+e.slice(r,s)}return e.slice(t,s)}(t),n=new RegExp(`^(${o=s,o.replace(it,"\\$&")}\\.${"index"===s?"|":""})style\\.\\w+$`);var o;for(const e of r.readdirSync(at.default.dirname(t)).sort())if(n.test(e))return`./${e}`}(e.hub.file);d&&(0,ot.importDefault)(e.hub.file,d),function(e){const{sections:t}=cs.node.extra;for(let r=t.length;r--;)e(t[r])}((r=>{if(r!==t){const t=r.params&&Ir(r.params),{walks:o,writes:a,setup:i}=zt(r),c=nt.types.identifier(r.name),l=r.referencedClosures?nt.types.arrowFunctionExpression([ls],nr((n=e=>{const t=Mr(r,e);return nt.types.expressionStatement(nt.types.callExpression(tt(r,e)?t.identifier:nt.types.memberExpression(t.identifier,nt.types.identifier("_")),[ls]))},(s=r.referencedClosures)?Array.isArray(s)?s.map(n):[n(s)]:[]))):void 0,p=He(r)?ge("createRenderer",...Or([a,o,i,t?.identifier,l])):ge(Ye(r)?"registerContent":"createContent",nt.types.stringLiteral(Ur(r,"renderer")),...Or([a,o,i,t?.identifier,l,r.hoisted||r.isHoistThrough?Xs(r):void 0]));zr(r),e.node.body.push(nt.types.variableDeclaration("const",[nt.types.variableDeclarator(c,p)]))}var s,n})),zr(t),function(){const e=es.get(cs.node),t=[];if(e){for(const r of e){let e;const s=r.referencedBindings?r.referencesScope?[ls,ct.types.assignmentPattern(Yt(r.section,r.referencedBindings),ls)]:[Yt(r.section,r.referencedBindings)]:r.referencesScope?[ls]:void 0;e=s?ct.types.functionDeclaration(ct.types.identifier(r.id),s,ct.types.blockStatement(Wr(r.node))):"FunctionDeclaration"===r.node.type&&r.node.id?.name===r.id?r.node:ct.types.functionDeclaration(ct.types.identifier(r.id),r.node.params,"BlockStatement"===r.node.body.type?r.node.body:ct.types.blockStatement([ct.types.returnStatement(r.node.body)]),r.node.generator,r.node.async),t.push(e)}for(const r of e)t.push(ct.types.expressionStatement(ge("register",ct.types.stringLiteral(r.registerId),ct.types.identifier(r.id))));for(const e of cs.pushContainer("body",t))e.skip()}}(),n||e.node.body.unshift(nt.types.exportNamedDeclaration(nt.types.variableDeclaration("const",[nt.types.variableDeclarator(c,nt.types.arrowFunctionExpression([],nt.types.blockStatement([])))]))),e.node.body.unshift(nt.types.exportNamedDeclaration(nt.types.variableDeclaration("const",[nt.types.variableDeclarator(a,s||nt.types.stringLiteral(""))])),nt.types.exportNamedDeclaration(nt.types.variableDeclaration("const",[nt.types.variableDeclarator(i,r||nt.types.stringLiteral(""))]))),e.node.body.push(nt.types.exportDefaultDeclaration(ge("createTemplate",nt.types.stringLiteral(e.hub.file.metadata.marko.id),a,i,c,p?.identifier)))}}},ns=r("../../browser-shims/compiler/index.js"),os=new WeakMap,as={translate:{exit(e){_t(e),Zr(e),cr(e.node,"body",is);const t=[];for(const s of e.get("body"))(r=s).isImportDeclaration()||r.isExportDeclaration()||r.isMarkoScriptlet({static:!0})?s.isMarkoScriptlet()&&(s.node.target&&"server"!==s.node.target?s.remove():s.replaceWithMultiple(s.node.body)):(t.push(s.node),s.remove());var r;const s=os.get(e),n=ns.types.arrowFunctionExpression([ns.types.identifier("input")],ns.types.blockStatement(t)),o=ns.types.exportDefaultDeclaration(ge("createTemplate",ns.types.stringLiteral(e.hub.file.metadata.marko.id),s?ns.types.identifier(s):n));e.pushContainer("body",s?[ns.types.variableDeclaration("const",[ns.types.variableDeclarator(ns.types.identifier(s),n)]),o]:o)}}};function is(e,t){return function(e){switch(e.type){case"Identifier":case"MemberExpression":{const{extra:t}=e;if(t&&!(t.read&&!t.read.binding.declared||t.binding&&!t.binding.declared))return Ys(e)}}}(e)||function(e,t){switch(e.type){case"ClassMethod":{const t=ds(e);return t&&ns.types.classProperty(e.key,t)}case"ClassPrivateMethod":{const t=ds(e);return t&&ns.types.classPrivateProperty(e.key,t)}case"ObjectMethod":{const t=ds(e);return t&&ns.types.objectProperty(e.key,t)}case"FunctionDeclaration":{const{extra:r}=e;if(cn(r)){let s=ps.get(t);s||ps.set(t,s=[]),s.push({id:e.id.name,registerId:r.registerId})}break}case"ArrowFunctionExpression":case"FunctionExpression":return ds(e);case"BlockStatement":case"MarkoScriptlet":!function(e){const t=ps.get(e);if(t)for(const{id:r,registerId:s}of t)e.push(ns.types.expressionStatement(ge("register",ns.types.identifier(r),ns.types.stringLiteral(s))))}(e.body)}}(e,t)}var cs,ls,ps=new WeakMap;function ds(e){const{extra:t}=e;if(cn(t))return ge("register",rr(e),ns.types.stringLiteral(t.registerId),(t.referencedBindingsInFunction||t.referencesScope)&&qe(t.section))}function us(e){return e===ls}var fs=new WeakMap,ms={migrate:{enter(e){fs.set(e,cs),e.node.params=[E.types.identifier("input")],cs=e},exit(){cs.scope.crawl(),cs=fs.get(cs)}},analyze:{enter(e){fs.set(e,cs),cs=e,_e(e),js(e,2);const t=e.node.params[0].extra?.binding;t&&(t.nullable=!1);const{scope:r}=e;(e.node.extra??={}).domExports={template:r.generateUid("template_"),walks:r.generateUid("walks_"),setup:r.generateUid("setup_"),input:void 0,closures:r.generateUid("closures_")}},exit(e){!function(){const e=Es(),t=Ws(),r=Vs(),s=$s();if(s.size)for(const[e,r]of s){const s=e.extra;let a=t.get(s),{isEffect:i}=s;for(const e of r){const r=e?.extra;if(on(r)){i||=r.isEffect;const e=t.get(r);e&&(o=e,a=(n=a)?o?Array.isArray(n)?n.concat(o):Array.isArray(o)?[n,...o]:[n,o]:n:o,t.delete(r))}}t.set(s,a),s.isEffect=i}var n,o;const a=new Map;for(const[e,r]of t)on(e)&&(e.referencedBindings=en(e,r,a),je(e.referencedBindings,(t=>{t.downstreamExpressions.add(e)})));for(const[e,t]of r)e.referencedBindingsInFunction=en(e,t,a),je(e.referencedBindingsInFunction,(e=>{e.serialize=!0}));for(const t of e)0===t.type||t.upstreamAlias||Qs(e,t);for(const t of e){const{name:e,section:r}=t;0!==t.type&&(_s(t),Ce(r.bindings,(({name:e})=>e===t.name))&&(t.name=cs.scope.generateUid(e))),r.bindings=zs.add(r.bindings,t);for(const{referencedBindings:e,isEffect:r,section:s}of t.downstreamExpressions)s!==t.section&&(t.closureSections=Re.add(t.closureSections,s),s.referencedClosures=zs.add(s.referencedClosures,t)),r&&je(e,(e=>{e.serialize=!0}))}Ge((e=>{const t=a.get(e);if(t)for(const e of t){const t=e.length;for(let r=0;r<t-1;r++)for(let s=r+1;s<t;s++){const t=e[r],n=e[s];t.serialize||Rs(t.sources,n.sources)||(t.serialize=!0),n.serialize||Rs(n.sources,t.sources)||(n.serialize=!0)}}je(e.referencedClosures,(t=>{if(!t.serialize){let r=!1;const s=t.section;let n=e;for(;n!==s&&!(r=!n.upstreamExpression||ln(n.upstreamExpression.referencedBindings));)n=n.parent;t.serialize=r}}))})),Ge((e=>{let t=0;const r=a.get(e)||[],{id:s,bindings:n}=e,o=({section:e})=>e.id===s;let i,c=0;for(je(function(e,t){if(e){if(Array.isArray(e)){const r=e.length;let s,n=0;for(;n<r;){let o=e[n++];if(t(o)){for(s=o;n<r;)if(o=e[n++],t(o)){for(s=[s,o];n<r;)o=e[n++],t(o)&&s.push(o);return s}return s}}return s}if(t(e))return e}}(n,o),((s,n)=>{for(s.id=(c=n)+t;t<r.length&&(i=r[t]).filter(o).at(-1)===s;)Us.set(i,{id:n+ ++t,scopeOffset:Fs(i,e)})}));t<r.length;)i=r[t],Us.set(i,{id:c+ ++t,scopeOffset:Fs(i,e)})})),s.clear(),t.clear(),r.clear()}();const t=e.node.extra,r=e.node.params[0].extra?.binding;r&&M(r)&&(t.domExports.input=ys(r)),cs=fs.get(cs)}},translate:{enter(e){if(fs.set(e,cs),cs=e,ls=N()?e.scope.generateUidIdentifier("scope"):null,N()&&e.scope.generateUidIdentifier("clean"),"hydrate"===O().output){const t=e.hub.file,r=new Set([(0,S.resolveRelativePath)(t,t.opts.filename)]);return P.visit(t,t,(function e(s){if(!r.has(s)){r.add(s);const n=(0,S.loadFileForImport)(t,s);n&&P.visit(n,t,(r=>e(function(e,t,r){return t===e?(0,S.resolveRelativePath)(t,r):(0,S.resolveRelativePath)(e,"."===r[0]?T.default.join(t.opts.filename,"..",r):r)}(t,n,r))))}})),e.node.body=P.build(t),void e.skip()}},exit(e){if(B()?as.translate.exit(e):ss.translate.exit(e),e.node.extra?.needsCompat){const t=he(),r=[void 0];for(const s of e.node.body)"ImportDeclaration"===s.type&&s.source.value===t?r[0]=s:r.push(s);r[0]??=E.types.importDeclaration([],E.types.stringLiteral(t)),e.node.body=r}cs=fs.get(cs)}}};function ys(e){const t={id:e.export??=cs.scope.generateUid(e.name+"_"),binding:e,props:void 0};if(!e.aliases.size&&!e.downstreamExpressions.size){t.props={};for(const[r,s]of e.propertyAliases)t.props[r]=ys(s)}return t}function gs(e){let t=e;do{t=t.parentPath}while(t&&!vs(t));return t}function bs(e){let t=e;for(;!vs(t.parentPath);)t=t.parentPath;return t}function hs(e){let t,r=e;if(!r.isProgram()){for(;!vs(r);){if(xs(r))t=r;else switch(r.type){case"CallExpression":case"NewExpression":t=void 0}r=r.parentPath}return t}}function vs(e){switch(e.type){case"MarkoTag":case"MarkoTagBody":case"MarkoAttribute":case"MarkoSpreadAttribute":case"MarkoPlaceholder":case"MarkoScriptlet":return!0;default:return!1}}function xs(e){switch(e.type){case"FunctionDeclaration":return!e.node.declare;case"FunctionExpression":case"ArrowFunctionExpression":case"ObjectMethod":return!0;default:return!1}}function ws(e){let t=e;for(;t;){const{parent:e,node:r}=t;switch(e.type){case"CallExpression":return e.callee===r;case"TSNonNullExpression":t=t.parentPath;break;default:return!1}}return!1}function As(e,t){return e.start=t.start,e.loc=t.loc,e.end=t.end,e}r("../../browser-shims/compiler/index.js");var ks=Symbol("hoist is invoked"),[Es]=Oe((()=>new Set)),[Ss,Ts]=Oe((()=>0));function Ms(e,t,r,s,n,o,a=null,i=!1){const c=Ss(),l={id:c,name:e,type:t,loc:a,section:r,property:o,declared:i,closureSections:void 0,excludeProperties:void 0,serialize:!1,sources:new Set,aliases:new Set,hoists:new Map,propertyAliases:new Map,upstreamAlias:s,upstreamExpression:n,downstreamExpressions:new Set,scopeOffset:void 0,export:void 0,nullable:!n?.confident||null==n.computed};if(o){i&&(s.nullable=!1);const e=s.propertyAliases.get(o);e?(l.property=void 0,l.upstreamAlias=e,e.aliases.add(l)):s.propertyAliases.set(o,l)}else s&&s.aliases.add(l);return Ts(c+1),Es().add(l),l}function Is(e,t,r,s){const n=e.node.var;if(n){const o=ze(e),a=Hs(r);r&&s&&(s.pruned=!0),Ns(n,t,e.scope,o,a,s,void 0)}}function js(e,t,r,s){const n=e.node.params;if(e.node.body.length&&n.length){r&&s&&(s.pruned=!0);const o=ze(e),a=Hs(r),i=a||((e.node.extra??={}).binding=Ms(cs.scope.generateUid("params_"),t,o,a,s,void 0));o.params=i;for(let r=0;r<n.length;r++)Ns(n[r],t,e.scope,o,i,s,r+"")}}function Cs(e,t){const r=t.section,s=ze(e),n=function(e,t){let r=e;for(t.depth<e.depth&&(r=t,t=e);r;){if(t===r||!t.parent)return r;(t=t.parent).depth<r.depth&&(r=r.parent)}throw new Error("No common section")}(s,r),o=e.node.extra??={};let a=t.hoists.get(n);if(!a){t.hoists.set(n,a=Ms(cs.scope.generateUid("hoisted_"+e.node.name),5,n,void 0,void 0,void 0,t.loc,!0)),r.hoisted=zs.add(r.hoisted,t);let s=r.parent;for(;s&&s!==n;)s.isHoistThrough=!0,s=s.parent}o.hoistedBinding=a,ws(e)?(o.read=rn(a,void 0),o.section=s,o[ks]=!0):Os(e,a),s.referencedHoists=zs.add(s.referencedHoists,a)}function Ps(e,t){const r=ze(e);Bs(e),Zt(e.node,(e=>{if(e.name===t.name){const s=e.extra??={};r.assignments=zs.add(r.assignments,t),s.assignment=t,s.section=r}}))}function Bs(e){const t=hs(e);t&&((t.node.extra??={}).referencesScope=!0)}function Ns(e,t,r,s,n,o,a){switch(e.type){case"Identifier":(e.extra??={}).binding=Ms(e.name,t,s,n,o,a,e.loc,!0),function(e){const{identifier:t,referencePaths:r,constantViolations:s}=e,n=t.extra.binding;for(const e of r){const t=ze(e);rt(n.section,t)?Os(e,n):Cs(e,n)}for(const e of s)if(e.isUpdateExpression())Ps(e.get("argument"),n);else if(e.isAssignmentExpression()&&(Ps(e.get("left"),n),"="!==e.node.operator)){const t=e.get("left");t.isIdentifier()&&Os(t,n)}}(r.getBinding(e.name));break;case"ObjectPattern":{const o=(a?n.propertyAliases.get(a):n)||((e.extra??={}).binding=Ms(cs.scope.generateUid("pattern_"),t,s,n,void 0,a,e.loc));for(const n of e.properties)if("RestElement"===n.type)Ns(n.argument,t,r,s,o,void 0,a);else{let e;if("Identifier"===n.key.type)e=n.key.name;else{if("StringLiteral"!==n.key.type)throw new Error("computed keys not supported in object pattern");e=n.key.value}Ns(n.value,t,r,s,o,void 0,e)}break}case"ArrayPattern":{const o=(a?n.propertyAliases.get(a):n)||((e.extra??={}).binding=Ms(cs.scope.generateUid("pattern_"),t,s,n,void 0,a,e.loc));let i=-1;for(const n of e.elements)i++,n&&("RestElement"===n.type?Ns(n.argument,t,r,s,o,void 0,a):Ns(n,t,r,s,o,void 0,`${i}`));break}case"AssignmentPattern":Ns(e.left,t,r,s,n,void 0,a)}}function Os(e,t){let r=e,s=t,n=t.name;for(;;){const{parent:e}=r;if(!k.types.isMemberExpression(e))break;const t=sn(e);if(void 0===t)break;if(s.propertyAliases.has(t))r=r.parentPath,s=s.propertyAliases.get(t),n=s.name;else{if(r.parentPath.parentPath.isCallExpression()&&!nn(t))break;r=r.parentPath,s=Ms(n+=`_${t.replace(/[^a-zA-Z0-9_$]/g,"_")}`,s.type,s.section,s,void 0,t)}}const o=hs(r),a=bs(o||r),{section:i}=function(e,t,r){const s=e.node.extra??={},n=Ws();return s.section=ze(e),n.set(s,Ie(n.get(s),{binding:t,node:r})),s}(a,s,r.node);if(o){const e=Vs(),t=o.node.extra??={};t.section=i,e.set(t,Ie(e.get(t),{binding:s,node:r.node}))}}var[$s]=Oe((()=>new Map));function Ds(e,t,r){(t.extra??={}).section=e,$s().set(t,r)}function Ls(e,t){const r=e.length,s=r-t.length;if(0!==s)return s;for(let s=0;s<r;s++){const r=zs.compare(e[s],t[s]);if(0!==r)return r}return 0}function Fs(e,t){let r;for(const s of e)if(s.section===t)for(const e of s.sources)e.scopeOffset&&(!r||r.id<e.scopeOffset.id)&&(r=e.scopeOffset);return r}var Us=new WeakMap;function Rs(e,t){for(const r of t)if(!e.has(r))return!1;return!0}function _s(e){const t=new Set,{sources:r}=e;!function e(s){if(4===s.type||3===s.type){let n,o=s;for(;n=o.upstreamAlias;)o=n;if(o.upstreamExpression){if(t.has(o))return;t.add(o),je(o.upstreamExpression.referencedBindings,e)}else 2===o.type?r.add(s):r.add(o)}else r.add(s)}(e)}var zs=new Me((function(e,t){return(e.section.id-t.section.id||e.type!==t.type&&(0===e.type||0===t.type))&&e.type-t.type||e.id-t.id})),[Ws]=Oe((()=>new Map)),[Vs]=Oe((()=>new Map));function qs(e){if(Array.isArray(e))for(const t of e)(t.extra??={}).pruned=!0;else(e.extra??={}).pruned=!0}function Hs(e){return e&&(e.property?e:e.upstreamAlias||e)}function Js(e,t=[]){if(e.arguments)for(const r of e.arguments)t.push(r);for(const r of e.attributes)t.push(r.value);for(const r of e.body.attributeTags?e.body.body:e.attributeTags)switch(r.type){case"MarkoTag":Js(r,t);break;case"MarkoScriptlet":for(const e of r.body)t.push(e)}return t}function Zs(e,t){return $()?k.types.numericLiteral(e.id):k.types.stringLiteral(e.name+(t||0===e.type?`/${e.id}`:""))}function Gs(e,t){return $()?e.id+"":e.name+(t||0===e.type?`/${e.id}`:"")}function Ks(e){return e.sectionAccessor?Gs(e.sectionAccessor.binding)+e.sectionAccessor.suffix:e.id+"!"}function Xs(e){const t=Ks(e);return t?"number"==typeof t?k.types.numericLiteral(t):k.types.stringLiteral(t):void 0}function Ys(e){const{extra:t}=e;if(!t)return;let r,{binding:s,read:n}=t;if(n&&(void 0===n.props?(s=n.binding,n=void 0):s=void 0),s)"Identifier"===e.type?5===s.type?r=e.extra?.[ks]?k.types.callExpression(Sr(s),[Qt(e.extra.section,s.section)]):k.types.identifier(Gs(s)):s.name!==e.name&&(e.name=s.name):r=k.types.identifier(s.name);else if(n&&(r=fe(k.types.identifier(n.binding.name),Array.isArray(n.props)?n.props[0]:n.props),Array.isArray(n.props)))for(let e=1;e<n.props.length;e++)r=fe(r,n.props[e]);return r&&As(r,e)}function Qs(e,t){let r=!t.downstreamExpressions.size;for(const s of t.aliases)Qs(e,s)?t.aliases.delete(s):r=!1;for(const[s,n]of t.propertyAliases)Qs(e,n)?t.propertyAliases.delete(s):r=!1;return r&&e.delete(t),r}function en(e,t,r){let s;if(Array.isArray(t))for(const e of t){let{binding:r}=e;if(e.node){const s=(e.node.extra??={}).read??=tn(t,r,void 0);({binding:r}=(e.node.extra??={}).read=s)}s=zs.add(s,r)}else t&&(t.node&&((t.node.extra??={}).read=rn(t.binding,void 0)),s=t.binding);if(Array.isArray(s)){const t=r.get(e.section)||[],n=Pe(Ls,t,s);n?s=n:r.set(e.section,Be(Ls,t,s))}return s}function tn(e,t,r){const{upstreamAlias:s}=t;if(s&&Array.isArray(e)){const o=(n=t).property??n.upstreamAlias?.property,a=void 0===o?r:Ie(r,o);for(const{binding:r}of e)if(r!==t){let t=s;for(;t;){if(r===t)return tn(e,t,a);t=t.upstreamAlias}}}var n;return rn(t,r)}function rn(e,t){return{binding:e,props:t}}function sn(e){switch(e.property.type){case"StringLiteral":return e.property.value;case"NumericLiteral":return""+e.property.value;case"Identifier":if(e.computed)return;return e.property.name}}function nn(e){return/^on[-A-Z][a-zA-Z0-9_$]|[a-zA-Z_$][a-zA-Z0-9_$]*Change$/.test(e)}function on(e){return!(!e||e.pruned||!e.section)}function an(e){return on(e)&&void 0!==e.assignment}function cn(e){return on(e)&&void 0!==e.registerId}function ln(e){if(e){if(!Array.isArray(e))return pn(e);for(const t of e)if(pn(t))return!0}return!1}function pn(e){switch(e.type){case 1:case 2:return!0;default:return e.upstreamAlias?pn(e.upstreamAlias):!e.upstreamExpression||ln(e.upstreamExpression.referencedBindings)}}var dn={analyze(e){(0,x.assertNoVar)(e),(0,x.assertNoArgs)(e),g(e),(0,x.assertNoAttributeTags)(e);const{node:t}=e,[r]=t.attributes;if(!r)throw e.get("name").buildCodeFrameError("The `await` tag requires a value.");if(t.attributes.length>1||!v.types.isMarkoAttribute(r)||"value"!==r.name)throw e.get("name").buildCodeFrameError("The `await` tag only supports the `value` attribute.");if(!t.body.body.length)throw e.get("name").buildCodeFrameError("The `await` tag requires body content.");if(t.body.params.length&&(t.body.params.length>1||v.types.isSpreadElement(t.body.params[0])))throw e.get("name").buildCodeFrameError("The `await` tag only supports a single parameter.");ze(e),js(e.get("body"),4,void 0,A(r.value))},translate:vt({html:{enter(e){const t=We(e.get("body"));t?(Je(t,!0),Rt(e)):e.remove()},exit(e){const{node:t}=e,[r]=t.attributes,s=e.get("body"),n=We(s);(ln(r.extra?.referencedBindings)||Qe(n,!0))&&gr(n),_t(e),Zr(s),e.replaceWith(v.types.expressionStatement(ge("fork",r.value,v.types.arrowFunctionExpression(t.body.params,nr(t.body.body)))))[0].skip()}},dom:{enter(e){const t=We(e.get("body"));t?Je(t,!0):e.remove()},exit(e){e.remove()}}}),attributes:{},autocomplete:[{description:"Use to consume asynchronous an data.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#await"}],types:f.name+"/tag-types/await.d.marko"},un=r("../../browser-shims/compiler/index.js"),fn=r("../../browser-shims/compiler/babel-utils.js"),mn={parse(e){const{node:t,hub:{file:r}}=e,s=t.rawValue,n=s.replace(/^client\s*/,"").trim(),o=t.name.start+(s.length-n.length);let a=(0,fn.parseStatements)(r,n,o,o+n.length);1===a.length&&un.types.isBlockStatement(a[0])&&(a=a[0].body),e.replaceWith(un.types.markoScriptlet(a,!0,"client"))},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:"client <statement>",description:"A JavaScript statement which is only evaluated once your template is loaded on the client.",descriptionMoreURL:"https://markojs.com/docs/syntax/#client-javascript"}]},yn=r("../../browser-shims/compiler/index.js"),gn=r("../../browser-shims/compiler/babel-utils.js"),bn=r("../../browser-shims/compiler/index.js");function hn(e,t,r="const"){const{node:{var:s}}=e;s&&e.insertBefore(bn.types.variableDeclaration(r,[bn.types.variableDeclarator(s,t)]))}var vn={analyze(e){(0,gn.assertNoArgs)(e),(0,gn.assertNoParams)(e),b(e);const{node:t}=e,[r]=t.attributes;if(!t.var)throw e.get("name").buildCodeFrameError("The `const` tag requires a tag variable.");if(!r)throw e.get("name").buildCodeFrameError("The `const` tag requires a value.");if(t.attributes.length>1||!yn.types.isMarkoAttribute(r)||!r.default&&"value"!==r.name)throw e.get("name").buildCodeFrameError("The `const` tag only supports the `value` attribute.");const s=yn.types.isIdentifier(r.value)?e.scope.getBinding(r.value.name)?.identifier.extra?.binding:void 0;Is(e,4,s,A(r.value))},translate:{exit(e){const{node:t}=e,[r]=t.attributes,{value:s}=r;if(N()){const r=Ve(e),n=t.var.extra?.binding;if(n&&!n.upstreamAlias){const e=Ir(n);Fr(r,s.extra?.referencedBindings,e,s)}}else hn(e,s);e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Use to create an constant binding.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#const"}],types:f.name+"/tag-types/const.d.marko"},xn=r("../../browser-shims/compiler/index.js"),wn=r("../../browser-shims/compiler/babel-utils.js"),An={analyze(e){const[t]=e.node.attributes;if((0,wn.assertNoVar)(e),(0,wn.assertNoArgs)(e),(0,wn.assertNoParams)(e),b(e),e.node.attributes.length>1||1===e.node.attributes.length&&(!xn.types.isMarkoAttribute(t)||!t.default&&"value"!==t.name))throw e.get("name").buildCodeFrameError("The `debug` tag only supports the `value` attribute.")},translate:{exit(e){const t=Ve(e),[r]=e.node.attributes,s=r?.value.extra?.referencedBindings,n=As(xn.types.debuggerStatement(),e.node);B()?e.insertBefore(n):$r("render",t,s,n),e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Debug on value change.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#debug"}],types:f.name+"/tag-types/debug.d.marko"},kn=(r("../../browser-shims/compiler/index.js"),r("../../browser-shims/compiler/babel-utils.js")),En=r("../../browser-shims/compiler/index.js"),Sn=r("../../browser-shims/compiler/babel-utils.js"),Tn=new WeakMap;function Mn(e){let t=Tn.get(e);return t||(t=cs.scope.generateUid(e.name),Tn.set(e,t)),En.types.identifier(t)}function In(e){if(e.node.extra?.attributeTags)return e.node.extra.attributeTags;const t=e.node.body.attributeTags?e.get("body").get("body"):e.get("attributeTags");if(!t.length)return;const r=(e.node.extra??={}).attributeTags={},s={},n=new Map;for(const e of t)if(e.isMarkoTag())if((0,Sn.isAttributeTag)(e)){const t=Ae(e);r[t]||=jn(t,[t]),(s[t]||=[]).push(e),In(e)}else{const t=(0,Sn.isLoopTag)(e);let o;for(const a of Cn(e,s)){const s=r[a];if(s)if(o){if(o!==s.group)for(const e of s.group)r[e].group=o,o.push(e)}else o=s.group;let i=r[a];i||(i=r[a]=jn(a,[]),o=i.group,o.push(a)),i.dynamic=!0,t&&(i.repeated=!0),n.set(e,a)}}for(const[e,t]of n)(e.node.extra??={}).attributeTagGroup=r[t].group;for(const e in s){const t=r[e];if(!t.repeated){const r=s[e];r.length>1&&(t.repeated=!t.dynamic||Pn(r))}}return r}function jn(e,t){return{name:e.slice(1),dynamic:!1,repeated:!1,group:t}}function Cn(e,t,r=new Set){const s=e.node.body.attributeTags?e.get("body").get("body"):e.get("attributeTags");for(const e of s)if(e.isMarkoTag())if((0,Sn.isAttributeTag)(e)){const s=Ae(e);r.add(s),(t[s]||=[]).push(e),In(e)}else Cn(e,t,r);return r}function Pn(e){let t;const r=new Set;for(const s of e){const e=ft(s);if(r.has(e)||!Te(e))return!0;const n=Bn(e);if(n&&n!==(t||=n))return!0;r.add(e)}return!1}function Bn(e){if("if"===Ae(e))return e;let t=e.getPrevSibling();for(;t.node;){if(t.isMarkoTag()&&"if"===Ae(t))return t;t=t.getPrevSibling()}}var Nn=r("../../browser-shims/compiler/index.js"),On=r("../../browser-shims/compiler/babel-utils.js"),$n=r("../../browser-shims/compiler/index.js"),Dn=r("../../browser-shims/compiler/babel-utils.js"),Ln=(r("../../browser-shims/compiler/index.js"),r("../../browser-shims/compiler/babel-utils.js")),Fn=r("../../browser-shims/compiler/index.js"),Un=r("../../browser-shims/compiler/babel-utils.js"),Rn=Symbol("native tag binding"),_n=Symbol("serialize marker"),zn=Symbol("node getter id"),Wn=new WeakMap;function Vn(e,t){switch(e){case"input":if(t.checked||t.checkedChange)return{special:!1,helper:"controllable_input_checked",attrs:[t.checked,t.checkedChange]};if(t.checkedValue||t.checkedValueChange)return{special:!0,helper:"controllable_input_checkedValue",attrs:[t.checkedValue,t.checkedValueChange,t.value]};if(t.value||t.valueChange)return{special:!1,helper:"controllable_input_value",attrs:[t.value,t.valueChange]};break;case"select":if(t.value||t.valueChange)return{special:!0,helper:"controllable_select_value",attrs:[t.value,t.valueChange]};break;case"textarea":if(t.value||t.valueChange)return{special:!0,helper:"controllable_textarea_value",attrs:[t.value,t.valueChange]};break;case"details":case"dialog":if(t.open||t.openChange)return{special:!1,helper:"controllable_detailsOrDialog_open",attrs:[t.open,t.openChange]}}}var qn={transform:{enter(e){if("textarea"===Ae(e)&&e.node.body.body.length){const t=[];for(const r of e.node.body.body){if(!("MarkoText"===r.type||"MarkoPlaceholder"===r.type&&r.escape))throw e.hub.file.hub.buildError(r,"Unexpected content in textarea, only text and placeholders are supported.",SyntaxError);t.push(r.value)}e.node.attributes.push(Fn.types.markoAttribute("value",At(t)||Hn())),e.node.body.body=[]}}},analyze:{enter(e){(0,Un.assertNoArgs)(e),(0,Un.assertNoParams)(e),(0,Un.assertNoAttributeTags)(e);const{node:t}=e;if(t.var&&!Fn.types.isIdentifier(t.var))throw e.get("var").buildCodeFrameError("Tag variables on native elements cannot be destructured.");const r=Ae(e),s=ze(e);let n=!1,o=!1;const a={},{attributes:i}=e.node;let c,l;for(let e=i.length;e--;){const t=i[e];if(Fn.types.isMarkoAttribute(t)){if(a[t.name]){qs(t.value);continue}a[t.name]=t,_(t.name)||(p=t.name,/^(?:value|checked(?:Value)?|open)Change/.test(p))?((t.value.extra??={}).isEffect=!0,n=!0):A(t.value).confident||(o=!0)}else Fn.types.isMarkoSpreadAttribute(t)&&(n=!0,o=!0,(t.value.extra??={}).isEffect=!0);l?l.push(t.value):Fn.types.isMarkoSpreadAttribute(t)&&(l=[t.value],c=Vn(r,a))}var p;if(function(e,t){const r=[t.open||t.openChange,t.checked||t.checkedChange,t.checkedValue||t.checkedValueChange,t.valueChange].filter(Boolean);if(r.length>1)throw e.get("name").buildCodeFrameError(`The attributes ${r.map((e=>`"${e.name}"`)).join(", ")} are mutually exclusive.`)}(e,a),l){if(c&&!c.attrs.every(Boolean)){for(const e of c.attrs)e&&l.push(e.value);c=void 0}Ds(s,e.node,l)}else c=Vn(r,a);if(c&&Ds(s,c.attrs.find(Boolean).value,c.attrs.map((e=>e?.value))),t.var||n||o){cs.node.extra.isInteractive||=n;const r="StringLiteral"===t.name.type?t.name.value:Fn.types.toIdentifier(e.get("name")),o=t.extra??={},a="#"+r;(n||t.var)&&(o[_n]=!0);const i=o[Rn]=Ms(a,0,s);if(t.var){const r=e.scope.getBinding(t.var.name);for(const e of r.referencePaths){const t=Ve(e);Bs(e),rt(s,t)?ws(e)||(o[zn]||=_r(s,a)):Cs(e,i)}}}}},translate:{enter(e){const t=Ae(e),r=e.node.extra,s=r[Rn],n=B(),o=e.get("name"),a=(0,Un.getTagDef)(e),i=Ft(e),c=Ve(e);if(n&&r.tagNameNullable&&Rt(e),e.has("var")){const t=e.node.var.name,o=e.scope.getBinding(t),a=r[zn];if(n){for(const e of o.referencePaths){const t=Ve(e);if(!e.node.extra?.hoist){let e=t;for(;e!==c&&e.parent;)hr(e,"_",ge("ensureScopeWithId",qe(e=e.parent)))}}gr(c),hn(e,ge("nodeRef",a&&qe(c),a&&Fn.types.stringLiteral(a)))}else{let r;a&&(r=cs.scope.generateUidIdentifier(`get_${t}`),cs.pushContainer("body",Fn.types.variableDeclaration("const",[Fn.types.variableDeclarator(r,ge("nodeRef",Fn.types.stringLiteral(a),Fn.types.stringLiteral(Zs(s).value+">")))])));for(const t of o.referencePaths)if(!t.node.extra?.hoistedBinding){const n=Ve(t);ws(t)?t.parentPath.replaceWith(Fn.types.expressionStatement(er(n,s))):r?t.replaceWith(Fn.types.callExpression(r,[Qt(n,Ve(e))])):t.replaceWith(Fn.types.expressionStatement(Fn.types.memberExpression(Qt(c,n),Fn.types.stringLiteral(Zs(s).value+">"),!0)))}}}let l;s&&(l=Zs(s),Bt(e,32)),i`<${o.node}`;const p=function(e,t){const r={},{attributes:s}=t,n=new Set;let o,a,i,c,l;for(let t=s.length;t--;){const o=s[t],{value:a}=o;if(Fn.types.isMarkoSpreadAttribute(o)){if(!i&&(i=[],l=Vn(e,r),l&&!l.attrs.every(Boolean))){for(const e of l.attrs)e&&(i.push(ue(e.name,e.value)),n.delete(e));l=void 0}i.push(Fn.types.spreadElement(a))}else r[o.name]||(r[o.name]=o,i?i.push(ue(o.name,o.value)):n.add(o))}if(i||(l=Vn(e,r),!1!==l?.special||l.attrs[1]||(l=void 0)),l)for(const e of l.attrs)e&&n.delete(e);const p=[...n].reverse();if(i){if(i.reverse(),l)for(const e of l.attrs)e&&(c||=[]).push(ue(e.name,Fn.types.numericLiteral(1)));for(const{name:e}of p)(c||=[]).push(ue(e,Fn.types.numericLiteral(1)));c&&(a=Fn.types.objectExpression(c)),o=oo(i)}return{staticAttrs:p,staticControllable:l,spreadExpression:o,skipExpression:a}}(t,e.node),{staticAttrs:d,staticControllable:u,skipExpression:f}=p;let m,{spreadExpression:y}=p;if(u){const{helper:e,attrs:r}=u,s=r.find(Boolean),o=s.value.extra?.referencedBindings,a=r.map((e=>e?.value));n?("select"!==t&&"textarea"!==t&&i`${ge(e,qe(c),l,...a)}`,Jr(c,void 0)):($r("render",c,o,Fn.types.expressionStatement(ge(e,ls,l,...a))),$r("effect",c,void 0,Fn.types.expressionStatement(ge(`${e}_effect`,ls,l))))}if(n)if("select"===t){if(u)Wn.set(e.node,{value:u.attrs[0]?.value||Hn(),valueChange:u.attrs[1]?.value||Hn()});else if(y){const t=e.scope.generateUidIdentifier("select_input");e.insertBefore(Fn.types.variableDeclaration("const",[Fn.types.variableDeclarator(t,y)])),Wn.set(e.node,{value:Fn.types.memberExpression(t,Fn.types.identifier("value")),valueChange:Fn.types.memberExpression(t,Fn.types.identifier("valueChange"))}),y=t}}else if("textarea"===t){let t,r;if(u)t=u.attrs[0]?.value,r=u.attrs[1]?.value;else if(y){const s=e.scope.generateUidIdentifier("textarea_input");e.insertBefore(Fn.types.variableDeclaration("const",[Fn.types.variableDeclarator(s,y)])),t=Fn.types.memberExpression(s,Fn.types.identifier("value")),r=Fn.types.memberExpression(s,Fn.types.identifier("valueChange")),y=s}(t||r)&&(m=ge("controllable_textarea_value",qe(Ve(e)),Zs(s),t,r))}for(const e of d){const{name:r,value:s}=e,{confident:o,computed:a}=s.extra||{},p=s.extra?.referencedBindings;if(n&&"option"===t&&"value"===r)i`${ge("optionValueAttr",s)}`;else switch(r){case"class":case"style":{const e=`${r}Attr`;o?i`${be()[e](a)}`:n?i`${ge(e,s)}`:$r("render",c,p,Fn.types.expressionStatement(ge(e,Fn.types.memberExpression(ls,l,!0),s)));break}default:o?i`${be().attr(r,a)}`:n?_(r)?Jr(c,p):i`${ge("attr",Fn.types.stringLiteral(r),s)}`:_(r)?$r("effect",c,p,Fn.types.expressionStatement(ge("on",Fn.types.memberExpression(ls,l,!0),Fn.types.stringLiteral(z(r)),s))):$r("render",c,p,Fn.types.expressionStatement(ge("attr",Fn.types.memberExpression(ls,l,!0),Fn.types.stringLiteral(r),s)))}}if(y&&(n?(Jr(c,r.referencedBindings),f?i`${ge("partialAttrs",y,f,l,qe(c),o.node)}`:i`${ge("attrs",y,l,qe(c),o.node)}`):($r("render",c,r.referencedBindings,f?Fn.types.expressionStatement(ge("partialAttrs",ls,l,y,f)):Fn.types.expressionStatement(ge("attrs",ls,l,y))),$r("effect",c,r.referencedBindings,Fn.types.expressionStatement(ge("attrsEvents",ls,l)),!1))),a&&a.parseOptions?.openTagOnly)switch(a.htmlType){case"svg":case"math":i`/>`;break;default:i`>`}else i`>`;n&&r.tagNameNullable&&e.insertBefore(Fn.types.ifStatement(o.node,Ut(e)))[0].skip(),m&&i`${m}`,jt(e)},exit(e){const t=e.node.extra,r=t[Rn],s=B(),n=(0,Un.getTagDef)(e)?.parseOptions?.openTagOnly,o=s&&Wn.get(e.node),a=Ae(e);s&&t.tagNameNullable&&_t(e),o?(Ft(e)`</${e.node.name}>`,_t(e),e.insertBefore(Fn.types.expressionStatement(ge("controllable_select_value",qe(Ve(e)),Zs(r),o.value,o.valueChange,Fn.types.arrowFunctionExpression([],Fn.types.blockStatement(e.node.body.body)))))):e.insertBefore(e.node.body.body).forEach((e=>e.skip()));const i=r&&(t[_n]||void 0===t[_n]&&(ln(t.referencedBindings)||e.node.attributes.some((e=>ln(e.value.extra?.referencedBindings)))));n||o||Ft(e,s&&!i&&("html"===a||"body"===a))`</${e.node.name}>`,s&&t.tagNameNullable&&e.insertBefore(Fn.types.ifStatement(e.node.name,Ut(e)))[0].skip(),i&&Wt(e,r),Ct(e),e.remove()}}};function Hn(){return Fn.types.unaryExpression("void",Fn.types.numericLiteral(0))}var Jn=Symbol("only child in parent"),Zn=Symbol("potential only child node ref");function Gn(e,t=1){const r=e.node.extra;if(void 0!==r[Jn])return r[Jn];const s=ft(e);return s&&(0,Ln.getTagDef)(s)?.html?r[Jn]=e.parent.body.length===t:r[Jn]=!1}function Kn(e,t,r=1){if(Gn(e,r)){const r=ft(e).node,s=r.name?.value;return(r.extra??={})[Rn]??=Ms("#"+s,0,t)}return(e.node.extra??={})[Zn]??=Ms("#text",0,t)}var Xn={analyze(e){const t=e.node.extra??={},r=e.node.body.attributeTags;let s;switch((0,Dn.assertNoVar)(e),(0,Dn.assertNoArgs)(e),g(e),Yn(e.node)){case"of":s=["of"];break;case"in":s=["in"];break;case"to":s=["to","from","step"];break;default:throw e.buildCodeFrameError("Invalid `for` tag, missing an `of=`, `in=`, `to=` attribute.")}if(r||s.push("by"),(0,Dn.assertAllowedAttributes)(e,s),r)return;const n=e.get("body"),o=_e(n);if(!o)return void qs(Js(e.node));const a=ze(e);js(n,3,void 0,t),Ds(a,e.node,Js(e.node)),o.sectionAccessor={binding:Kn(e,a),suffix:"("},o.upstreamExpression=t,o.isBranch=!0},translate:vt({html:{enter(e){if(e.node.body.attributeTags)return;const t=We(e.get("body"));t?(Je(t,!0),Gn(e)||(Bt(e,37),Pt(e)),Rt(e)):e.remove()},exit(e){if(e.node.body.attributeTags)return;const t=e.get("body"),r=Ve(e),s=We(t),{node:n}=e,o=ln(n.extra.referencedBindings),a=Gn(e),i=Kn(e,r),c=ut(n),l=Yn(n),p=n.body.params,d=[],u=n.body.body,f=Qe(s,!0),m=s.hoisted||s.isHoistThrough||s.referencedHoists,y=null===s.content||s.content.singleChild&&4!==s.content.startType;let g;if(o&&a&&(ft(e).node.extra[_n]=!1),o||f||m){const e={of:["list","index"],in:["key","value"],to:["value"]}[l],t="of"===l?1:0,n=c.by?e.length-1:t;gr(s);for(let t=0;t<=n;t++){const r=p[t];if(!r||!$n.types.isIdentifier(r)){const s=p[t]=cs.scope.generateUidIdentifier(e[t]);r&&u.unshift($n.types.variableDeclaration("let",[$n.types.variableDeclarator(r,s)]))}}if(c.by)if($n.types.isStringLiteral(c.by))g=fe(p[0],c.by.value);else if($n.types.isFunction(c.by)){const e=cs.scope.generateUidIdentifier("by");d.push($n.types.variableDeclaration("const",[$n.types.variableDeclarator(e,c.by)])),g=$n.types.callExpression(e,p)}else g=ge(function(e){switch(e){case"of":return"forOfBy";case"in":return"forInBy";case"to":return"forToBy"}}(l),c.by,...p);else g=p[t];const a=(e=>{const t=Ze(e);return"undefined"!==t.name||(t.name=cs.scope.generateUid(`scope${e.id}_`)),t})(s);kr(r).push($n.types.variableDeclaration("const",[$n.types.variableDeclarator(a,$n.types.newExpression($n.types.identifier("Map"),[]))])),(o||f||m)&&u.push($n.types.expressionStatement($n.types.callExpression($n.types.memberExpression(a,$n.types.identifier("set")),[g,ge("ensureScopeWithId",qe(s))]))),hr(r,Gs(i)+"(",$n.types.conditionalExpression($n.types.memberExpression(a,$n.types.identifier("size")),a,$n.types.identifier("undefined")))}_t(e),Zr(t);const b=eo(l,c),h=o?function(e,t){if(t)switch(e){case"of":return"resumeSingleNodeForOf";case"in":return"resumeSingleNodeForIn";case"to":return"resumeSingleNodeForTo"}else switch(e){case"of":return"resumeForOf";case"in":return"resumeForIn";case"to":return"resumeForTo"}}(l,y):Qn(l);b.push($n.types.arrowFunctionExpression(p,$n.types.blockStatement(u))),o&&(b.push(qe(r),Zs(i)),a&&b.push($n.types.numericLiteral(1))),d.push($n.types.expressionStatement(ge(h,...b)));for(const t of e.replaceWithMultiple(d))t.skip()}},dom:{enter(e){if(e.node.body.attributeTags)return;const t=We(e.get("body"));t?(Je(t,!0),Gn(e)||(Bt(e,37),Pt(e))):e.remove()},exit(e){if(e.node.body.attributeTags)return;const t=e.get("body"),r=Ve(e),s=We(t),{node:n}=e,o=n.extra,{referencedBindings:a}=o,i=Kn(e,r);fr(e,((e,t)=>ge("loopClosure",Zs(e),Zs(i),t)));const c=Yn(n),l=Mr(r,i,"for");l.build=()=>ge(function(e){switch(e){case"of":return"loopOf";case"in":return"loopIn";case"to":return"loopTo"}}(c),Zs(i),$n.types.identifier(s.name));const p=n.body.params;l.hasDownstreamIntersections=()=>{for(const e of p){const t=e.extra?.binding;if(t)for(const{referencedBindings:e}of t.downstreamExpressions)if(Mr(s,e).hasDownstreamIntersections())return!0}return!1};const d=ut(n),u=eo(c,d);d.by&&u.push(d.by),Fr(r,a,l,$n.types.arrayExpression(u)),e.remove()}}}),parseOptions:{controlFlow:!0},attributes:{of:{type:"expression",autocomplete:[{description:"Iterates over a list of items."}]},in:{type:"expression",autocomplete:[{description:"Iterates over the keys and values of an object."}]},to:{type:"number",autocomplete:[{description:"Iterates up to the provided number (inclusive)"}]},from:{type:"number",autocomplete:[{description:"Iterates starting from the provided number (inclusive)"}]},step:{type:"number",autocomplete:[{description:"The amount to increment during each interation (with from/to)"}]}},autocomplete:[{snippet:"for|${1:value, index}| of=${3:array}",description:"Use to iterate over lists, object properties, or between ranges.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#iterating-over-a-list"},{snippet:"for|${1:name, value}| in=${3:object}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#iterating-over-an-objects-properties"},{snippet:"for|${1:index}| to=${2:number}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#iterating-between-a-range-of-numbers"}]};function Yn(e){for(const t of e.attributes)if("MarkoAttribute"===t.type)switch(t.name){case"of":case"in":case"to":return t.name}}function Qn(e){switch(e){case"of":return"forOf";case"in":return"forIn";case"to":return"forTo"}}function eo(e,t){switch(e){case"in":return[t.in];case"of":return[t.of];case"to":return[t.to,t.from||$n.types.numericLiteral(0),t.step||$n.types.numericLiteral(1)]}}var to=new WeakSet;function ro(e,t,r=[],s="content"){const n=new Set,o=[],a=e.node.extra?.attributeTags;if(a){for(const e in a){const s=a[e];io(t,s.name)&&(n.add(s.name),s.dynamic&&(r.push(Nn.types.variableDeclaration("let",[Nn.types.variableDeclarator(Mn(s))])),o.push(ue(s.name,Mn(s)))))}const i=e.node.body.attributeTags?e.get("body").get("body"):e.get("attributeTags");for(let e=0;e<i.length;e++){const n=i[e];if(n.isMarkoTag())if((0,On.isAttributeTag)(n)){const c=a[Ae(n)];if(c.dynamic)e=no(i,e,a,r,t,s);else{const e=ro(n,t?.[c.name]?.props,r,s);if(c.repeated){const t=co(c.name,o);t?t.value=ge("attrTags",t.value,oo(e.properties)):o.push(ue(c.name,ge("attrTag",oo(e.properties))))}else o.push(ue(c.name,ge("attrTag",oo(e.properties))))}}else e=no(i,e,a,r,t,s)}}if(!n.has(s)&&io(t,s)){n.add(s);const t=function(e){const t=e.node.extra?.section;if(t){if(B()){const r=Ye(t);return ge(r?"registerContent":"createContent",Nn.types.stringLiteral(Ur(t,"renderer")),Nn.types.arrowFunctionExpression(e.node.params,Nn.types.blockStatement(e.node.body)),r?qe(Ve(function(e){let t=e;for(;(0,On.isAttributeTag)(t)||(0,On.isTransparentTag)(t);)t=ft(t);return t}(e.parentPath))):void 0)}return Nn.types.callExpression(Nn.types.identifier(t.name),[ls])}}(e.get("body"));if(t){const e=Nn.types.objectProperty(Nn.types.identifier(s),t);to.add(e),o.push(e)}}const{attributes:i}=e.node;for(let e=i.length;e--;){const r=i[e],{value:s}=r;Nn.types.isMarkoSpreadAttribute(r)?o.push(Nn.types.spreadElement(s)):!n.has(r.name)&&io(t,r.name)&&(n.add(r.name),o.push(ue(r.name,s)))}return o.reverse(),{properties:o,statements:r}}function so(e){for(const t of e)if(to.has(t))return t}function no(e,t,r,s,n,o="content"){const a=e[t];if(a.isMarkoTag())if((0,On.isAttributeTag)(a)){const e=r[Ae(a)];if(io(n,e.name)&&e.dynamic){const t=ro(a,n?.[e.name]?.props,s,o);e.repeated?s.push(Nn.types.expressionStatement(Nn.types.assignmentExpression("=",Mn(e),ge("attrTags",Mn(e),oo(t.properties))))):s.push(Nn.types.expressionStatement(Nn.types.assignmentExpression("=",Mn(e),ge("attrTag",oo(t.properties)))))}}else switch(Ae(a)){case"if":return function(e,t,r,s,n,o){const a=e[t],i=[];let c=Nn.types.ifStatement(lo(a),Nn.types.blockStatement(i));s.push(c),ao(a,r,i,n,o);let l=t+1;for(;l<e.length;){const t=e[l];if(t.isMarkoTag())switch(Ae(t)){case"else-if":case"else":{const e=lo(t),s=[];if(ao(t,r,s,n,o),e){c.alternate=c=Nn.types.ifStatement(e,Nn.types.blockStatement(s)),l++;continue}c.alternate=Nn.types.blockStatement(s);break}}break}return l-1}(e,t,r,s,n,o);case"for":return function(e,t,r,s,n,o){const a=e[t],i=[];return ao(a,r,i,n,o),s.push(function(e,t,r,s){return $n.types.expressionStatement(ge(Qn(e),...eo(e,t),$n.types.arrowFunctionExpression(r,$n.types.blockStatement(s))))}(Yn(a.node),ut(a.node),a.node.body.params,i)),t}(e,t,r,s,n,o)}return t}function oo(e){return 1===e.length&&Nn.types.isSpreadElement(e[0])?e[0].argument:Nn.types.objectExpression(e)}function ao(e,t,r,s,n){const o=e.node.body.attributeTags?e.get("body").get("body"):e.get("attributeTags");for(let e=0;e<o.length;e++)e=no(o,e,t,r,s,n)}function io(e,t){return!e||!!e[t]}function co(e,t){for(const r of t)if("ObjectProperty"===r.type)switch(r.key.type){case"StringLiteral":if(r.key.value===e)return r;break;case"Identifier":if(r.key.name===e)return r}return!1}function lo({node:{attributes:e}}){return 1===e.length?e[0].value:void 0}var po={analyze(e){if((0,kn.assertNoArgs)(e),!e.node.var)throw e.get("name").buildCodeFrameError("The `define` tag requires a tag variable.");const t=e.get("body"),r=_e(t);if(Is(e,4),r){const t=e.node.var?.extra?.binding;t&&(r.downstreamBinding=t.propertyAliases.get("content")||t)}js(t,3),In(e),Ds(ze(e),e.node,Js(e.node))},translate:{enter(e){B()&&Rt(e)},exit(e){const{node:t}=e,r=ro(e);if(B())_t(e),Zr(e.get("body")),e.insertBefore(r.statements),hn(e,oo(r.properties));else{const s=Ve(e),n=t.extra?.referencedBindings,o=Ir(e.get("var").node.extra.binding);r.statements.length&&$r("render",s,n,r.statements),Fr(s,n,o,oo(r.properties))}e.remove()}},attributes:{},autocomplete:[{description:"Use to create a constant object binding that can be rendered.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#define"}],types:f.name+"/tag-types/define.d.marko"},uo=r("../../browser-shims/compiler/index.js"),fo=r("../../browser-shims/compiler/babel-utils.js"),mo={migrate:[e=>{(0,fo.assertNoArgs)(e),(0,fo.assertNoParams)(e),b(e),(0,fo.assertNoAttributeTags)(e),g(e),(0,fo.assertAllowedAttributes)(e,["value"]),(0,fo.diagnosticDeprecate)(e,{label:"The 'effect' tag has been replaced by the 'script' tag.",fix(){const{node:t}=e;e.replaceWith(uo.types.markoTag(As(uo.types.stringLiteral("script"),t.name),t.attributes,t.body,t.arguments,t.var,t.attributeTags))}})}],attributes:{},types:f.name+"/tag-types/effect.d.marko"},yo=r("../../browser-shims/compiler/babel-utils.js"),go={parse(e){const{node:t}=e;e.replaceWith((0,yo.parseStatements)(e.hub.file,t.rawValue,t.start,t.end)[0])},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:"export <value>"}]},bo=r("../../browser-shims/compiler/index.js"),ho=r("../../browser-shims/compiler/babel-utils.js"),vo=Symbol("comment tag binding"),xo=Symbol("node getter id"),wo={analyze(e){(0,ho.assertNoArgs)(e),(0,ho.assertNoParams)(e),(0,ho.assertNoAttributes)(e);const t=e.node.var;let r=!1,s=!1;if(t){if(!bo.types.isIdentifier(t))throw e.get("var").buildCodeFrameError("The `html-comment` tag variable cannot be destructured.");r=!0;for(const r of e.scope.getBinding(t.name).referencePaths)if(!r.parentPath?.isCallExpression()){s=!0;break}}const n=[];for(const t of e.get("body").get("body"))if(t.isMarkoPlaceholder())n.push(t.node.value),r=!0;else if(!t.isMarkoText())throw t.buildCodeFrameError("Invalid child. Only text is allowed inside an html comment.");if(r){const t=ze(e),r=e.node.extra??={};s&&(r[xo]=_r(t,"comment")),r[vo]=Ms("#comment",0,t),Ds(t,e.node,n)}e.skip()},translate(e){const t=e.node.extra,r=t[vo];if(e.node.var){const s=t[xo];if(B())hn(e,ge("nodeRef",s&&qe(Ve(e)),s&&bo.types.stringLiteral(s)));else{const t=e.node.var.name,n=e.scope.getBinding(t).referencePaths;let o;s&&(o=cs.scope.generateUidIdentifier(`get_${t}`),cs.pushContainer("body",bo.types.variableDeclaration("const",[bo.types.variableDeclarator(o,ge("nodeRef",bo.types.stringLiteral(s),Zs(r)))])));for(const t of n){const s=Ve(t);t.parentPath?.isCallExpression()?t.parentPath.replaceWith(bo.types.expressionStatement(er(s,r))):o&&t.replaceWith(bo.types.callExpression(o,[Qt(s,Ve(e))]))}}}t[vo]&&Bt(e,32);const s=Ft(e);if(jt(e),s`<!--`,B())for(const t of e.node.body.body)bo.types.isMarkoText(t)?s`${t.value}`:bo.types.isMarkoPlaceholder(t)&&s`${ge("escapeXML",t.value)}`;else{const n=[],o=[];let a="";for(const t of e.node.body.body)bo.types.isMarkoText(t)?a+=t.value:bo.types.isMarkoPlaceholder(t)&&(n.push(bo.types.templateElement({raw:a})),o.push(t.value),a="");0===o.length?s`${a}`:(n.push(bo.types.templateElement({raw:a})),$r("render",Ve(e),t.referencedBindings,bo.types.expressionStatement(ge("data",bo.types.memberExpression(ls,Zs(r),!0),bo.types.templateLiteral(n,o)))))}Ct(e),s`-->`,r&&Wt(e,r),e.remove()},parseOptions:{text:!0},attributes:{},autocomplete:[{description:"Use to create an html comment that is not stripped from the output.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#html-comment"}]},Ao=r("../../browser-shims/compiler/index.js"),ko=r("../../browser-shims/compiler/babel-utils.js"),Eo=Symbol("node getter id"),So={analyze(e){(0,ko.assertNoArgs)(e),(0,ko.assertNoParams)(e);const{node:t}=e;if(t.var&&!Ao.types.isIdentifier(t.var))throw e.get("var").buildCodeFrameError("Tag variables on native elements cannot be destructured.");const r=ze(e);let s=!1,n=!1;const o={},{attributes:a}=e.node;let i;for(let e=a.length;e--;){const t=a[e];if(Ao.types.isMarkoAttribute(t)){if(o[t.name]){qs(t.value);continue}o[t.name]=t,_(t.name)?((t.value.extra??={}).isEffect=!0,s=!0):A(t.value).confident||(n=!0)}else Ao.types.isMarkoSpreadAttribute(t)&&(s=!0,n=!0,(t.value.extra??={}).isEffect=!0);i?i.push(t.value):Ao.types.isMarkoSpreadAttribute(t)&&(i=[t.value])}i&&Ds(r,e.node,i);const c=[];let l=!1;for(const t of e.node.body.body)if(Ao.types.isMarkoPlaceholder(t))c.push(t.value),l=!0;else if(!Ao.types.isMarkoText(t))throw e.hub.buildError(t,"Invalid child. Only text is allowed inside an html-script.");if(c.length>1&&Ds(r,c[0],c.slice(1)),t.var||s||n||l){cs.node.extra.isInteractive||=s;const n=t.extra??={},o="#script";if(n[_n]=s||!!t.var,n[Rn]=Ms(o,0,r),t.var)for(const s of e.scope.getBinding(t.var.name).referencePaths)if(!s.parentPath?.isCallExpression()){n[Eo]=_r(r,o);break}}},translate(e){const t=e.node.extra,r=t[Rn],s=B(),n=Ft(e),o=Ve(e);if(e.node.var){const n=t[Eo];if(s){const t=e.node.var.name,r=e.scope.getBinding(t).referencePaths;for(const e of r){let t=Ve(e);for(;t!==o&&t.parent;)hr(t,"_",ge("ensureScopeWithId",qe(t=t.parent)))}hn(e,ge("nodeRef",n&&qe(o),n&&Ao.types.stringLiteral(n)))}else{const t=e.node.var.name,s=e.scope.getBinding(t).referencePaths;let o;n&&(o=cs.scope.generateUidIdentifier(`get_${t}`),cs.pushContainer("body",Ao.types.variableDeclaration("const",[Ao.types.variableDeclarator(o,ge("nodeRef",Ao.types.stringLiteral(n),Zs(r)))])));for(const t of s){const s=Ve(t);t.parentPath?.isCallExpression()?t.parentPath.replaceWith(Ao.types.expressionStatement(er(s,r))):o&&t.replaceWith(Ao.types.callExpression(o,[Qt(s,Ve(e))]))}}}let a;r&&(a=Zs(r),Bt(e,32)),n`<script`;const i=function(e){const t={},{attributes:r}=e,s=new Set;let n,o,a,i;for(let e=r.length;e--;){const n=r[e],{value:o}=n;Ao.types.isMarkoSpreadAttribute(n)?(a||(a=[]),a.push(Ao.types.spreadElement(o))):t[n.name]||(t[n.name]=n,a?a.push(ue(n.name,n.value)):s.add(n))}const c=[...s].reverse();if(a){a.reverse();for(const{name:e}of c)(i||=[]).push(ue(e,Ao.types.numericLiteral(1)));i&&(o=Ao.types.objectExpression(i)),n=oo(a)}return{staticAttrs:c,spreadExpression:n,skipExpression:o}}(e.node),{staticAttrs:c,skipExpression:l,spreadExpression:p}=i;for(const e of c){const{name:t,value:r}=e,{confident:i,computed:c}=r.extra||{},l=r.extra?.referencedBindings;switch(t){case"class":case"style":{const e=`${t}Attr`;i?n`${be()[e](c)}`:s?n`${ge(e,r)}`:$r("render",o,l,Ao.types.expressionStatement(ge(e,Ao.types.memberExpression(ls,a,!0),r)));break}default:i?n`${be().attr(t,c)}`:s?_(t)?Jr(o,l):n`${ge("attr",Ao.types.stringLiteral(t),r)}`:_(t)?$r("effect",o,l,Ao.types.expressionStatement(ge("on",Ao.types.memberExpression(ls,a,!0),Ao.types.stringLiteral(z(t)),r))):$r("render",o,l,Ao.types.expressionStatement(ge("attr",Ao.types.memberExpression(ls,a,!0),Ao.types.stringLiteral(t),r)))}}if(p&&(s?(Jr(o,t.referencedBindings),l?n`${ge("partialAttrs",p,l,a,qe(o),Ao.types.stringLiteral("script"))}`:n`${ge("attrs",p,a,qe(o),Ao.types.stringLiteral("script"))}`):($r("render",o,t.referencedBindings,l?Ao.types.expressionStatement(ge("partialAttrs",ls,a,p,l)):Ao.types.expressionStatement(ge("attrs",ls,a,p))),$r("effect",o,t.referencedBindings,Ao.types.expressionStatement(ge("attrsEvents",ls,a)),!1))),n`>`,jt(e),B())for(const t of e.node.body.body)Ao.types.isMarkoText(t)?n`${t.value}`:Ao.types.isMarkoPlaceholder(t)&&n`${ge("escapeScript",t.value)}`;else{const t=[],r=[];let s,o="";for(const n of e.node.body.body)Ao.types.isMarkoText(n)?o+=n.value:Ao.types.isMarkoPlaceholder(n)&&(s||=n,t.push(Ao.types.templateElement({raw:o})),r.push(n.value),o="");s?(t.push(Ao.types.templateElement({raw:o})),$r("render",Ve(e),s.value.extra?.referencedBindings,Ao.types.expressionStatement(ge("textContent",Ao.types.memberExpression(ls,a,!0),Ao.types.templateLiteral(t,r))))):n`${o}`}n`</script>`,r&&Wt(e,r),Ct(e),e.remove()},"@async":"#html-async","@crossorigin":"#html-crossorigin","@defer":"#html-defer","@integrity":"#html-integrity","@nomodule":"#html-nomodule","@nonce":"#html-nonce","@referrerpolicy":"#html-referrerpolicy","@src":"#html-src","@type":"#html-type","attribute-groups":["html-attributes"],parseOptions:{text:!0,preserveWhitespace:!0}},To=r("../../browser-shims/compiler/index.js"),Mo=r("../../browser-shims/compiler/babel-utils.js"),Io=Symbol("node getter id"),jo={analyze(e){(0,Mo.assertNoArgs)(e),(0,Mo.assertNoParams)(e);const{node:t}=e;if(t.var&&!To.types.isIdentifier(t.var))throw e.get("var").buildCodeFrameError("Tag variables on native elements cannot be destructured.");const r=ze(e);let s=!1,n=!1;const o={},{attributes:a}=e.node;let i;for(let e=a.length;e--;){const t=a[e];if(To.types.isMarkoAttribute(t)){if(o[t.name]){qs(t.value);continue}o[t.name]=t,_(t.name)?((t.value.extra??={}).isEffect=!0,s=!0):A(t.value).confident||(n=!0)}else To.types.isMarkoSpreadAttribute(t)&&(s=!0,n=!0,(t.value.extra??={}).isEffect=!0);i?i.push(t.value):To.types.isMarkoSpreadAttribute(t)&&(i=[t.value])}i&&Ds(r,e.node,i);const c=[];let l=!1;for(const t of e.node.body.body)if(To.types.isMarkoPlaceholder(t))c.push(t.value),l=!0;else if(!To.types.isMarkoText(t))throw e.hub.buildError(t,"Invalid child. Only text is allowed inside an html-style.");if(c.length>1&&Ds(r,c[0],c.slice(1)),t.var||s||n||l){cs.node.extra.isInteractive||=s;const n=t.extra??={},o="#style";if(n[_n]=s||!!t.var,n[Rn]=Ms(o,0,r),t.var)for(const s of e.scope.getBinding(t.var.name).referencePaths)if(!s.parentPath?.isCallExpression()){n[Io]=_r(r,o);break}}},translate(e){const t=e.node.extra,r=t[Rn],s=B(),n=Ft(e),o=Ve(e);if(e.node.var){const n=t[Io];if(s){const t=e.node.var.name,r=e.scope.getBinding(t).referencePaths;for(const e of r){let t=Ve(e);for(;t!==o&&t.parent;)hr(t,"_",ge("ensureScopeWithId",qe(t=t.parent)))}hn(e,ge("nodeRef",n&&qe(o),n&&To.types.stringLiteral(n)))}else{const t=e.node.var.name,s=e.scope.getBinding(t).referencePaths;let o;n&&(o=cs.scope.generateUidIdentifier(`get_${t}`),cs.pushContainer("body",To.types.variableDeclaration("const",[To.types.variableDeclarator(o,ge("nodeRef",To.types.stringLiteral(n),Zs(r)))])));for(const t of s){const s=Ve(t);t.parentPath?.isCallExpression()?t.parentPath.replaceWith(To.types.expressionStatement(er(s,r))):o&&t.replaceWith(To.types.callExpression(o,[Qt(s,Ve(e))]))}}}let a;r&&(a=Zs(r),Bt(e,32)),n`<style`;const i=function(e){const t={},{attributes:r}=e,s=new Set;let n,o,a,i;for(let e=r.length;e--;){const n=r[e],{value:o}=n;To.types.isMarkoSpreadAttribute(n)?(a||(a=[]),a.push(To.types.spreadElement(o))):t[n.name]||(t[n.name]=n,a?a.push(ue(n.name,n.value)):s.add(n))}const c=[...s].reverse();if(a){a.reverse();for(const{name:e}of c)(i||=[]).push(ue(e,To.types.numericLiteral(1)));i&&(o=To.types.objectExpression(i)),n=oo(a)}return{staticAttrs:c,spreadExpression:n,skipExpression:o}}(e.node),{staticAttrs:c,skipExpression:l,spreadExpression:p}=i;for(const e of c){const{name:t,value:r}=e,{confident:i,computed:c}=r.extra||{},l=r.extra?.referencedBindings;switch(t){case"class":case"style":{const e=`${t}Attr`;i?n`${be()[e](c)}`:s?n`${ge(e,r)}`:$r("render",o,l,To.types.expressionStatement(ge(e,To.types.memberExpression(ls,a,!0),r)));break}default:i?n`${be().attr(t,c)}`:s?_(t)?Jr(o,l):n`${ge("attr",To.types.stringLiteral(t),r)}`:_(t)?$r("effect",o,l,To.types.expressionStatement(ge("on",To.types.memberExpression(ls,a,!0),To.types.stringLiteral(z(t)),r))):$r("render",o,l,To.types.expressionStatement(ge("attr",To.types.memberExpression(ls,a,!0),To.types.stringLiteral(t),r)))}}if(p&&(s?(Jr(o,t.referencedBindings),l?n`${ge("partialAttrs",p,l,a,qe(o),To.types.stringLiteral("style"))}`:n`${ge("attrs",p,a,qe(o),To.types.stringLiteral("style"))}`):($r("render",o,t.referencedBindings,l?To.types.expressionStatement(ge("partialAttrs",ls,a,p,l)):To.types.expressionStatement(ge("attrs",ls,a,p))),$r("effect",o,t.referencedBindings,To.types.expressionStatement(ge("attrsEvents",ls,a)),!1))),n`>`,jt(e),B())for(const t of e.node.body.body)To.types.isMarkoText(t)?n`${t.value}`:To.types.isMarkoPlaceholder(t)&&n`${ge("escapeStyle",t.value)}`;else{const t=[],r=[];let s,o="";for(const n of e.node.body.body)To.types.isMarkoText(n)?o+=n.value:To.types.isMarkoPlaceholder(n)&&(s||=n,t.push(To.types.templateElement({raw:o})),r.push(n.value),o="");s?(t.push(To.types.templateElement({raw:o})),$r("render",Ve(e),s.value.extra?.referencedBindings,To.types.expressionStatement(ge("textContent",To.types.memberExpression(ls,a,!0),To.types.templateLiteral(t,r))))):n`${o}`}n`</style>`,r&&Wt(e,r),Ct(e),e.remove()},"@disabled":"#html-disabled","@media":"#html-media","@nonce":"#html-nonce","@type":"#html-type","attribute-groups":["html-attributes"],parseOptions:{text:!0,preserveWhitespace:!0}},Co=r("../../browser-shims/compiler/index.js"),Po=r("../../browser-shims/compiler/babel-utils.js"),Bo={analyze(e){(0,Po.assertNoArgs)(e),(0,Po.assertNoParams)(e),(0,Po.assertNoAttributes)(e),b(e),(0,Po.assertNoAttributeTags)(e);const{node:t}=e;if(!t.var)throw e.get("name").buildCodeFrameError("The `id` tag requires a tag variable.");if(!Co.types.isIdentifier(t.var))throw e.get("var").buildCodeFrameError("The `id` tag cannot be destructured");Is(e,4)},translate:{exit(e){const{node:t}=e,r=B()?ge("nextTagId"):ge("nextTagId",ls);if(B())e.replaceWith(Co.types.variableDeclaration("const",[Co.types.variableDeclarator(t.var,r)]));else{const s=Ir(t.var.extra.binding);Fr(Ve(e),void 0,s,r),e.remove()}}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{displayText:"id/<name>",description:"Use to create a unique identifier.",snippet:"id/${1:name}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#id"}],types:f.name+"/tag-types/id.d.marko"},No=r("../../browser-shims/compiler/index.js"),Oo=r("../../browser-shims/compiler/babel-utils.js"),$o=r("../../browser-shims/compiler/index.js"),Do=new WeakMap,Lo={analyze(e){if(function(e){switch((0,Oo.assertNoVar)(e),(0,Oo.assertNoArgs)(e),(0,Oo.assertNoParams)(e),function(e){if(!e.node.body.body.length&&!e.node.attributeTags.length)throw e.get("name").buildCodeFrameError(`The \`${Ae(e)}\` tag requires body content.`)}(e),g(e),Ae(e)){case"if":_o(e);break;case"else-if":_o(e),Ro(e);break;case"else":!function(e){const{node:t}=e,[r]=t.attributes;if(t.attributes.length>1||r&&"if"!==r.name){const r=t.attributes[1].loc?.start,s=t.attributes[t.attributes.length-1].loc?.end,n=`The \`${Ae(e)}\` tag only supports an \`if=\` attribute.`;throw null==r||null==s?e.get("name").buildCodeFrameError(n):e.hub.buildError({loc:{start:r,end:s}},n,Error)}}(e),Ro(e)}}(e),e.node.body.attributeTags)return;const t=_e(e.get("body")),[r,s]=zo(e,t);if(r){const[r]=s[0],n=r.node.extra??={},o=[];let a=!0;for(const[e,t]of s)t&&(t.isBranch=!0,t.upstreamExpression=n,null===t.content||t.content?.singleChild&&4!==t.content.startType||(a=!1)),e.node.attributes.length&&o.push(e.node.attributes[0].value);const i=ze(e);Ds(i,r.node,o),t.sectionAccessor={binding:Kn(r,i,s.length),suffix:"!"},n.singleNodeOptimization=a}},translate:vt({html:{enter(e){if(e.node.body.attributeTags)return;const t=We(e.get("body"));Wo(e)&&!Gn(e)&&(Bt(e,37),Pt(e)),Rt(e),t&&Je(t,!0)},exit(e){if(e.node.body.attributeTags)return;const t=e.get("body"),r=Ve(e),s=We(t),[n,o]=zo(e,s),[a]=o[0],i=a.node.extra,c=ln(i.referencedBindings),l=i.singleNodeOptimization,p=s&&Qe(s,!0),d=s&&(s.hoisted||s.isHoistThrough||s.referencedHoists);if(s&&((c||p||d)&&gr(s),_t(e),Zr(t)),n){const t=Kn(a,r),s=Gn(a),n=e.getNextSibling(),i=a.scope.generateUidIdentifier("ifScopeId"),f=a.scope.generateUidIdentifier("ifBranch");let m;c&&s&&(ft(a).node.extra[_n]=!1);for(let e=o.length;e--;){const[t,r]=o[e],s=t.node.body.body;if(r){const t=Qe(r,!0),n=r.hoisted||r.isHoistThrough||r.referencedHoists;c&&s.push(No.types.expressionStatement(No.types.assignmentExpression("=",f,No.types.numericLiteral(e)))),(c||t||n)&&s.push(No.types.expressionStatement(No.types.assignmentExpression("=",i,qe(r))))}const[n]=t.node.attributes,a=(u=s,Array.isArray(u)?1===u.length?u[0]:$o.types.blockStatement(u):u);m=n?No.types.ifStatement(n.value,a,m):a,t.remove()}if(c||p||d){if(c){hr(r,Gs(t)+"(",f);const e=No.types.arrowFunctionExpression([],No.types.blockStatement([m]));m=No.types.expressionStatement(l?ge("resumeSingleNodeConditional",e,qe(r),Zs(t),s&&No.types.numericLiteral(1)):ge("resumeConditional",e,qe(r),Zs(t)))}n.insertBefore(m),kr(r).push(No.types.variableDeclaration("let",[No.types.variableDeclarator(i),c&&No.types.variableDeclarator(f)].filter(Boolean))),hr(r,Gs(t)+"!",ge("getScopeById",i))}else n.insertBefore(m)}var u}},dom:{enter(e){if(e.node.body.attributeTags)return;const t=We(e.get("body"));t&&Je(t,!0),Wo(e)&&!Gn(e)&&(Bt(e,37),Pt(e))},exit(e){if(e.node.body.attributeTags)return;const[t,r]=zo(e,We(e.get("body")));if(t){const[e]=r[0],t=Ve(e),s=r[0][0].node.extra,n=Kn(e,t),o=[];let a=No.types.numericLiteral(r.length);for(let e=r.length;e--;){const[t,s]=r[e],[i]=t.node.attributes,c=No.types.numericLiteral(s?e:-1);s&&(o.push(No.types.identifier(s.name)),fr(t,((t,r)=>ge("conditionalClosure",Zs(t),Zs(n),No.types.numericLiteral(e),r)))),t.remove(),a=i?No.types.conditionalExpression(i.value,c,a):c}const i=Mr(t,n,"if");i.build=()=>ge("conditional",Zs(n),...o.reverse()),Fr(t,s.referencedBindings,i,a)}}}}),parseOptions:{controlFlow:!0},autocomplete:[{snippet:"if=${1:condition}",description:"Use to display content only if the condition is met.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#if-else-if-else"}]},Fo={...Lo,autocomplete:[{snippet:"else-if=${1:condition}",description:"Use after an <if> or <else-if> tag to display content if those conditions do not match and this one does.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#if-else-if-else"}]},Uo={...Lo,autocomplete:[{description:"Use after an <if> or <else-if> tag to display content if those conditions do not match.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#if-else-if-else"}]};function Ro(e){let t=e.getPrevSibling();for(;t.node&&t.isMarkoComment();)t=t.getPrevSibling();if(!Te(t)||"else"!==Ae(t)&&!t.node.attributes.length)throw e.buildCodeFrameError(`The \`<${Ae(e)}>\` must have a preceding \`<if=cond>\`, \`<else-if=cond>\`, or \`<else if=cond>\`.`)}function _o(e){const{node:t}=e,[r]=t.attributes;if(!No.types.isMarkoAttribute(r)||!r.default)throw e.get("name").buildCodeFrameError(`The \`${Ae(e)}\` tag requires a value.`);if(t.attributes.length>1){const r=t.attributes[1].loc?.start,s=t.attributes[t.attributes.length-1].loc?.end,n=`The \`${Ae(e)}\` tag only supports the \`value\` attribute.`;throw null==r||null==s?e.get("name").buildCodeFrameError(n):e.hub.buildError({loc:{start:r,end:s}},n,Error)}}function zo(e,t){const r=Do.get(e)??[];let s=e.getNextSibling();for(;s.isMarkoComment();)s=s.getNextSibling();const n=!(Se(s,"else")||Se(s,"else-if"));return r.push([e,t]),n||Do.set(s,r),[n,r]}function Wo(e){return Se(e,"if")}var Vo=r("../../browser-shims/compiler/babel-utils.js"),qo={parse(e){const{node:t}=e;e.replaceWith((0,Vo.parseStatements)(e.hub.file,t.rawValue,t.start,t.end)[0])},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:'import <scope> from "<path>"',description:"Use to import external modules, follows the same syntax as JavaScript imports.",snippet:'import ${2} from "${1:path}"',descriptionMoreURL:"https://markojs.com/docs/syntax/#importing-external-files"}]},Ho=r("../../browser-shims/compiler/index.js"),Jo=r("../../browser-shims/compiler/babel-utils.js"),Zo={analyze(e){const{node:t}=e,r=t.var;let s,n;for(const r of t.attributes)if(Ho.types.isMarkoAttribute(r))if("value"===r.name)s=r;else{if("valueChange"!==r.name){const t=r.loc?.start,s=r.loc?.end,n="The `let` tag only supports the `value` attribute and its change handler.";throw null==t||null==s?e.get("name").buildCodeFrameError(n):e.hub.buildError({loc:{start:t,end:s}},n,Error)}n=r}if((0,Jo.assertNoArgs)(e),(0,Jo.assertNoParams)(e),b(e),g(e),!r)throw e.get("name").buildCodeFrameError("The `let` tag requires a tag variable.");if(!Ho.types.isIdentifier(r))throw e.get("var").buildCodeFrameError("The `let` tag variable cannot be destructured.");if(n&&(0,Jo.computeNode)(n.value))throw e.get("attributes").find((e=>e.node===n)).get("value").buildCodeFrameError("The `let` tag `valueChange` attribute must be a function.");Ds(ze(e),e.node,[s?.value,n?.value]),Is(e,1,void 0,e.node.extra)},translate:{exit(e){const{node:t}=e,r=t.var,s=t.attributes.find((e=>Ho.types.isMarkoAttribute(e)&&(e.default||"value"===e.name)))??Ho.types.markoAttribute("value",Ho.types.identifier("undefined")),n=t.attributes.find((e=>Ho.types.isMarkoAttribute(e)&&"valueChange"===e.name)),o=Ve(e),a=r.extra.binding;if(N()){const t=Ir(a,"state");Fr(o,e.node.extra.referencedBindings,t,s.value),n&&(t.extraArgs=[n.value]),t.buildAssignment=(e,r)=>{const s=Qt(e,t.section);return Ho.types.callExpression(t.identifier,[s,r])}}else hn(e,s.value,"let"),n&&hr(o,Gs(a)+"@",n.value);e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Use to create a mutable binding.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#let"}],types:f.name+"/tag-types/let.d.marko"},Go=r("../../browser-shims/compiler/index.js"),Ko=r("../../browser-shims/compiler/babel-utils.js"),Xo=Symbol("lifecycle attrs reference"),Yo={analyze(e){(0,Ko.assertNoArgs)(e),(0,Ko.assertNoVar)(e),(0,Ko.assertNoParams)(e),b(e);const{node:t}=e,r=t.extra??={},s=ze(e);if(r[Xo]=Ms(cs.scope.generateUid("lifecycle"),4,s,void 0,r),0===t.attributes.length)throw e.get("name").buildCodeFrameError("The `lifecycle` tag requires at least one attribute.");for(const r of t.attributes){if(Go.types.isMarkoSpreadAttribute(r))throw e.get("name").buildCodeFrameError("The `lifecycle` tag does not support `...spread` attributes.");(r.value.extra??={}).isEffect=!0}(cs.node.extra??={}).isInteractive=!0,Ds(s,e.node,Js(e.node))},translate:{exit(e){const{node:t}=e,r=Ve(e),s=t.extra,{referencedBindings:n}=s,o=s[Xo];if(N()){const t=ro(e);t.statements.push(Go.types.expressionStatement(ge("lifecycle",ls,Zs(o),oo(t.properties)))),$r("effect",r,n,t.statements)}else Jr(r,n);e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Use to create a side effects.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#effect"}],types:f.name+"/tag-types/lifecycle.d.marko"},Qo=r("../../browser-shims/compiler/index.js"),ea=r("../../browser-shims/compiler/babel-utils.js"),ta={analyze(e){const[t]=e.node.attributes;if((0,ea.assertNoArgs)(e),(0,ea.assertNoVar)(e),(0,ea.assertNoParams)(e),b(e),!t)throw e.get("name").buildCodeFrameError("The `log` tag requires a value.");if(e.node.attributes.length>1||!Qo.types.isMarkoAttribute(t)||!t.default&&"value"!==t.name)throw e.get("name").buildCodeFrameError("The `log` tag only supports the `value` attribute.")},translate:{exit(e){const t=Ve(e),[r]=e.node.attributes,{value:s}=r,n=s.extra?.referencedBindings,o=Qo.types.expressionStatement(Qo.types.callExpression(Qo.types.memberExpression(Qo.types.identifier("console"),Qo.types.identifier("log")),[s]));B()?e.insertBefore(o):$r("render",t,n,o),e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Use to log a value to the console.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#log"}],types:f.name+"/tag-types/log.d.marko"},ra=r("../../browser-shims/compiler/index.js"),sa=r("../../browser-shims/compiler/babel-utils.js"),na=" For a native html `script` tag use the `html-script` core tag instead.",oa={parse(e){const{node:t}=e,{body:r}=t.body;if(r.length){let s="";for(const t of r){if("MarkoText"!==t.type)throw e.hub.file.hub.buildError(t,"Unexpected content in `script` tag. Only javascript and typescript is supported."+na,SyntaxError);s+=t.value}const n=r[0]?.start,o=r[r.length-1]?.end,a=(0,sa.parseStatements)(e.hub.file,s,n,o),i=ra.types.arrowFunctionExpression([],ra.types.blockStatement(a),lr(a,aa));t.attributes.push(ra.types.markoAttribute("value",i)),t.body.body=[]}},analyze(e){const{node:t}=e;if((0,sa.assertNoArgs)(e),(0,sa.assertNoParams)(e),b(e),(0,sa.assertNoAttributeTags)(e),t.var)throw e.hub.buildError(t.var,"The `script` tag does not support a tag variable reference."+na);let r=!1;for(const s of t.attributes){if("MarkoAttribute"!==s.type||"value"!==s.name)throw e.hub.buildError(s,"The `script` tag does not support html attributes."+na);if(r)throw e.hub.buildError(s,"Invalid duplicate value attribute.");r=!0,(s.value.extra??={}).isEffect=!0,(cs.node.extra??={}).isInteractive=!0}r||qs(Js(t))},translate:{exit(e){const{node:t}=e,[r]=t.attributes;if(!r)return void e.remove();const s=Ve(e),{value:n}=r,o=n.extra?.referencedBindings;if(N()){const{value:e}=r,t=ra.types.isFunctionExpression(e)||ra.types.isArrowFunctionExpression(e);let n=null;if(t&&!e.async&&!e.generator)if(ra.types.isBlockStatement(e.body)){let t=!1;for(const r of e.body.body)if(ra.types.isDeclaration(r)){t=!0;break}n=t?e.body:e.body.body}else n=ra.types.expressionStatement(e.body);$r("effect",s,o,n||ra.types.expressionStatement(ra.types.callExpression(e,t?[]:[ls])))}else Jr(s,o);e.remove()}},html:!1,parseOptions:{text:!0,preserveWhitespace:!0},attributes:{},autocomplete:[{description:"Use to create a side effects.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#script"}],types:f.name+"/tag-types/script.d.marko"};function aa(e){switch(e.type){case"FunctionDeclaration":case"FunctionExpression":case"ArrowFunctionExpression":case"ClassMethod":case"ObjectMethod":case"ClassPrivateMethod":return ir;case"AwaitExpression":return!0;default:return!1}}var ia=r("../../browser-shims/compiler/index.js"),ca=r("../../browser-shims/compiler/babel-utils.js"),la={parse(e){const{node:t,hub:{file:r}}=e,s=t.rawValue,n=s.replace(/^server\s*/,"").trim(),o=t.name.start+(s.length-n.length);let a=(0,ca.parseStatements)(r,n,o,o+n.length);1===a.length&&ia.types.isBlockStatement(a[0])&&(a=a[0].body),e.replaceWith(ia.types.markoScriptlet(a,!0,"server"))},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:"server <statement>",description:"A JavaScript statement which is only evaluated once your template is loaded on the server.",descriptionMoreURL:"https://markojs.com/docs/syntax/#server-javascript"}]},pa=r("../../browser-shims/compiler/index.js"),da=r("../../browser-shims/compiler/babel-utils.js"),ua={parse(e){const{node:t,hub:{file:r}}=e,s=t.rawValue,n=s.replace(/^static\s*/,"").trim(),o=t.name.start+(s.length-n.length);let a=(0,da.parseStatements)(r,n,o,o+n.length);1===a.length&&pa.types.isBlockStatement(a[0])&&(a=a[0].body),e.replaceWith(pa.types.markoScriptlet(a,!0))},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:"static <statement>",description:"A JavaScript statement which is only evaluated once your template is loaded.",descriptionMoreURL:"https://markojs.com/docs/syntax/#static-javascript"}]},fa=r("../../browser-shims/compiler/index.js"),ma=r("../../browser-shims/compiler/babel-utils.js"),ya=d(r("../../node_modules/magic-string/dist/magic-string.cjs.js")),ga=d(r("../../node_modules/path-browserify/index.js")),ba=/^style((?:\.[a-zA-Z0-9$_-]+)+)?/,ha=" For a native html `style` tag use the `html-style` core tag instead.",va={analyze(e){(0,ma.assertNoArgs)(e),(0,ma.assertNoParams)(e),(0,ma.assertNoAttributeTags)(e);const{node:t}=e,r=ba.exec(t.rawValue||"")?.[1]?.slice(1);for(const s of t.attributes)if(null!=s.start||"MarkoAttribute"!==s.type||"class"!==s.name||"StringLiteral"!==s.value.type||s.value.value!==r)throw e.hub.buildError(s.value,"The `style` does not support html attributes."+ha);for(const r of t.body.body)if("MarkoText"!==r.type)throw e.hub.buildError(r,"The `style` tag currently only supports static content."+ha);if(t.body.body.length>1)throw e.hub.buildError(t.name,"The `style` tag currently only supports static content."+ha)},translate(e){const{node:t,hub:{file:r}}=e,{filename:s,sourceMaps:n}=r.opts;let o=ba.exec(t.rawValue||"")?.[1]||".css";t.var&&!/\.module\./.test(o)&&(o=".module"+o);const a=t.body.body[0],{resolveVirtualDependency:i}=O(),c=(0,ma.getStart)(r,a),l=(0,ma.getEnd)(r,a);let p,d=a.value;if(i&&n&&null!==c&&null!==l){const e=new ya.default(r.code,{filename:s});e.remove(0,c),e.remove(l,r.code.length),p=e.generateMap({source:s,includeContent:!0}),"inline"!==n&&"both"!==n||(d+=`\n/*# sourceMappingURL=${p.toUrl()}*/`,"inline"===n&&(p=void 0))}const u=i?.(s,{virtualPath:`./${ga.default.basename(s)+o}`,code:d,map:p});u&&(t.var?fa.types.isIdentifier(t.var)?cs.pushContainer("body",fa.types.importDeclaration([fa.types.importDefaultSpecifier(t.var)],fa.types.stringLiteral(u))):cs.pushContainer("body",fa.types.variableDeclaration("const",[fa.types.variableDeclarator(t.var,(0,ma.importDefault)(r,u,"style"))])):cs.pushContainer("body",fa.types.importDeclaration([],fa.types.stringLiteral(u)))),e.remove()},parseOptions:{html:!1,text:!0,rawOpenTag:!0,preserveWhitespace:!0},attributes:{}},xa=r("../../browser-shims/compiler/index.js"),wa=r("../../browser-shims/compiler/babel-utils.js"),Aa={analyze(e){(0,wa.assertNoVar)(e),(0,wa.assertNoArgs)(e),(0,wa.assertNoParams)(e),(0,wa.assertNoAttributes)(e),g(e),In(e);const{node:t}=e,r=ze(e);if(!t.body.body.length)throw e.get("name").buildCodeFrameError("The `try` tag requires body content.");Ds(r,e.node,Js(e.node))},translate:vt({html:{enter(e){We(e.get("body"))?(ka(e),Rt(e)):e.remove()},exit(e){const t=e.get("body"),r=ro(e);_t(e),Zr(t),e.insertBefore(r.statements),e.replaceWith(xa.types.expressionStatement(ge("tryContent",oo(r.properties))))[0].skip()}},dom:{enter(e){ka(e)},exit(e){e.remove()}}}),attributes:{},autocomplete:[{description:"Used to capture errors and display placeholders for nested content.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#try"}],types:f.name+"/tag-types/try.d.marko"};function ka(e){for(const t of e.get("attributeTags"))t.isMarkoTag()&&ka(t);const t=We(e.get("body"));t&&Je(t,!0)}var Ea={taglibId:f.taglibId,"<attrs>":h,"<await>":dn,"<client>":mn,"<const>":vn,"<debug>":An,"<define>":po,"<effect>":mo,"<else-if>":Fo,"<else>":Uo,"<export>":go,"<for>":Xn,"<html-comment>":wo,"<html-script>":So,"<html-style>":jo,"<id>":Bo,"<if>":Lo,"<import>":qo,"<let>":Zo,"<lifecycle>":Yo,"<log>":ta,"<return>":Jt,"<script>":oa,"<server>":la,"<static>":ua,"<style>":va,"<try>":Aa},Sa={translate:{enter(e){throw e.buildCodeFrameError("CDATA sections are not supported in Marko.")}}},Ta={translate:{exit(e){e.remove()}}},Ma={translate:{enter(e){throw e.buildCodeFrameError("XML declarations sections are not supported in Marko.")}}},Ia={translate:{exit(e){B()&&Ft(e)`<!${e.node.value}>`,e.remove()}}},ja=r("../../browser-shims/compiler/index.js"),Ca=r("../../browser-shims/compiler/babel-utils.js"),Pa=new WeakMap,Ba={analyze(e){if(e!==hs(e))return;const t=gs(e);if(t&&(t.isMarkoPlaceholder()||t.isMarkoScriptlet()&&"server"===t.node.target))return;if(Na(t)&&((0,Ca.isNativeTag)(t.parentPath)&&/^on[A-Z-]/.test(t.node.name)||Se(t.parentPath,"script")||Se(t.parentPath,"lifecycle")||Se(t.parentPath,"for")))return;const{node:r}=e,s=r.extra??={},n=s.name=e.node.id?.name||(Na(t)?t.node.default?ja.types.toIdentifier(t.parentPath.has("var")?t.parentPath.get("var"):t.parentPath.get("name")):t.node.name:ja.types.isVariableDeclarator(e.parent)&&ja.types.isIdentifier(e.parent.id)?e.parent.id.name:ja.types.isObjectMethod(r)&&ja.types.isIdentifier(r.key)?r.key.name:"anonymous"),{markoOpts:o,opts:{filename:a}}=cs.hub.file,i=Ve(e);let c=Pa.get(i);c||(c=new Map,Pa.set(i,c));const l=c.get(n);let p="";void 0===l?c.set(n,0):(c.set(n,l+1),p=`_${l}`),s.section=i,s.registerId=(0,Ca.getTemplateId)(o,a,`${i.id}/${n+p}`)}};function Na(e){return!!e&&e.isMarkoAttribute()}var Oa=r("../../browser-shims/compiler/babel-utils.js"),$a={analyze(e){const{node:t}=e,{source:r}=t,{value:s}=r,n=(0,Oa.resolveTagImport)(e,s);if(n){t.extra??={},t.extra.tagImport=n;const r=e.hub.file.metadata.marko.tags;r.includes(n)||r.push(n)}},translate:{exit(e){const{node:t}=e,{extra:r}=t,s=r?.tagImport;s&&(t.source.value=s)}}},Da=r("../../browser-shims/compiler/index.js"),La=Symbol("placeholder node binding"),Fa=Symbol("placeholder has sibling text"),Ua={analyze(e){const{node:t}=e,{confident:r,computed:s}=A(t.value);r&&(t.escape||Ra(s))||((t.extra??={})[La]=Ms("#text",0,ze(e),void 0,t.value.extra),function(e){const t=e.node.extra;let r=e.getPrevSibling();for(;r.node;){const e=Xe(r,"endType");if(null!==e){if(4===e||1===e||2===e)return t[Fa]=1;break}r=r.getPrevSibling()}if(!r.node&&Da.types.isProgram(e.parentPath))return t[Fa]=1;let s=e.getNextSibling();for(;s.node;){const e=Xe(s,"startType");if(null!==e){if(4===e||1===e||2===e)return t[Fa]=2;break}s=s.getNextSibling()}if(!s.node&&Da.types.isProgram(e.parentPath))return t[Fa]=2;t[Fa]=0}(e))},translate:{exit(e){const{node:t}=e,{value:r}=t,{confident:s,computed:n,referencedBindings:o}=A(r);if(s&&Ra(n))return void e.remove();const a=B(),i=Ft(e),c=t.extra||{},l=c[La],p=a||s&&t.escape,d=p?t.escape?"escapeXML":"toString":t.escape?"data":"html",u=ln(o),f=c[Fa];s&&p?i`${be()[d](n)}`:(1===f?(a&&u&&i`<!>`,Bt(e,37)):2===f?Bt(e,37):(a||i` `,Bt(e,32)),a?(i`${ge(d,r)}`,u&&Wt(e,l)):$r("render",Ve(e),r.extra?.referencedBindings,Da.types.expressionStatement("data"===d?ge("data",Da.types.memberExpression(ls,Zs(l),!0),r):ge("html",ls,r,Zs(l))))),Pt(e),e.remove()}}};function Ra(e){return null==e||!1===e}var _a=r("../../browser-shims/compiler/index.js"),za=new WeakMap,Wa={migrate(e){const{name:t}=e.node;if(!e.scope.hasBinding(t)&&"out"===t){if(!_a.types.isMemberExpression(e.parent)||!_a.types.isIdentifier(e.parent.property)||"global"!==e.parent.property.name)throw e.buildCodeFrameError("Only `out.global` is supported for compatibility.");e.parentPath.replaceWith(_a.types.identifier("$global"))}},analyze(e){const{name:t}=e.node;e.scope.hasBinding(t)||("$global"===t?Bs(e):"$signal"===t&&(ze(e).hasAbortSignal=!0,Bs(e)))},translate(e){const{name:t}=e.node;if(!e.scope.hasBinding(t))switch(t){case"$global":B()?e.replaceWith(_a.types.callExpression(ye("$global"),[])):e.replaceWith(_a.types.memberExpression(ls,_a.types.identifier("$global")));break;case"$signal":if(B())e.replaceWith(_a.types.callExpression(_a.types.arrowFunctionExpression([],_a.types.blockStatement([_a.types.throwStatement(_a.types.newExpression(_a.types.identifier("Error"),[_a.types.stringLiteral("Cannot use $signal in a server render.")]))])),[]));else{const t=Ve(e),r=bs(e);let s,n=za.get(t);n?s=n.get(r):(n=new Map,za.set(t,n)),s||(s=n.size,n.set(r,s),$r("render",t,r.node.extra?.referencedBindings,_a.types.expressionStatement(_a.types.callExpression(ye("resetAbortSignal"),[ls,_a.types.numericLiteral(s)])))),e.replaceWith(_a.types.callExpression(ye("getAbortSignal"),[ls,_a.types.numericLiteral(s)]))}}}},Va={analyze(e){if(!e.node.static)throw e.buildCodeFrameError("Scriptlets are not supported when using the tags api.");Ds(ze(e),e.node,e.node.body)},translate:{exit(e){const{node:t}=e,r=B();t.target&&t.target!==(r?"server":"client")?e.remove():r||(cr(t,"body",ts),e.replaceWithMultiple(t.body))}}},qa=r("../../browser-shims/compiler/index.js"),Ha=r("../../browser-shims/compiler/babel-utils.js"),Ja=(r("../../browser-shims/compiler/index.js"),r("../../browser-shims/compiler/babel-utils.js")),Za={analyze:{enter(e){(0,Ja.assertNoVar)(e),(0,Ja.assertNoArgs)(e);const t=e.get("body");if(_e(t),js(t,3),!(0,Ja.findParentTag)(e))throw e.get("name").buildCodeFrameError("@tags must be nested within another tag.")}},translate:{enter(e){B()&&Rt(e)},exit(e){B()&&(_t(e),Zr(e.get("body")))}}},Ga=r("../../browser-shims/compiler/index.js"),Ka=r("../../browser-shims/compiler/babel-utils.js"),Xa=d(r("../../node_modules/path-browserify/index.js")),Ya=Symbol("custom tag child scope"),Qa=Symbol("custom tag scope offset"),ei=Symbol("custom tag child attribute expressions"),ti={analyze:{enter(e){if((0,Ka.assertAttributesOrSingleArg)(e),In(e),!(0,Ka.getTagTemplate)(e)){const t=Ae(e);if(t&&e.scope.hasBinding(t))throw e.get("name").buildCodeFrameError(`Local variables must be in a dynamic tag unless they are PascalCase. Use \`<\${${t}}/>\` or rename to \`${t.charAt(0).toUpperCase()+t.slice(1)}\`.`);throw e.get("name").buildCodeFrameError("Unable to find entry point for custom tag.")}const t=ze(e),r=e.get("body"),s=e.node.extra??={};s[Ya]=Ms("#childScope",0,t,void 0,s),s[ei]=new Set([s]),e.has("var")&&(Is(e,4),e.node.var.extra.binding.scopeOffset=s[Qa]=Ms("#scopeOffset",0,t,void 0,s)),_e(r),js(r,3);const n=(0,Ka.loadFileForTag)(e);if(n.opts.filename===e.hub.file.opts.filename)Ds(t,e.node,Js(e.node));else{const r=n.ast.program.extra;si(s,t,e,r?.domExports.input),cs.node.extra.hasInteractiveChild=r?.isInteractive||r?.hasInteractiveChild||!1}}},translate:{enter(e){Bt(e),B()&&Rt(e)},exit(e){B()?function(e){const t=e.get("body"),{node:r}=e,s=r.extra;let n;if(_t(e),Zr(t),Ga.types.isStringLiteral(r.name)){const t=ri(e);n=ai(e.hub.file,t)?Ga.types.identifier(function(){let e=os.get(cs);return e||os.set(cs,e=cs.scope.generateUid("content")),e}()):(0,Ka.importDefault)(e.hub.file,t,Ae(e))}else n=r.name;const o=r.var,a=Ve(e),i=(0,Ka.loadFileForTag)(e)?.ast.program.extra?.domExports?.input,{properties:c,statements:l}=i?ro(e,i.props):{properties:[],statements:[]};let p=!1;for(const e of s[ei])if(on(e)&&ln(e.referencedBindings)){p=!0;break}if(p||o){const t=s[Ya],n=e.scope.generateUidIdentifier(t?.name);e.insertBefore(Ga.types.variableDeclaration("const",[Ga.types.variableDeclarator(n,ge("peekNextScope"))])),hr(a,Gs(t),ge("writeExistingScope",n)),o&&l.push(Ga.types.expressionStatement(ge("setTagVar",qe(a),Zs(e.node.extra[Qa]),n,Ga.types.stringLiteral(Ur(a,r.var.extra?.binding,"var")))))}if(r.extra.tagNameNullable){const t=so(c);let r;if(t){const s=t.value;t.value=r=e.scope.generateUidIdentifier("content");const[n]=e.insertBefore(Ga.types.variableDeclaration("const",[Ga.types.variableDeclarator(r,s)]));n.skip()}let s=ci(n,oo(c));o&&(hn(e,Ga.types.unaryExpression("void",Ga.types.numericLiteral(0)),"let"),s=Ga.types.assignmentExpression("=",o,s)),l.push(Ga.types.ifStatement(n,Ga.types.expressionStatement(s),r&&ii(r)))}else o?(hn(e,ci(n,oo(c))),gr(a)):l.push(ii(n,oo(c)));for(const t of e.replaceWithMultiple(l))t.skip()}(e):function(e){const t=Ve(e),{node:r}=e,s=r.extra[Ya],n=Ft(e),{file:o}=e.hub,a=Ga.types.isIdentifier(r.name)?r.name.name:Ga.types.isStringLiteral(r.name)?r.name.value:"tag",i=ri(e),c=(0,Ka.loadFileForTag)(e),l=c.ast.program.extra.domExports,p=oi(o,i,l.setup,a),d=l.input;if(d&&ni(e,d,`${Ae(e)||"tag"}_input`,{circular:c.opts.filename===o.opts.filename,tagSection:t,relativePath:i,childScopeBinding:s,attrTagCallsByTag:void 0}),n`${(0,Ka.importNamed)(o,i,l.template,`${a}_template`)}`,function(e,t){const r=St(Ve(e));Tt(Ve(e)).push(`${It[e.node.var?48:47]}`,t.name,It[38]),kt(r,String.fromCharCode(e.node.var?48:47)),r.push(t,String.fromCharCode(38))}(e,(0,Ka.importNamed)(o,i,l.walks,`${a}_walks`)),r.var){const e=Ir(r.var.extra.binding);e.register=!0,e.buildAssignment=(e,t)=>Ga.types.callExpression(ye("tagVarSignalChange"),[er(e,s),t]),$r("render",t,void 0,Ga.types.expressionStatement(ge("setTagVar",ls,Zs(s),e.identifier)))}$r("render",t,void 0,Ga.types.expressionStatement(Ga.types.callExpression(p,[er(t,s)]))),e.remove()}(e)}}};function ri(e){const{node:t,hub:{file:r}}=e;let s;if(Ga.types.isStringLiteral(t.name)){const t=(0,Ka.getTagTemplate)(e);s=t&&(0,Ka.resolveRelativePath)(r,t)}else t.extra?.tagNameImported&&(s=t.extra.tagNameImported);if(!s){const t=Ae(e);if(t&&e.scope.hasBinding(t))throw e.get("name").buildCodeFrameError(`Local variables must be in a dynamic tag unless they are PascalCase. Use \`<\${${t}}/>\` or rename to \`${t.charAt(0).toUpperCase()+t.slice(1)}\`.`);throw e.get("name").buildCodeFrameError("Unable to find entry point for custom tag.")}return s}function si(e,t,r,s){if(!s)return void qs(Js(r.node));if(!s.props||r.node.arguments?.length)return void Ds(t,r.node,Js(r.node));const n=We(r.get("body"));n&&(n.downstreamBinding=(s.props.content||s.props).binding);const o=In(r),a=new Set;if(o){const n=new Map,i=(e,t)=>{const r=Js(t.node),s=n.get(e);s?s.referenceNodes=s.referenceNodes.concat(r):n.set(e,{firstTag:t,referenceNodes:r})};for(const e in o)a.add(o[e].name);const c=r.node.body.attributeTags?r.get("body").get("body"):r.get("attributeTags");for(const r of c)if(r.isMarkoTag())if((0,Ka.isAttributeTag)(r)){const n=o[Ae(r)],a=s.props[n.name];a?a.props&&!n.dynamic?si(e,t,r,a):i(n.group,r):qs(Js(r.node))}else{const e=r.node.extra.attributeTagGroup;let t=!1;for(const r of e)if(s.props[o[r].name]){t=!0;break}t?i(e,r):qs(Js(r.node))}for(const{firstTag:{node:r},referenceNodes:s}of n.values())Ds(t,r,s),e[ei].add(r.extra)}const{attributes:i}=r.node;let c;for(let t=i.length;t--;){const r=i[t];if(Ga.types.isMarkoAttribute(r)){if(a.has(r.name)||!s.props[r.name]){qs(r.value);continue}a.add(r.name)}c?c.push(r.value):Ga.types.isMarkoSpreadAttribute(r)?c=[r.value]:e[ei].add(r.value.extra??={})}c&&Ds(t,r.node,c)}function ni(e,t,r,s){if(e.node.arguments?.length){const[n]=e.node.arguments,o=oi(e.hub.file,s.relativePath,t.id,r);return void Fr(s.tagSection,e.node.extra?.referencedBindings,li(o),Ga.types.isSpreadElement(n)?Ga.types.memberExpression(n.argument,Ga.types.numericLiteral(0),!0):n,er(s.tagSection,s.childScopeBinding))}if(!t.props||s.circular){const n=e.node.extra?.referencedBindings,o=oi(e.hub.file,s.relativePath,t.id,r),a=ro(e);a.statements.length&&$r("render",s.tagSection,n,a.statements);let i=oo(a.properties);if((0,Ka.isAttributeTag)(e)){const t=Ae(e),r=e.parentPath,n=In(r)?.[t]?.repeated;if(n){let e=(s.attrTagCallsByTag||=new Map).get(r);e||s.attrTagCallsByTag.set(r,e=new Map);const n=e.get(t);if(n)return void(n.expression=ge("attrTags",n.expression,i));e.set(t,i=Ga.types.parenthesizedExpression(ge("attrTag",i)))}else i=ge("attrTag",i)}return void Fr(s.tagSection,n,li(o),i,er(s.tagSection,s.childScopeBinding))}const n=new Set,o=In(e);if(o){const a=e.get("attributeTags"),i=new Map,c=(e,r)=>{const s=a[r];let n=i.get(e)?.statements;return n||(n=[],i.set(e,{referencedBindings:s.node.extra?.referencedBindings,statements:n})),no(a,r,o,n,t.props)};for(const e in o)n.add(o[e].name);for(let e=0;e<a.length;e++){const n=a[e];if(n.isMarkoTag())if((0,Ka.isAttributeTag)(n)){const a=o[Ae(n)],i=t.props[a.name];i&&(a.dynamic?e=c(a.group,e):ni(n,i,`${r}_${a.name}`,s))}else n.node.extra?.attributeTagGroup&&(e=c(n.node.extra.attributeTagGroup,e))}for(const[n,{referencedBindings:a,statements:c}]of i){const i=[];for(const c of n){const n=o[c],l=t.props[n.name];if(!l)continue;const p=oi(e.hub.file,s.relativePath,l.id,`${r}_${n.name}`);i.push(Ga.types.variableDeclarator(Mn(n))),Fr(s.tagSection,a,li(p),Mn(n),er(s.tagSection,s.childScopeBinding))}$r("render",s.tagSection,a,[Ga.types.variableDeclaration("let",i),...c])}}const a=e.node.body.extra?.section;if(a&&!n.has("content")&&(n.add("content"),t.props.content)){const n=(0,Ka.importNamed)(e.hub.file,s.relativePath,t.props.content.id,`${r}_content`);Fr(s.tagSection,void 0,li(n),Ga.types.callExpression(Ga.types.identifier(a.name),[ls]),er(s.tagSection,s.childScopeBinding))}const{attributes:i}=e.node,c=[];let l;for(let e=i.length;e--;){const r=i[e];if(Ga.types.isMarkoAttribute(r)){if(!t.props[r.name]||n.has(r.name))continue;if(n.add(r.name),l){l.push(ue(r.name,r.value));continue}c.push(r)}else l?l.push(Ga.types.spreadElement(r.value)):l=[Ga.types.spreadElement(r.value)]}for(const n of c.reverse()){const o=t.props[n.name],a=oi(e.hub.file,s.relativePath,o.id,`${r}_${n.name}`);Fr(s.tagSection,n.value.extra?.referencedBindings,li(a),n.value,er(s.tagSection,s.childScopeBinding))}const p=new Set(Object.keys(t.props));for(const e of n)p.delete(e);if(p.size){const n=e.node.extra?.referencedBindings;let o=pi;if(l){const t=e.scope.generateUidIdentifier(`${r}_spread`);l.reverse(),o=e=>fe(t,e),$r("render",s.tagSection,n,[Ga.types.variableDeclaration("const",[Ga.types.variableDeclarator(t,oo(l))])])}for(const a of p){const i=t.props[a],c=oi(e.hub.file,s.relativePath,i.id,`${r}_${a}`);Fr(s.tagSection,n,li(c),o(a),er(s.tagSection,s.childScopeBinding))}}}function oi(e,t,r,s){return ai(e,t)?Ga.types.identifier(r):(0,Ka.importNamed)(e,t,r,s)}function ai(e,t){const{filename:r}=e.opts;return t===r||"."===t[0]&&Xa.default.resolve(r,"..",t)===r}function ii(e,...t){return Ga.types.expressionStatement(ci(e,...t))}function ci(e,...t){return Ga.types.callExpression(e,t.filter(Boolean))}function li(e){return{identifier:e,hasDownstreamIntersections:di}}function pi(){return Ga.types.unaryExpression("void",Ga.types.numericLiteral(0))}function di(){return!0}var ui=r("../../browser-shims/compiler/index.js"),fi=r("../../browser-shims/compiler/babel-utils.js"),mi=Symbol("dynamic tag dom binding"),yi=Symbol("custom tag scope offset"),gi={analyze:{enter(e){(0,fi.assertAttributesOrArgs)(e),In(e);const t=ze(e),r=e.node.extra??={},s=e.get("body");r[mi]=Ms("#text",0,t,void 0,r),e.has("var")&&(Is(e,4),e.node.var.extra.binding.scopeOffset=r[yi]=Ms("#scopeOffset",0,t,void 0,r)),_e(s),js(s,3),Ds(t,e.node,[e.node.name,...Js(e.node)])}},translate:{enter(e){Bt(e,e.node.var?49:37),Pt(e),B()&&Rt(e)},exit(e){const{node:t}=e,r=t.extra,s=r[mi],n=Ve(e),o="class"===r.featureType,a=r.referencedBindings;let i=t.name;ui.types.isStringLiteral(i)&&(i=(0,fi.importDefault)(e.hub.file,ri(e),i.value)),o&&(B()?cs.pushContainer("body",ui.types.expressionStatement(ui.types.callExpression((0,fi.importNamed)(e.hub.file,he(),"s"),[ui.types.identifier(i.name),ui.types.stringLiteral((0,fi.loadFileForTag)(e).metadata.marko.id)]))):cs.pushContainer("body",ui.types.expressionStatement(ge("register",ui.types.stringLiteral((0,fi.loadFileForTag)(e).metadata.marko.id),ui.types.identifier(i.name)))));const{properties:c,statements:l}=ro(e,void 0,void 0,o?"renderBody":"content"),p=[];let d=!1;if(t.arguments?.length)p.push(...t.arguments),c.length?(d=!0,p.push(oo(c))):d=t.arguments.length>1||ui.types.isSpreadElement(t.arguments[0]);else{const e=so(c);e?(c.splice(c.indexOf(e),1),p.push(oo(c),e.value)):p.push(oo(c))}if(B()){_t(e),Zr(e.get("body")),t.var&&(d||1!==p.length||p.push(ui.types.unaryExpression("void",ui.types.numericLiteral(0))));const r=cs.scope.generateUidIdentifier("dynamicScope"),o=d?ge("dynamicTagArgs",qe(n),Zs(s),i,ui.types.arrayExpression(p)):ge("dynamicTagInput",qe(n),Zs(s),i,...p);l.push(ui.types.variableDeclaration("const",[ui.types.variableDeclarator(r,ge("peekNextScope"))])),t.var?l.push(ui.types.variableDeclaration("const",[ui.types.variableDeclarator(t.var,o)]),ui.types.expressionStatement(ge("setTagVar",qe(n),Zs(e.node.extra[yi]),r,ui.types.stringLiteral(Ur(n,t.var.extra?.binding,"var"))))):l.push(ui.types.expressionStatement(o)),hr(n,Gs(s)+"!",ge("writeExistingScope",r)),hr(n,Gs(s)+"(",ge("dynamicTagId",ui.types.isIdentifier(i)?ui.types.identifier(i.name):i));for(const t of e.replaceWithMultiple(l))t.skip()}else{const t=Ve(e),r=We(e.get("body")),n=Mr(t,s,"dynamicTag");let o;if(e.node.var&&(o=Ir(e.node.var.extra.binding),o.register=!0,o.buildAssignment=(e,t)=>ui.types.callExpression(ye("tagVarSignalChange"),[ui.types.memberExpression(Qt(o.section,e),ui.types.stringLiteral(Gs(s)+"!"),!0),t])),n.build=()=>ge("dynamicTag",Zs(s),r&&ui.types.identifier(r.name),o?ui.types.arrowFunctionExpression([],o.identifier):void 0,d&&ui.types.numericLiteral(1)),p.length){const e=d?ui.types.arrayExpression(p):p[0];ui.types.isObjectExpression(e)&&!e.properties.length||(n.extraArgs=[ui.types.arrowFunctionExpression([],l.length?ui.types.blockStatement(l.concat(ui.types.returnStatement(e))):e)])}n.hasDownstreamIntersections=()=>!0,Fr(t,a,n,i),e.remove()}}}},bi=/^[A-Z][a-zA-Z0-9_$]*$/,hi=new WeakMap,vi={transform:{enter(e){const{node:t}=e,{name:r,attributes:s}=e.node;let n=!1;if(qa.types.isStringLiteral(r)){const s=r.value;e.scope.getBinding(s)&&bi.test(s)&&(t.name=As(qa.types.identifier(s),r),n=!0)}for(let t=0;t<s.length;t++){const r=s[t];qa.types.isMarkoAttribute(r)&&r.bound&&(r.bound=!1,s.splice(++t,0,xi(e,r)),n=!0)}n&&e.scope.crawl()}},analyze:{enter(e){const t=(0,Ha.getTagDef)(e),r=Ue(e),s=t?.analyzer?.hook;if(s)yt(s,e);else if(0!==r)switch(r){case 1:ti.analyze.enter(e);break;case 3:Za.analyze.enter(e);break;case 2:gi.analyze.enter(e)}else qn.analyze.enter(e)},exit(e){const t=(0,Ha.getTagDef)(e)?.analyzer?.hook;t&&gt(t,e)}},translate:{enter(e){const t=(0,Ha.getTagDef)(e),r=e.node.extra;if(t?.translator)return t.translator.path&&e.hub.file.metadata.marko.watchFiles.push(t.translator.path),void yt(t.translator.hook,e);for(const t of e.get("attributes"))if(t.isMarkoAttribute()){if(t.node.arguments)throw t.buildCodeFrameError(`Unsupported arguments on the \`${t.node.name}\` attribute.`);if(t.node.modifier){if(!(0,Ha.isNativeTag)(t.parentPath))throw t.buildCodeFrameError(`Unsupported modifier \`${t.node.modifier}\`.`);t.node.name+=`:${t.node.modifier}`}}if(r.tagNameDynamic&&r.tagNameNullable&&!e.get("name").isIdentifier()&&B()){const t=e.scope.generateUidIdentifier("tagName"),[r]=e.insertBefore(qa.types.variableDeclaration("const",[qa.types.variableDeclarator(t,e.node.name)]));r.skip(),e.set("name",t)}switch(r.tagNameType){case 0:qn.translate.enter(e);break;case 1:ti.translate.enter(e);break;case 2:gi.translate.enter(e);break;case 3:Za.translate.enter(e)}},exit(e){const t=(0,Ha.getTagDef)(e)?.translator;if(t)gt(t.hook,e);else switch(e.node.extra.tagNameType){case 0:qn.translate.exit(e);break;case 1:ti.translate.exit(e);break;case 2:gi.translate.exit(e);break;case 3:Za.translate.exit(e)}}}};function xi(e,t){const r=t.name+"Change";if(qa.types.isIdentifier(t.value)){const s=e.scope.getBinding(t.value.name);if(!s)return qa.types.markoAttribute(r,wi(t.value));const n=hi.get(s.identifier);if(!n){const e=qa.types.markoAttribute(r,wi(t.value));return hi.set(s.identifier,e),e}if("Identifier"===n.type)return qa.types.markoAttribute(r,As(qa.types.identifier(n.name),t.value));const o=vs(s.path)?s.path:gs(s.path);if(!o?.isMarkoTag()&&!o?.isMarkoTagBody())throw e.hub.buildError(t.value,"Unable to bind to value.");const a=o.scope.generateUid(r),i=qa.types.markoTag(qa.types.stringLiteral("const"),[qa.types.markoAttribute("value",n.value,null,null,!0)],qa.types.markoTagBody([]),null,qa.types.identifier(a));return hi.set(s.identifier,n.value=qa.types.identifier(a)),o.isMarkoTag()?o.insertAfter(i):o.unshiftContainer("body",i),qa.types.markoAttribute(r,As(qa.types.identifier(a),t.value))}if(qa.types.isMemberExpression(t.value)){const e=t.value.property;if(!qa.types.isPrivateName(t.value.property))return qa.types.markoAttribute(r,qa.types.memberExpression(qa.types.cloneNode(t.value.object),"Identifier"===e.type?As(qa.types.identifier(e.name+"Change"),e):qa.types.binaryExpression("+",qa.types.cloneNode(e),qa.types.stringLiteral("Change")),"Identifier"!==e.type))}throw e.hub.buildError(t.value,"Attributes may only be bound to identifiers or member expressions")}function wi(e){const t="_new_"+e.name;return qa.types.arrowFunctionExpression([As(qa.types.identifier(t),e)],qa.types.blockStatement([qa.types.expressionStatement(qa.types.assignmentExpression("=",As(qa.types.identifier(e.name),e),As(qa.types.identifier(t),e)))]))}r("../../browser-shims/compiler/index.js");var Ai=function(e){const t={migrate:{},transform:{},analyze:{},translate:{}};for(const r in e){const s=r,n=e[s];n.migrate&&(t.migrate[s]=n.migrate),n.transform&&(t.transform[s]=n.transform),n.analyze&&(t.analyze[s]=n.analyze),n.translate&&(t.translate[s]=n.translate)}return t}({Program:ms,Function:Ba,ReferencedIdentifier:Wa,ImportDeclaration:$a,MarkoDocumentType:Ia,MarkoDeclaration:Ma,MarkoCDATA:Sa,MarkoText:{translate:{exit(e){Ft(e)`${e.node.value}`,Pt(e),e.remove()}}},MarkoTag:vi,MarkoPlaceholder:Ua,MarkoScriptlet:Va,MarkoComment:Ta}),ki=["tags"],Ei="tags",{transform:Si,analyze:Ti,translate:Mi}=Ai,Ii=[["../../node_modules/@marko/runtime-tags/dist/translator",{...Ea,migrate:Ai.migrate}]];function ji(e,t){return[`${f.name}${t?"":"/debug"}/${"html"===e?"html":"dom"}`]}},"../../node_modules/@marko/runtime-tags/package.json":e=>{e.exports=JSON.parse('{"name":"@marko/runtime-tags","version":"0.3.56","description":"Optimized runtime for Marko templates.","keywords":["api","marko","runtime","tags"],"homepage":"https://github.com/marko-js/marko","bugs":"https://github.com/marko-js/marko/issues","repository":{"type":"git","url":"git+https://github.com/marko-js/marko.git","directory":"packages/runtime-tags"},"license":"MIT","exports":{".":{"types":"./index.d.ts"},"./package.json":"./package.json","./translator":"./dist/translator/index.js","./tag-types/*":"./tag-types/*","./debug/*":{"types":"./dist/*.d.ts","import":"./dist/debug/*.mjs","default":"./dist/debug/*.js"},"./*":{"types":"./dist/*.d.ts","import":"./dist/*.mjs","default":"./dist/*.js"}},"types":"index.d.ts","files":["dist","tag-types","index.d.ts","tags-html.d.ts","!**/meta.*.json","!**/__tests__","!**/*.tsbuildinfo"],"scripts":{"build":"node -r ~ts ./scripts/bundle.ts"},"dependencies":{"@marko/compiler":"^5.39.13","csstype":"^3.1.3","magic-string":"^0.30.17"},"engines":{"node":"18 || 20 || >=22"},"exports:override":{".":{"types":"./index.d.ts"},"./translator":"./src/translator/index.ts","./tag-types/*":"./tag-types/*","./debug/*":"./src/*.ts","./*":"./src/*.ts"}}')}}]);
//# sourceMappingURL=420.d02970ed.js.map