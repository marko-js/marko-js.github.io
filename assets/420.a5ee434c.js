"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[420],{"../../node_modules/@marko/runtime-tags/dist/translator/index.js":(e,t,r)=>{var n,s=Object.create,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,l=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,p=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of i(t))c.call(e,s)||s===r||o(e,s,{get:()=>t[s],enumerable:!(n=a(t,s))||n.enumerable});return e},d=(e,t,r)=>(r=null!=e?s(l(e)):{},p(!t&&e&&e.__esModule?r:o(r,"default",{value:e,enumerable:!0}),e)),u={};((e,t)=>{for(var r in t)o(e,r,{get:t[r],enumerable:!0})})(u,{analyze:()=>Ya,getRuntimeEntryFiles:()=>ei,internalEntryBuilder:()=>P,preferAPI:()=>Ka,tagDiscoveryDirs:()=>Ga,taglibs:()=>Qa,transform:()=>Xa,translate:()=>Ha}),e.exports=(n=u,p(o({},"__esModule",{value:!0}),n));var f={name:r("../../node_modules/@marko/runtime-tags/package.json").name,taglibId:"marko-core"},m=r("../../browser-shims/compiler/index.js"),y=r("../../browser-shims/compiler/babel-utils.js");function g(e){for(const t of e.get("attributes"))if(t.isMarkoSpreadAttribute())throw t.buildCodeFrameError(`The \`${e.get("name").node.value}\` tag does not support \`...spread\` attributes.`)}function b(e){if(e.node.body.body.length)throw e.get("name").buildCodeFrameError(`The \`${e.get("name").node.value}\` tag does not support body content.`)}var h={migrate:[e=>{(0,y.assertNoArgs)(e),(0,y.assertNoParams)(e),(0,y.assertNoAttributes)(e),b(e),(0,y.assertNoAttributeTags)(e),(0,y.diagnosticDeprecate)(e,{label:"The `attrs` tag is deprecated, prefer destructuring `input` via the `const` tag.",fix(){const t=e.node.var;if(!t||"Identifier"===t.type&&"input"===t.name)e.remove();else{const r=m.types.markoTag(m.types.stringLiteral("const"),[m.types.markoAttribute("value",m.types.identifier("input"))],m.types.markoTagBody([]));r.var=t,e.replaceWith(r)}}})}],attributes:{},autocomplete:[{displayText:"attrs/{ ... }",description:"Use to receive the attributes passed into this template.",snippet:"attrs/{ $1 }$2"}]},v=r("../../browser-shims/compiler/index.js"),x=r("../../browser-shims/compiler/babel-utils.js"),w=r("../../browser-shims/compiler/babel-utils.js");function A(e){let{extra:t}=e;if(t||(t=e.extra={}),void 0===t.confident){const r=(0,w.computeNode)(e);r?(t.computed=r.value,t.confident=!0):(t.computed=void 0,t.confident=!1)}return t}var k=r("../../browser-shims/compiler/index.js"),E=r("../../browser-shims/compiler/index.js"),S=r("../../browser-shims/compiler/babel-utils.js"),T=d(r("../../node_modules/path-browserify/index.js"));function M(e){if(e.downstreamExpressions.size)return!0;for(const t of e.aliases)if(M(t))return!0;for(const t of e.propertyAliases.values())if(M(t))return!0;return!1}var I=r("../../browser-shims/compiler/index.js"),j=r("../../browser-shims/compiler/babel-utils.js"),C=Symbol(),P={build(e){const t=e[C];if(!t)throw e.path.buildCodeFrameError("Unable to build hydrate code, no files were visited before finalizing the build");const r=t.imports.map((e=>I.types.importDeclaration([],I.types.stringLiteral(e))));return t.init&&(r.unshift(I.types.importDeclaration([I.types.importSpecifier(I.types.identifier("init"),I.types.identifier("init"))],I.types.stringLiteral(`${f.name}/${e.markoOpts.optimize?"":"debug/"}dom`))),r.push(I.types.expressionStatement(I.types.callExpression(I.types.identifier("init"),[])))),r},visit(e,t,r){const n=t[C]||={imports:[],init:!1},{analyzedTags:s}=e.metadata.marko;n.imports.push((0,j.resolveRelativePath)(t,e.opts.filename)),n.init||=e.path.node.extra.hasInteractiveChild||e.path.node.extra.isInteractive||!1;for(const e of s||[])r(e)}};function B(){return"html"===$().output}function N(){return!B()}function $(){return Vr.hub.file.markoOpts}var D=r("../../browser-shims/compiler/index.js"),O=r("../../browser-shims/compiler/babel-utils.js");function F(e,t){return t?e:""}Symbol();var L=/^(--|ta|or|li|z)|n-c|i(do|nk|m|t)|w$|we/;function U(e,t){return t||0===t?`${e}:${"number"==typeof t&&t&&!L.test(e)?t+"px":t}`:""}function R(e,t,r){switch(typeof e){case"string":return e;case"object":if(null!==e){let n="",s="";if(Array.isArray(e))for(const o of e){const e=R(o,t,r);""!==e&&(n+=s+e,s=t)}else for(const o in e){const a=r(o,e[o]);""!==a&&(n+=s+a,s=t)}return n}}return""}function _(e){return/^on[A-Z-]/.test(e)}function z(e){return"-"===e[2]?e.slice(3):e.slice(2).toLowerCase()}function W(e){return e?e+"":0===e?"0":""}var V=/[<&]/g,q=e=>"&"===e?"&amp;":"&lt;";function J(e){return e?(t=e+"",V.test(t)?t.replace(V,q):t):0===e?"0":"&zwj;";var t}var Z=/<\/script/g;function G(e){return e?(t=e+"",Z.test(t)?t.replace(Z,"\\x3C/script"):t):0===e?"0":"";var t}var K=/<\/style/g;function X(e){return e?(t=e+"",K.test(t)?t.replace(K,"\\3C/style"):t):0===e?"0":"";var t}var{hasOwnProperty:Y}={};function H(e){return te("class",R(e," ",F))}function Q(e){return te("style",R(e,";",U))}function ee(e,t){return null==(r=t)||!1===r?"":function(e,t){switch(typeof t){case"string":return` ${e+re(t)}`;case"boolean":return` ${e}`;case"number":return` ${e}=${t}`;case"object":if(t instanceof RegExp)return` ${e+re(t.source)}`}return` ${e+re(t+"")}`}(e,t);var r}function te(e,t){return t&&` ${e}=${se(t)}`}function re(e){return e?`=${se(e)}`:""}(function*(){})().constructor,async function*(){}().constructor,(()=>{const e=new Map;for(const t of Object.getOwnPropertyNames(Symbol)){const r=Symbol[t];"symbol"==typeof r&&e.set(r,"Symbol."+t)}})(),new Map([[AggregateError,"AggregateError"],[Array,"Array"],[Array.from,"Array.from"],[Array.isArray,"Array.isArray"],[Array.of,"Array.of"],[ArrayBuffer,"ArrayBuffer"],[ArrayBuffer.isView,"ArrayBuffer.isView"],[Atomics.add,"Atomics.add"],[Atomics.and,"Atomics.and"],[Atomics.compareExchange,"Atomics.compareExchange"],[Atomics.exchange,"Atomics.exchange"],[Atomics.isLockFree,"Atomics.isLockFree"],[Atomics.load,"Atomics.load"],[Atomics.notify,"Atomics.notify"],[Atomics.or,"Atomics.or"],[Atomics.store,"Atomics.store"],[Atomics.sub,"Atomics.sub"],[Atomics.wait,"Atomics.wait"],[BigInt,"BigInt"],[BigInt.asIntN,"BigInt.asIntN"],[BigInt.asUintN,"BigInt.asUintN"],[BigInt64Array,"BigInt64Array"],[BigInt64Array.from,"BigInt64Array.from"],[BigInt64Array.of,"BigInt64Array.of"],[BigUint64Array,"BigUint64Array"],[BigUint64Array.from,"BigUint64Array.from"],[BigUint64Array.of,"BigUint64Array.of"],[Boolean,"Boolean"],[console.assert,"console.assert"],[console.clear,"console.clear"],[console.count,"console.count"],[console.countReset,"console.countReset"],[console.debug,"console.debug"],[console.dir,"console.dir"],[console.dirxml,"console.dirxml"],[console.error,"console.error"],[console.group,"console.group"],[console.groupCollapsed,"console.groupCollapsed"],[console.groupEnd,"console.groupEnd"],[console.info,"console.info"],[console.log,"console.log"],[console.table,"console.table"],[console.time,"console.time"],[console.timeEnd,"console.timeEnd"],[console.timeLog,"console.timeLog"],[console.timeStamp,"console.timeStamp"],[console.trace,"console.trace"],[console.warn,"console.warn"],[DataView,"DataView"],[Date,"Date"],[Date.now,"Date.now"],[Date.parse,"Date.parse"],[Date.UTC,"Date.UTC"],[decodeURI,"decodeURI"],[decodeURIComponent,"decodeURIComponent"],[encodeURI,"encodeURI"],[encodeURIComponent,"encodeURIComponent"],[Error,"Error"],[EvalError,"EvalError"],[Float32Array,"Float32Array"],[Float32Array.from,"Float32Array.from"],[Float32Array.of,"Float32Array.of"],[Float64Array,"Float64Array"],[Float64Array.from,"Float64Array.from"],[Float64Array.of,"Float64Array.of"],[Function,"Function"],[globalThis.atob,"atob"],[globalThis.btoa,"btoa"],[globalThis.clearImmediate,"clearImmediate"],[globalThis.clearInterval,"clearInterval"],[globalThis.clearTimeout,"clearTimeout"],[globalThis.crypto?.getRandomValues,"crypto.getRandomValues"],[globalThis.crypto?.randomUUID,"crypto.randomUUID"],[globalThis.fetch,"fetch"],[globalThis.performance?.now,"performance.now"],[globalThis.queueMicrotask,"queueMicrotask"],[globalThis.setImmediate,"setImmediate"],[globalThis.setInterval,"setInterval"],[globalThis.setTimeout,"setTimeout"],[globalThis.structuredClone,"structuredClone"],[globalThis.URL,"URL"],[globalThis.URLSearchParams,"URLSearchParams"],[globalThis.WritableStream,"WritableStream"],[Int16Array,"Int16Array"],[Int16Array.from,"Int16Array.from"],[Int16Array.of,"Int16Array.of"],[Int32Array,"Int32Array"],[Int32Array.from,"Int32Array.from"],[Int32Array.of,"Int32Array.of"],[Int8Array,"Int8Array"],[Int8Array.from,"Int8Array.from"],[Int8Array.of,"Int8Array.of"],[Intl.Collator,"Intl.Collator"],[Intl.DateTimeFormat,"Intl.DateTimeFormat"],[Intl.DisplayNames,"Intl.DisplayNames"],[Intl.getCanonicalLocales,"Intl.getCanonicalLocales"],[Intl.ListFormat,"Intl.ListFormat"],[Intl.Locale,"Intl.Locale"],[Intl.NumberFormat,"Intl.NumberFormat"],[Intl.PluralRules,"Intl.PluralRules"],[Intl.RelativeTimeFormat,"Intl.RelativeTimeFormat"],[Intl.Segmenter,"Intl.Segmenter"],[Intl.supportedValuesOf,"Intl.supportedValuesOf"],[isFinite,"isFinite"],[isNaN,"isNaN"],[JSON.parse,"JSON.parse"],[JSON.stringify,"JSON.stringify"],[Map,"Map"],[Map.groupBy,"Map.groupBy"],[Math.abs,"Math.abs"],[Math.acos,"Math.acos"],[Math.acosh,"Math.acosh"],[Math.asin,"Math.asin"],[Math.asinh,"Math.asinh"],[Math.atan,"Math.atan"],[Math.atan2,"Math.atan2"],[Math.atanh,"Math.atanh"],[Math.cbrt,"Math.cbrt"],[Math.ceil,"Math.ceil"],[Math.clz32,"Math.clz32"],[Math.cos,"Math.cos"],[Math.cosh,"Math.cosh"],[Math.exp,"Math.exp"],[Math.expm1,"Math.expm1"],[Math.floor,"Math.floor"],[Math.fround,"Math.fround"],[Math.hypot,"Math.hypot"],[Math.imul,"Math.imul"],[Math.log,"Math.log"],[Math.log10,"Math.log10"],[Math.log1p,"Math.log1p"],[Math.log2,"Math.log2"],[Math.max,"Math.max"],[Math.min,"Math.min"],[Math.pow,"Math.pow"],[Math.random,"Math.random"],[Math.round,"Math.round"],[Math.sign,"Math.sign"],[Math.sin,"Math.sin"],[Math.sinh,"Math.sinh"],[Math.sqrt,"Math.sqrt"],[Math.tan,"Math.tan"],[Math.tanh,"Math.tanh"],[Math.trunc,"Math.trunc"],[Number,"Number"],[Number.isFinite,"Number.isFinite"],[Number.isInteger,"Number.isInteger"],[Number.isNaN,"Number.isNaN"],[Number.isSafeInteger,"Number.isSafeInteger"],[Number.parseFloat,"Number.parseFloat"],[Number.parseInt,"Number.parseInt"],[Object,"Object"],[Object.assign,"Object.assign"],[Object.create,"Object.create"],[Object.defineProperties,"Object.defineProperties"],[Object.defineProperty,"Object.defineProperty"],[Object.entries,"Object.entries"],[Object.freeze,"Object.freeze"],[Object.fromEntries,"Object.fromEntries"],[Object.getOwnPropertyDescriptor,"Object.getOwnPropertyDescriptor"],[Object.getOwnPropertyDescriptors,"Object.getOwnPropertyDescriptors"],[Object.getOwnPropertyNames,"Object.getOwnPropertyNames"],[Object.getOwnPropertySymbols,"Object.getOwnPropertySymbols"],[Object.getPrototypeOf,"Object.getPrototypeOf"],[Object.is,"Object.is"],[Object.isExtensible,"Object.isExtensible"],[Object.isFrozen,"Object.isFrozen"],[Object.isSealed,"Object.isSealed"],[Object.keys,"Object.keys"],[Object.preventExtensions,"Object.preventExtensions"],[Object.seal,"Object.seal"],[Object.setPrototypeOf,"Object.setPrototypeOf"],[Object.values,"Object.values"],[parseFloat,"parseFloat"],[parseInt,"parseInt"],[Promise,"Promise"],[Proxy,"Proxy"],[RangeError,"RangeError"],[ReferenceError,"ReferenceError"],[Reflect.apply,"Reflect.apply"],[Reflect.construct,"Reflect.construct"],[Reflect.defineProperty,"Reflect.defineProperty"],[Reflect.deleteProperty,"Reflect.deleteProperty"],[Reflect.get,"Reflect.get"],[Reflect.getOwnPropertyDescriptor,"Reflect.getOwnPropertyDescriptor"],[Reflect.getPrototypeOf,"Reflect.getPrototypeOf"],[Reflect.has,"Reflect.has"],[Reflect.isExtensible,"Reflect.isExtensible"],[Reflect.ownKeys,"Reflect.ownKeys"],[Reflect.preventExtensions,"Reflect.preventExtensions"],[Reflect.set,"Reflect.set"],[Reflect.setPrototypeOf,"Reflect.setPrototypeOf"],[RegExp,"RegExp"],[Set,"Set"],[String,"String"],[String.fromCharCode,"String.fromCharCode"],[String.fromCodePoint,"String.fromCodePoint"],[String.raw,"String.raw"],[Symbol,"Symbol"],[Symbol.for,"Symbol.for"],[SyntaxError,"SyntaxError"],[TypeError,"TypeError"],[Uint16Array,"Uint16Array"],[Uint16Array.from,"Uint16Array.from"],[Uint16Array.of,"Uint16Array.of"],[Uint32Array,"Uint32Array"],[Uint32Array.from,"Uint32Array.from"],[Uint32Array.of,"Uint32Array.of"],[Uint8Array,"Uint8Array"],[Uint8Array.from,"Uint8Array.from"],[Uint8Array.of,"Uint8Array.of"],[Uint8ClampedArray,"Uint8ClampedArray"],[Uint8ClampedArray.from,"Uint8ClampedArray.from"],[Uint8ClampedArray.of,"Uint8ClampedArray.of"],[URIError,"URIError"],[WeakMap,"WeakMap"],[WeakSet,"WeakSet"]]),new Map([[Atomics,"Atomics"],[console,"console"],[globalThis,"globalThis"],[globalThis.crypto,"crypto"],[Intl,"Intl"],[JSON,"JSON"],[Math,"Math"],[Reflect,"Reflect"]]),Symbol("Scope ID"),Symbol("Pending Contexts"),Symbol(),globalThis.setImmediate||globalThis.setTimeout||globalThis.queueMicrotask,Symbol("selectedValue");var ne=/["'>\s]/g;function se(e){if(ne.test(e)){const t=e[ne.lastIndex-1];return ne.lastIndex=0,'"'===t?`'${e.replace(/'/g,"&#39;")}'`:`"${e.replace(/"/g,"&#34;")}"`}return e}Symbol();var oe=r("../../browser-shims/compiler/index.js");function ae(e){return/^[a-z_$][a-z0-9_$]*$/i.test(e)?oe.types.identifier(e):/^(?:0|[1-9][0-9]*)$/.test(e)?oe.types.numericLiteral(parseInt(e,10)):oe.types.stringLiteral(e)}function ie(e,t){return oe.types.objectProperty(ae(e),t)}function le(e,t,r){const n=ae(t),s="Identifier"!==n.type;return r?oe.types.optionalMemberExpression(e,n,s,!0):oe.types.memberExpression(e,n,s)}var ce=["createTemplate","createRenderer","createRendererWithOwner","value","state","intersection","loopClosure","conditionalClosure","dynamicClosure","loopOf","loopIn","loopTo","conditional"];function pe(e){const{output:t}=$();return le((0,O.importStar)(Vr.hub.file,function(e){const{optimize:t}=$();return`${f.name}/${t?"":"debug/"}${"html"===e?"html":"dom"}`}(t),"$"),e)}function de(e,...t){const r=D.types.callExpression(pe(e),function(e){const t=[];for(let r=e.length;r--;){const n=e[r];(n||t.length)&&(t[r]=n||D.types.unaryExpression("void",D.types.numericLiteral(0)))}return t}(t));return ce.includes(e)&&(r.leadingComments=[{type:"CommentBlock",value:" @__PURE__ "}]),r}function ue(){return{escapeXML:J,toString:W,attr:ee,classAttr:H,styleAttr:Q,escapeScript:G,escapeStyle:X}}function fe(){const e=$();return`marko/src/runtime/helpers/tags-compat/${B()?"html":"dom"}${e.optimize?"":"-debug"}.${"esm"===e.modules?"mjs":"js"}`}var me=r("../../browser-shims/compiler/index.js"),ye=r("../../browser-shims/compiler/babel-utils.js"),ge=r("../../browser-shims/compiler/babel-utils.js");function be(e){return e.node.name.value}var{taglibId:he}=f;function ve(e){if(e.isMarkoTag()){const t=(0,ge.getTagDef)(e);if(t)switch(t.taglibId){case he:case"@marko/translator-interop-class-tags":return!0;case"marko-html":switch(t.name){case"script":case"style":return!0}}}return!1}function xe(e,t){return ve(e)&&be(e)===t}function we(e){if(ve(e))switch(be(e)){case"if":case"else-if":case"else":return!0}return!1}function Ae(e,t){return e?Array.isArray(e)?(e.push(t),e):[e,t]:t}function ke(e,t){if(e)if(Array.isArray(e)){let r=0;for(const n of e)t(n,r++)}else t(e,0)}function Ee(e,t){if(e){if(Array.isArray(e))return e.find(t);if(t(e,0))return e}}function Se(e,t,r){let n=t.length,s=0;for(;s<n;){const o=s+n>>>1,a=t[o],i=e(a,r);if(0===i)return a;i>0?n=o:s=o+1}}function Te(e,t,r){const n=t.length;let s=n,o=0;for(;o<s;){const n=o+s>>>1,a=e(t[n],r);if(0===a)return t;a>0?s=n:o=n+1}const a=new Array(n+1);for(let e=0;e<o;e++)a[e]=t[e];let i=r;for(;o<n;){const e=i;i=t[o],a[o++]=e}return a[n]=i,a}function Me(e,t,r){const n=e(t,r);return 0===n?t:n<0?[t,r]:[r,t]}var Ie=e=>{const t=new WeakMap;return[()=>{let r=t.get(Vr);return r||t.set(Vr,r=e()),r},e=>{t.set(Vr,e)}]};function je(e,t){return[r=>{const n=Vr.state[e]??={};return n[r.id]??=t&&t(r)},(t,r)=>{(Vr.state[e]??={})[t.id]=r}]}var Ce=r("../../browser-shims/compiler/index.js"),Pe=r("../../browser-shims/compiler/babel-utils.js"),Be=/^<.*>$|\.marko$/;function Ne(e){const t=e.node.extra??={};if(void 0===t.tagNameType){const r=e.get("name");if(r.isStringLiteral()?(t.tagNameType="@"===r.node.value[0]?3:(0,Pe.isNativeTag)(e)?0:1,t.tagNameNullable=t.tagNameNullable=!1):function(e,t){const r=[e];let n,s,o,a=!1;for(;(n=r.pop())&&2!==s;)if(n.isConditionalExpression())r.push(n.get("consequent")),n.node.alternate&&r.push(n.get("alternate"));else if(n.isLogicalExpression())"||"===n.node.operator?r.push(n.get("left")):a=!0,r.push(n.get("right"));else if(n.isAssignmentExpression())r.push(n.get("right"));else if(n.isBinaryExpression())s="+"!==n.node.operator||void 0!==s?2:0;else if(n.isStringLiteral()||n.isTemplateLiteral())s=void 0!==s?2:0;else if(n.isNullLiteral())a=!0;else if(n.isIdentifier()){if("undefined"===n.node.name){a=!0;continue}const t=n.scope.getBinding(n.node.name);if(!t){s=2;continue}if("module"===t.kind){const r=t.path.parent;if(Be.test(r.source.value)&&r.specifiers.some((e=>Ce.types.isImportDefaultSpecifier(e)))){const t=(0,Pe.resolveTagImport)(e,r.source.value)||r.source.value;0===s||o&&o!==t?(s=2,o=void 0):(s=1,o=t)}else s=2;continue}const i=t.path;if(i.isMarkoTag()&&"local"===t.kind){const e=i.get("name").node.value;if("const"===e){r.push(i.get("attributes")[0].get("value"));continue}if("let"===e){s=2;continue}continue}s=2}else s=2;t.tagNameType=s,t.tagNameNullable=a,t.tagNameDynamic=!0,1===s&&o&&(t.tagNameImported=o)}(r,t),void 0===t.tagNameType&&(t.tagNameType=2),1===t.tagNameType){const r=(0,Pe.loadFileForTag)(e);r?"class"===r.ast.program.extra.featureType&&(t.tagNameType=2,t.featureType="class",(Vr.node.extra??={}).needsCompat=!0):t.tagNameType=2}}return t.tagNameType}function $e(e){const t=e.node.extra??={};let r=t.section;if(!r&&("Program"===e.type||e.get("body").length)){const n=e.parentPath?De(e.parentPath):void 0,s=e.parentPath?.get("name"),o=e.isProgram()?"":Vr.scope.generateUid(s.toString()+"_content"),a=e.hub.file.path.node.extra??={},i=a.sections??=[];r=t.section={id:i.length,name:o,depth:n?n.depth+1:0,parent:n,params:void 0,closures:void 0,bindings:void 0,content:Ve(e),upstreamExpression:void 0,hasAbortSignal:!1,isBranch:!1},i.push(r)}return r}function De(e){let t=e;for(;;){if("Program"===t.type||"MarkoTagBody"===t.type&&!t.node.attributeTags&&0!==Ne(t.parentPath)&&"html-comment"!==t.parent.name.value)return $e(t);t=t.parentPath}}function Oe(e){return e.node.extra?.section}function Fe(e){let t,r=e;for(;void 0===(t=r.node.extra?.section);)r=r.parentPath;return t}var[Le]=je("scopeIdIdentifier",(e=>Vr.scope.generateUidIdentifier(`scope${e.id}_id`))),[Ue,Re]=je("parentIsOwner",(()=>!1)),[_e]=je("scopeIdentifier",(()=>me.types.identifier("undefined"))),ze=(e,t)=>{const r=_e(e);return t||"undefined"!==r.name||(r.name=Vr.scope.generateUid(`scope${e.id}_`)),r};function We(e){const{sections:t}=Vr.node.extra;t?.forEach(e)}function Ve(e){const t=e.get("body"),r={startType:null,endType:null,singleChild:!0};for(let e=t.length;e--;){const n=qe(t[e],"endType",r);if(null!==n){r.endType=n;for(let n=0;n<e;n++){const e=qe(t[n],"startType");if(null!==e)return r.startType=e,r.singleChild=!1,r}return r.startType=qe(t[e],"startType"),r}}return null}function qe(e,t,r){switch(e.type){case"MarkoText":return 4;case"MarkoPlaceholder":return 2;case"MarkoScriptlet":case"MarkoComment":case"ImportDeclaration":case"ExportAllDeclaration":case"ExportNamedDeclaration":return null;case"MarkoTag":{const n=e;if(ve(n))switch(n.node.name.value){case"html-comment":return 0;case"html-script":case"html-style":return 3;case"for":case"if":return 1;default:return null}else{if((0,ye.isNativeTag)(n))return 3;if((0,ye.isAttributeTag)(n))return null;if(me.types.isStringLiteral(n.node.name)){const e=(0,ye.loadFileForTag)(n)?.ast.program.extra.section;if(e)return e.content?(r&&!e.content.singleChild&&"endType"===t&&(r.startType=e.content.startType,r.singleChild=!1),e.content[t]):null}}}}return 1}var Je=e=>{const t=e.upstreamExpression;return!t||Ln(t.referencedBindings)},Ze=(e,t)=>!!Ee(e.closures,(r=>(!t||e.parent===r.section)&&Ln(r))),Ge=r("../../browser-shims/compiler/index.js"),Ke=r("../../browser-shims/compiler/babel-utils.js"),Xe=d(r("../../node_modules/path-browserify/index.js"));var Ye=/[\\^$.*+?()[\]{}|]/g,He=r("../../browser-shims/compiler/index.js"),Qe=r("../../browser-shims/compiler/babel-utils.js"),et=r("../../browser-shims/compiler/index.js"),tt=r("../../browser-shims/compiler/babel-utils.js");function rt(e){const t={};for(const r of e.attributes)"MarkoAttribute"===r.type&&(t[r.name]=r.value);return t}var nt=r("../../browser-shims/compiler/index.js");function st(e,t){if(!e)return!1;const{node:r}=t,n=at(e)?e.default:e;return it(n)?n(t,nt.types):n.enter&&n.enter(t,nt.types),r!==t.node}function ot(e,t){if(!e)return!1;const{node:r}=t,n=at(e)?e.default:e;return!it(n)&&n.exit&&n.exit(t,nt.types),r!==t.node}function at(e){return Boolean(e.default)}function it(e){return"function"==typeof e}function lt({html:e,dom:t}){return{enter(r){st(B()?e:t,r)},exit(r){ot(B()?e:t,r)}}}var ct=r("../../browser-shims/compiler/index.js"),pt=r("../../browser-shims/compiler/index.js");function dt(e){const t=[],r=[];let n=e[0];for(let s=1;s<e.length;s++){let o=e[s];if("object"==typeof o){if(!pt.types.isStringLiteral(o)){if(pt.types.isTemplateLiteral(o)){let t=s+1;const r=o.expressions.length;ft(e,t,o.quasis.length+r);for(let n=0;n<r;n++)e[t++]=o.quasis[n].value.raw,e[t++]=o.expressions[n];e[t]=o.quasis[r].value.raw;continue}r.push(o),t.push(n),n="";continue}o=o.value}n+=o}return r.length?1!==r.length||n||t[0]?(t.push(n),pt.types.templateLiteral(t.map((e=>pt.types.templateElement({raw:e}))),r)):r[0]:n?pt.types.stringLiteral(n):void 0}function ut(e,t){e[e.length-1]+=t}function ft(e,t,r){for(let n=e.length-1;n>=t;n--)e[n+r]=e[n]}var mt=r("../../browser-shims/compiler/index.js"),[yt]=je("walks",(()=>[""])),[gt]=je("walkComment",(()=>[])),[bt]=je("steps",(()=>[])),ht={32:"get",36:"inside",37:"replace",38:"endChild",47:"beginChild",67:"next",97:"over",107:"out",117:"multiplier",91:"nextEnd",106:"overEnd",116:"outEnd",126:"multiplierEnd"};function vt(e){bt(Fe(e)).push(0)}function xt(e){bt(Fe(e)).push(1)}function wt(e){bt(Fe(e)).push(0,1)}function At(e,t){if(B())return;const r=Fe(e),n=bt(r),s=yt(r),o=gt(r);let a="";if(n.length){const e=[];let t=0;for(const r of n)0===r?(t++,e.push(67)):(t--,t>=0?(e.length=e.lastIndexOf(67),e.push(97)):(e.length=e.lastIndexOf(107)+1,e.push(107),t=0));let r=e[0],s=0;for(const t of e)t!==r?(o.push(`${ht[r]}(${s})`),a+=kt(r,s),r=t,s=1):s++;o.push(`${ht[r]}(${s})`),a+=kt(r,s),n.length=0}void 0!==t&&(32!==t&&It(e)`<!>`,o.push(`${ht[t]}`),a+=String.fromCharCode(t)),ut(s,a)}function kt(e,t){switch(e){case 67:return Et(t,e,20);case 97:case 107:return Et(t,e,10);default:throw new Error(`Unexpected walk code: ${e}`)}}function Et(e,t,r){let n="";if(e>=r){const t=Math.floor(e/r);n+=Et(t,117,10),e-=t*r}return n+=String.fromCharCode(t+e),n}function St(e){const t=1===e.content?.startType?String.fromCharCode(68):"",r=1===e.content?.endType?String.fromCharCode(68):"",n=dt([t,...yt(e),r])||mt.types.stringLiteral("");return""!==n.value&&(n.leadingComments=[{type:"CommentBlock",value:" "+gt(e).join(", ")+" "}]),n}var[Tt]=je("writes",(()=>[""])),[Mt]=je("trailerWrites",(()=>[""]));function It(e,t){const r=Fe(e),n=t?Mt:Tt;return(e,...t)=>{const s=t.length,o=n(r);ut(o,e[0]);for(let r=0;r<s;r++)o.push(t[r],e[r+1])}}function jt(e){const t=Fe(e),r=Tt(t),n=Mt(t),s=dt(r),o=dt(n);return r.length=0,r[0]="",n.length=0,n[0]="",s&&o?ct.types.expressionStatement(ct.types.sequenceExpression([de("write",s),de("writeTrailers",o)])):s?ct.types.expressionStatement(de("write",s)):o?ct.types.expressionStatement(de("writeTrailers",o)):void 0}function Ct(e){const t=jt(e);t&&e.insertBefore(t)[0].skip()}function Pt(e){const t=e.isProgram()?e:e.get("body"),r=jt(t);r&&t.pushContainer("body",r)[0].skip()}function Bt(e){const t=1===e.content?.startType?"<!>":"",r=1===e.content?.endType?"<!>":"",n=Tt(e);return{setup:Br(e),walks:St(e),writes:dt([t,...n,r])||ct.types.stringLiteral("")}}function Nt(e,t){const r=Fe(e);if(0!==t.type)throw e.buildCodeFrameError("Tried to mark a node that was not determined to need a mark during analyze.");B()&&It(e)`${de("markResumeNode",Le(r),Mn(t))}`}var[$t,Dt]=je("returnId"),Ot=new WeakSet,Ft={analyze(e){if((0,tt.assertNoArgs)(e),(0,tt.assertNoVar)(e),(0,tt.assertNoParams)(e),b(e),(0,tt.assertAllowedAttributes)(e,["value","valueChange"]),Ot.has(e.hub))throw e.get("name").buildCodeFrameError("The `return` tag can only be used once per template.");if(Ot.add(e.hub),!rt(e.node).value)throw e.get("name").buildCodeFrameError("The `return` tag requires a value.")},translate:lt({html:{exit(e){const t=Fe(e),r=rt(e.node);if(Ct(e),r.valueChange&&ir(t).set(et.types.stringLiteral("@"),r.valueChange),r.value){const n=Vr.scope.generateUidIdentifier("return");Dt(t,n),e.replaceWith(et.types.variableDeclaration("const",[et.types.variableDeclarator(n,r.value)]))[0].skip()}}},dom:{exit(e){const t=Fe(e),r=rt(e.node);r.value&&wr(t,r.value.extra?.referencedBindings,{identifier:pe("tagVarSignal"),hasDownstreamIntersections:()=>!0},r.value),r.valueChange&&wr(t,r.valueChange.extra?.referencedBindings,{identifier:pe("setTagVarChange"),hasDownstreamIntersections:()=>!1},r.valueChange),e.remove()}}}),parseOptions:{openTagOnly:!0},autocomplete:[{displayText:"return=<value>",description:"Provides a value for use in a parent template.",snippet:"return=${1:value}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#return"}]};function Lt(e,t){switch(e.type){case"ObjectPattern":for(const r of e.properties)switch(r.type){case"ObjectProperty":"AssignmentPattern"===r.value.type?Lt(r.value.left,t):Lt(r.value,t);break;case"RestElement":Lt(r.argument,t)}break;case"ArrayPattern":for(const r of e.elements)if(null!=r)switch(r.type){case"RestElement":Lt(r.argument,t);break;case"AssignmentPattern":Lt(r.left,t);break;default:Lt(r,t)}break;case"Identifier":t(e)}}var Ut=r("../../browser-shims/compiler/index.js");function Rt(e){return e.declared||!e.upstreamAlias?Ut.types.identifier(e.name):void 0!==e.property?le(Rt(e.upstreamAlias),e.property,e.upstreamAlias.nullable):Rt(e.upstreamAlias)}var _t=r("../../browser-shims/compiler/index.js");function zt(e,t){const r=e.depth,n=_t.types.objectPattern([]);let s;return ke(t,(t=>{if(t.name.includes("#"))return;const o=Mn(t),a=_t.types.identifier(t.name),i=o.value===a.name;let l=n;if(t.section!==e){s||(s=[n]);const e=r-t.section.depth;let o=s.length,a=s[o-1];for(;o<=e;o++){const e=_t.types.objectPattern([]);a.properties.push(_t.types.objectProperty(_t.types.identifier("_"),e)),s.push(e),a=e}l=s[e]}l.properties.push(_t.types.objectProperty(i?a:o,a,!1,i))})),n}function Wt(e,t){let r=Jr??_t.types.identifier("undefined");const n=e.depth-t.depth;for(let e=0;e<n;e++)r=_t.types.memberExpression(r,_t.types.identifier("_"));if(n<0)throw new Error("Unable to find scope for reference.");return r}function Vt(e,t){return _t.types.memberExpression(Wt(e,t.section),Mn(t),!0)}var qt=r("../../browser-shims/compiler/index.js");function Jt(e){switch(e.type){case"FunctionDeclaration":case"FunctionExpression":case"ArrowFunctionExpression":return e;default:return qt.types.functionExpression(null,e.params,e.body,e.async,e.generator)}}var Zt=r("../../browser-shims/compiler/index.js");function Gt(e){if(1===e.length&&Zt.types.isExpressionStatement(e[0])){const{expression:t}=e[0];switch(t.type){case"ObjectExpression":case"AssignmentExpression":return Kt(t);default:return t}}return Zt.types.blockStatement(e)}function Kt(e){switch(e.type){case"ObjectExpression":case"AssignmentExpression":return Zt.types.parenthesizedExpression(e);default:return e}}var Xt=r("../../browser-shims/compiler/index.js"),Yt=Symbol("skip");function Ht(e,t,r){const n=e[t];if(n)if(Array.isArray(n))for(let e=n.length;e--;)Ht(n,e,r);else{const s=Xt.types.VISITOR_KEYS[n.type];for(let e=s.length;e--;)Ht(n,s[e],r);const o=r(n,e,t);o&&(e[t]=o)}}function Qt(e,t){if(e)if(Array.isArray(e)){for(const r of e)if(Qt(r,t))return!0}else{switch(t(e)){case!0:return!0;case Yt:return!1}for(const r of Xt.types.VISITOR_KEYS[e.type])if(Qt(e[r],t))return!0}return!1}var[er]=je("signals",(()=>new Map)),[tr,rr]=je("queue");function nr(e,t){rr(Oe(e.get("body")),t)}var[sr,or]=je("forceResumeScope");function ar(e){or(e,!0)}var[ir]=je("serializedScopeProperties",(()=>new Map)),lr=()=>He.types.stringLiteral("SIGNAL NOT INITIALIZED");function cr(e,t,r=function(e){let t;if(e)if(Array.isArray(e)){t="expr";for(const r of e)t+=`_${r.name}`}else t=e.name;else t="setup";return t}(t)){const n=er(e);let s=n.get(t);if(!s){const o=t?!Array.isArray(t)&&t.section===e&&t.export:!e.parent&&Vr.node.extra.domExports?.setup;if(n.set(t,s={identifier:o?He.types.identifier(o):Vr.scope.generateUidIdentifier(r+e.name.replace("_","$")),referencedBindings:t,section:e,values:[],intersection:void 0,render:[],renderReferencedBindings:void 0,effect:[],effectReferencedBindings:void 0,subscribers:[],closures:new Map,hasDownstreamIntersections:()=>{let r=!!s.intersection;if(!r)for(const e of s.values)if(e.signal.hasDownstreamIntersections()){r=!0;break}if(!r&&!Array.isArray(t)&&t){for(const n of t.aliases)if(cr(e,n).hasDownstreamIntersections()){r=!0;break}if(!r)for(const[,n]of t.propertyAliases)if(cr(e,n).hasDownstreamIntersections()){r=!0;break}}return s.hasDownstreamIntersections=()=>r,r},build:lr,export:!!o}),B())return s;t?Array.isArray(t)?(gr(t,s),s.build=()=>de("intersection",He.types.numericLiteral(t.length),dr(s,[Jr],t),yr(s))):t.section!==e&&xn.find(e.closures,t)&&(cr(t.section,t).closures.set(e,s),s.build=()=>{const r=tr(e),n=Wt(e,t.section),o=n.object===Jr,a=!o||!r,i=dr(s,[Jr,He.types.identifier(t.name)]);s.isDynamicClosure=a;const l=yr(s);return a?de("dynamicClosure",i,o?null:He.types.arrowFunctionExpression([Jr],n),l):r(s,i,l)},hr("render",e,void 0,He.types.expressionStatement(He.types.callExpression(He.types.memberExpression(s.identifier,He.types.identifier("_")),[Jr,Vt(e,t)])))):s.build=()=>dr(s,[Jr])}return s}function pr(e,t="value"){const r=Mn(e),n=cr(e.section,e);n.build=()=>{const s=dr(n,[Jr,He.types.identifier(e.name)]),o=yr(n),a=!e.upstreamAlias&&(3===e.type||2===e.type);return(!e.upstreamAlias||e.property)&&(e.downstreamExpressions.size||s.body.body.length>0)||o||a||o?de(t,r,s,o):s},n.valueAccessor=r;for(const t of e.aliases)pr(t);for(const t of e.propertyAliases.values())pr(t);return n}function dr(e,t,r){const n=e.section,s=e.referencedBindings,[o,a]=t,i=s&&!Array.isArray(s)&&s.section===n;if(i){for(const t of s.aliases){const r=cr(t.section,t);e.render.push(He.types.expressionStatement(He.types.callExpression(r.identifier,[o,a,...mr(r)])))}for(const[t,r]of s.propertyAliases){const n=cr(r.section,r);e.render.push(He.types.expressionStatement(He.types.callExpression(n.identifier,[o,le(a,t,s.nullable),...mr(n)])))}}for(const t of e.values)e.render.push(He.types.expressionStatement(He.types.callExpression(t.signal.identifier,[t.scope,t.value,...mr(t.signal)])));if(i){const t=Array.from(e.closures.entries()).sort((([e],[t])=>e.id-t.id));for(const[r,n]of t)Ln(n.referencedBindings)&&e.render.push(He.types.expressionStatement(He.types.callExpression(n.identifier,[o,a])))}return r&&e.render.unshift(He.types.variableDeclaration("const",[He.types.variableDeclarator(zt(n,r),o)])),He.types.arrowFunctionExpression(t,He.types.blockStatement(e.render))}var ur=new WeakSet,fr=[];function mr(e){return e.extraArgs?(ur.has(e)||(ur.add(e),Ht(e,"extraArgs",Nr)),e.extraArgs):fr}function yr(e){let t=e.intersection;const r=e.referencedBindings;if(r&&!Array.isArray(r)&&r.section===e.section){for(const e of r.aliases){const r=cr(e.section,e);r.hasDownstreamIntersections()&&(t=Ae(t,He.types.identifier(r.identifier.name)))}for(const[,e]of r.propertyAliases){const r=cr(e.section,e);r.hasDownstreamIntersections()&&(t=Ae(t,He.types.identifier(r.identifier.name)))}}for(const r of e.values)r.signal.hasDownstreamIntersections()&&(t=Ae(t,r.intersectionExpression??(He.types.isMemberExpression(r.signal.identifier)?r.signal.identifier:He.types.identifier(r.signal.identifier.name))));return t&&He.types.arrowFunctionExpression([],Array.isArray(t)?de("intersections",He.types.arrayExpression(t)):t)}function gr(e,t){if(Array.isArray(e))return void e.forEach((e=>gr(e,t)));const r=cr(t.section,e);r.intersection=Ae(r.intersection,t.identifier)}function br(e){for(let t=e.length-1;t>=0;t--){const r=e[t];if(He.types.isArrowFunctionExpression(r)&&He.types.isBlockStatement(r.body)){const n=r.body.body;0===n.length?e[t]=He.types.numericLiteral(0):1===n.length&&He.types.isExpressionStatement(n[0])&&(r.body=Kt(n[0].expression))}}for(let t=e.length-1;He.types.isNullLiteral(e[t]);)e.length=t--}function hr(e,t,r,n,s){const o=cr(t,r),a=o[e]??=[],i="effect"===e?vr:xr;if(Array.isArray(n)?a.push(...n):a.push(n),!1!==s)if(s)for(const e of s)i(o,e);else i(o,r)}function vr(e,t){e.effectReferencedBindings=xn.union(e.effectReferencedBindings,t)}function xr(e,t){e.renderReferencedBindings=xn.union(e.renderReferencedBindings,t)}function wr(e,t,r,n,s=Jr,o){cr(e,t).values.push({signal:r,value:n,scope:s,intersectionExpression:o})}function Ar(e,t,r){const{markoOpts:n,opts:{filename:s}}=Vr.hub.file;let o="";if(t)if("string"==typeof t)o+=`_${t}`;else if(Array.isArray(t))for(const e of t)o+=`_${e.name}`;else o+=`_${t.name}`;return(0,Qe.getTemplateId)(n,s,`${e.id}${o}${r?"/"+r:""}`)}var kr=new WeakMap;function Er(e,t){const{markoOpts:r,opts:{filename:n}}=Vr.hub.file;let s=kr.get(e);s||kr.set(e,s=new Set);const o=(0,Qe.getTemplateId)(r,n,`${e.id}/${t}`);let a=0,i=o;for(;s.has(i);)i=o+"_"+ ++a;return s.add(i),i}function Sr(e){const t=[...er(e).values()].sort(Mr);for(const r of t){Ht(r,"render",Nr);for(const e of r.values)Ht(e,"value",Nr);let t;if(r.effect.length){Ht(r,"effect",$r);const n=He.types.identifier(`${r.identifier.name}_effect`),s=r.effectReferencedBindings,o=Qt(r.effect,Kr);t=He.types.variableDeclarator(n,de("effect",He.types.stringLiteral(Ar(e,r.referencedBindings)),He.types.arrowFunctionExpression(s?o?[Jr,zt(e,s)]:[zt(e,s)]:o?[Jr]:[],Gt(r.effect)))),r.render.push(He.types.expressionStatement(He.types.callExpression(n,[Jr])))}let n=r.build();He.types.isCallExpression(n)&&br(n.arguments),r.register&&(n=de("registerBoundSignal",He.types.stringLiteral(Ar(e,r.referencedBindings,"var")),n)),r.isDynamicClosure&&Ln(r.referencedBindings)&&(n=de("registerSubscriber",He.types.stringLiteral(Ar(e,r.referencedBindings,"subscriber")),n));const s=He.types.variableDeclarator(r.identifier,n);let o=e.parent||r.referencedBindings||!He.types.isFunctionExpression(n)&&!He.types.isArrowFunctionExpression(n)?He.types.variableDeclaration("const",[s]):He.types.functionDeclaration(r.identifier,n.params,He.types.isExpression(n.body)?He.types.blockStatement([He.types.expressionStatement(n.body)]):n.body);r.export&&(o=He.types.exportNamedDeclaration(o)),Vr.pushContainer("body",t?[He.types.variableDeclaration("const",[t]),o]:o)}}function Tr(e){const t=Jt(e);return"FunctionDeclaration"===t.type?[t,He.types.returnStatement(t.id)]:[He.types.returnStatement(t)]}function Mr(e,t){const r=Ir(e),n=Ir(t);for(let e=Math.max(r.length,n.length)-1;e>=0;e--){const t=(n[e]??-1)-(r[e]??-1);if(0!==t)return t}return 0}function Ir({referencedBindings:e}){return e?Array.isArray(e)?e.map(jr).sort():[jr(e)]:[]}function jr(e){return 1e4*(0===e.type?1:0)+e.id}function Cr(e,t){hr("effect",e,t,void 0,!1)}function Pr(e,t){const r=Oe(e);if(!r)return;const n=Array.from(er(r).values()),s=Le(r);ke(r.closures,(t=>{if(Ln(t)){let n=r;for(;n!==t.section;)ir(n).set(He.types.stringLiteral("_"),de("ensureScopeWithId",Le(n=n.parent)));ar(t.section);const o=r.parent?.id===t.section.id;(!tr(r)||!o)&&e.pushContainer("body",He.types.expressionStatement(de("writeEffect",s,He.types.stringLiteral(Ar(r,t,"subscriber")))))}}));for(let t=n.length;t--;)if(n[t].effect.length){const o=n[t].referencedBindings;e.pushContainer("body",He.types.expressionStatement(de("writeEffect",s,He.types.stringLiteral(Ar(r,o)))))}const o=new Set,a=ir(r),i=[];ke(r.bindings,(e=>{if(e.serialize&&0!==e.type){const t=Mn(e);i.push(He.types.objectProperty(t,Rt(e))),o.add(t.value)}})),t&&void 0!==$t(r)&&i.push(He.types.objectProperty(He.types.stringLiteral("/"),t));for(const[e,t]of a)o.has(e.value)||(i.push(He.types.objectProperty(e,t,!He.types.isLiteral(e))),o.add(e.value));(i.length||sr(r))&&e.pushContainer("body",He.types.expressionStatement(de("writeScope",s,He.types.objectExpression(i)))),!r.isBranch&&(r.hasAbortSignal||!!r.closures||!!Ee(r.bindings,(e=>1===e.type)))&&e.pushContainer("body",He.types.expressionStatement(de("resumeClosestBranch",s))),e.get("body").length&&e.unshiftContainer("body",He.types.variableDeclaration("const",[He.types.variableDeclarator(s,de("nextScopeId"))]))}function Br(e){return er(e).get(void 0)?.identifier}function Nr(e){return Or(e)||Dr(e)||Lr(e)}function $r(e){return Or(e)||Dr(e)}function Dr(e){switch(e.type){case"Identifier":case"MemberExpression":return In(e)}}function Or(e){switch(e.type){case"UpdateExpression":{const{extra:t}=e.argument;if(On(t)){const{buildAssignment:r}=cr(t.assignment.section,t.assignment);if(r){const n=r(t.section,He.types.binaryExpression("++"===e.operator?"+":"-",e.argument,He.types.numericLiteral(1)));return e.prefix?n:He.types.sequenceExpression([n,e.argument])}}break}case"AssignmentExpression":switch(e.left.type){case"Identifier":{const{extra:t}=e.left;if(On(t)){const{buildAssignment:r}=cr(t.assignment.section,t.assignment);if(r)return r(t.section,"="===e.operator?e.right:He.types.binaryExpression(e.operator.slice(0,-1),e.left,e.right))}break}case"ArrayPattern":case"ObjectPattern":{let t,r;if(Lt(e.left,(e=>{const{extra:n}=e;if(On(n)){const s=cr(n.assignment.section,n.assignment);s?.buildAssignment&&(e.name=Vr.scope.generateUid(e.name),(t||=[]).push(He.types.identifier(e.name)),(r||=[]).push(s.buildAssignment(n.section,He.types.identifier(e.name))))}})),t&&r){const n=Vr.scope.generateUid("result");return He.types.callExpression(He.types.arrowFunctionExpression([He.types.identifier(n),...t],He.types.sequenceExpression([He.types.assignmentExpression("=",e.left,He.types.identifier(n)),...r,He.types.identifier(n)])),[e.right])}break}}}}var Fr=new WeakMap;function Lr(e){switch(e.type){case"ClassMethod":{const t=Ur(e);return t&&He.types.classProperty(e.key,t)}case"ClassPrivateMethod":{const t=Ur(e);return t&&He.types.classPrivateProperty(e.key,t)}case"ObjectMethod":{const t=Ur(e);return t&&He.types.objectProperty(e.key,t)}case"ArrowFunctionExpression":case"FunctionExpression":return Ur(e);case"FunctionDeclaration":{const t=Ur(e);if(t)return He.types.variableDeclaration("const",[He.types.variableDeclarator(e.id,t)]);break}}}function Ur(e){const{extra:t}=e;if(Fn(t)){const r=Vr.scope.generateUid(t.name),n=t.referencesScope,s=t.referencedBindingsInFunction;let o=Fr.get(Vr.node);return o||Fr.set(Vr.node,o=[]),o.push({id:r,node:e,registerId:t.registerId,section:t.section,referencesScope:n,referencedBindings:s}),n||s?He.types.callExpression(He.types.identifier(r),[Jr]):He.types.identifier(r)}}var Rr={translate:{exit(e){At(e);const t=Oe(e),{walks:r,writes:n,setup:s}=Bt(t),o=e.node.extra.domExports,a=Ge.types.identifier(o.template),i=Ge.types.identifier(o.walks),l=Ge.types.identifier(o.setup),c=e.node.extra.binding,p=c&&M(c)?pr(c):void 0,d=function(e){const{filename:t}=e.opts,r=e.markoOpts.fileSystem,n=function(e){const t=e.lastIndexOf(Xe.default.sep)+1,r=e.indexOf(".",t);if(-1===r)return e.slice(t);const n=e.lastIndexOf("."),s=r-1;if("]"===e[s]){const o=e.lastIndexOf("[",s);if(o>t)return e.slice(t,o)+e.slice(r,n)}return e.slice(t,n)}(t),s=new RegExp(`^(${o=n,o.replace(Ye,"\\$&")}\\.${"index"===n?"|":""})style\\.\\w+$`);var o;for(const e of r.readdirSync(Xe.default.dirname(t)).sort())if(s.test(e))return`./${e}`}(e.hub.file);d&&(0,Ke.importDefault)(e.hub.file,d),function(e){const{sections:t}=Vr.node.extra;for(let r=t.length;r--;)e(t[r])}((r=>{if(r!==t){const t=r.params&&pr(r.params),{walks:n,writes:s,setup:o}=Bt(r),a=Ge.types.identifier(r.name),i=de(Ue(r)?"createRenderer":"createRendererWithOwner",s,n,o,t?.identifier&&Ge.types.arrowFunctionExpression([],t.identifier));Sr(r),e.node.body.push(Ge.types.variableDeclaration("const",[Ge.types.variableDeclarator(a,Je(r)?de("register",Ge.types.stringLiteral(Ar(r,"renderer")),i):i)]))}})),Sr(t),function(){const e=Fr.get(Vr.node),t=[];if(e){for(const r of e){let e;const n=r.referencedBindings?r.referencesScope?[Jr,He.types.assignmentPattern(zt(r.section,r.referencedBindings),Jr)]:[zt(r.section,r.referencedBindings)]:r.referencesScope?[Jr]:void 0;e=n?He.types.functionDeclaration(He.types.identifier(r.id),n,He.types.blockStatement(Tr(r.node))):"FunctionDeclaration"===r.node.type&&r.node.id?.name===r.id?r.node:He.types.functionDeclaration(He.types.identifier(r.id),r.node.params,"BlockStatement"===r.node.body.type?r.node.body:He.types.blockStatement([He.types.returnStatement(r.node.body)]),r.node.generator,r.node.async),t.push(e)}for(const r of e)t.push(He.types.expressionStatement(de("register",He.types.stringLiteral(r.registerId),He.types.identifier(r.id))));for(const e of Vr.pushContainer("body",t))e.skip()}}(),s||e.node.body.unshift(Ge.types.exportNamedDeclaration(Ge.types.variableDeclaration("const",[Ge.types.variableDeclarator(l,Ge.types.arrowFunctionExpression([],Ge.types.blockStatement([])))]))),e.node.body.unshift(Ge.types.exportNamedDeclaration(Ge.types.variableDeclaration("const",[Ge.types.variableDeclarator(a,n||Ge.types.stringLiteral(""))])),Ge.types.exportNamedDeclaration(Ge.types.variableDeclaration("const",[Ge.types.variableDeclarator(i,r||Ge.types.stringLiteral(""))]))),e.node.body.push(Ge.types.exportDefaultDeclaration(de("createTemplate",Ge.types.stringLiteral(e.hub.file.metadata.marko.id),a,i,l,p?.identifier&&Ge.types.arrowFunctionExpression([],p.identifier))))}}},_r=r("../../browser-shims/compiler/index.js"),zr={translate:{exit(e){const t=Oe(e),r=e.scope.generateUidIdentifier("tagVar");Pt(e),Pr(e,r),Ht(e.node,"body",Wr);const n=$t(t);void 0!==n&&e.pushContainer("body",_r.types.returnStatement(n));const s=[];for(const t of e.get("body"))(o=t).isImportDeclaration()||o.isExportDeclaration()||o.isMarkoScriptlet({static:!0})?t.isMarkoScriptlet()&&(t.node.target&&"server"!==t.node.target?t.remove():t.replaceWithMultiple(t.node.body)):(s.push(t.node),t.remove());var o;e.pushContainer("body",[_r.types.variableDeclaration("const",[_r.types.variableDeclarator(qr,de("createRenderer",_r.types.arrowFunctionExpression([_r.types.identifier("input"),r],_r.types.blockStatement(s))))]),_r.types.exportDefaultDeclaration(de("createTemplate",_r.types.stringLiteral(e.hub.file.metadata.marko.id),qr))])}}};function Wr(e,t){return function(e){switch(e.type){case"Identifier":case"MemberExpression":{const{extra:t}=e;if(t&&!(t.read&&!t.read.binding.declared||t.binding&&!t.binding.declared))return In(e)}}}(e)||function(e,t){switch(e.type){case"ClassMethod":{const t=Gr(e);return t&&_r.types.classProperty(e.key,t)}case"ClassPrivateMethod":{const t=Gr(e);return t&&_r.types.classPrivateProperty(e.key,t)}case"ObjectMethod":{const t=Gr(e);return t&&_r.types.objectProperty(e.key,t)}case"FunctionDeclaration":{const{extra:r}=e;if(Fn(r)){let n=Zr.get(t);n||Zr.set(t,n=[]),n.push({id:e.id.name,registerId:r.registerId})}break}case"ArrowFunctionExpression":case"FunctionExpression":return Gr(e);case"BlockStatement":case"MarkoScriptlet":!function(e){const t=Zr.get(e);if(t)for(const{id:r,registerId:n}of t)e.push(_r.types.expressionStatement(de("register",_r.types.identifier(r),_r.types.stringLiteral(n))))}(e.body)}}(e,t)}var Vr,qr,Jr,Zr=new WeakMap;function Gr(e){const{extra:t}=e;if(Fn(t))return de("register",Jt(e),_r.types.stringLiteral(t.registerId),(t.referencedBindingsInFunction||t.referencesScope)&&Le(t.section))}function Kr(e){return e===Jr}var Xr=new WeakMap,Yr={migrate:{enter(e){Xr.set(e,Vr),e.node.params=[E.types.identifier("input")],Vr=e},exit(){Vr.scope.crawl(),Vr=Xr.get(Vr)}},analyze:{enter(e){Xr.set(e,Vr),Vr=e,$e(e),pn(e,2),e.node.params[0].extra.binding.nullable=!1;const{scope:t}=e;(e.node.extra??={}).domExports={template:t.generateUid("template_"),walks:t.generateUid("walks_"),setup:t.generateUid("setup_"),params:void 0,closures:t.generateUid("closures_")}},exit(e){!function(){const e=sn(),t=wn(),r=An(),n=yn();if(n.size)for(const[e,r]of n){const n=e.extra;let a=t.get(n),{isEffect:i}=n;for(const e of r){const r=e?.extra;if(Dn(r)){i||=r.isEffect;const e=t.get(r);e&&(o=e,a=(s=a)?o?Array.isArray(s)?s.concat(o):Array.isArray(o)?[s,...o]:[s,o]:s:o,t.delete(r))}}t.set(n,a),n.isEffect=i}var s,o;const a=new Map;for(const[e,r]of t)Dn(e)&&(e.referencedBindings=Cn(e,r,a),ke(e.referencedBindings,(t=>{t.downstreamExpressions.add(e)})));for(const[e,t]of r)e.referencedBindingsInFunction=Cn(e,t,a),ke(e.referencedBindingsInFunction,(e=>{e.serialize=!0}));for(const t of e)0===t.type||t.upstreamAlias||jn(e,t);for(const t of e){const{name:e,section:r}=t;0!==t.type&&Ee(r.bindings,(({name:e})=>e===t.name))&&(t.name=Vr.scope.generateUid(e)),r.bindings=xn.add(r.bindings,t);for(const{referencedBindings:e,isEffect:r,section:n}of t.downstreamExpressions)n!==t.section&&(n.closures=xn.add(n.closures,t)),r&&ke(e,(e=>{e.serialize=!0}))}We((e=>{const t=a.get(e);if(t)for(const e of t){const t=e.length;for(let r=0;r<t-1;r++)for(let n=r+1;n<t;n++){const t=e[r],s=e[n],o=vn(t),a=vn(s);t.serialize||hn(o,a)||(t.serialize=!0),s.serialize||hn(a,o)||(s.serialize=!0)}}ke(e.closures,(t=>{if(!t.serialize){let r=!1;const n=t.section;let s=e;for(;s!==n&&!(r=!s.upstreamExpression||Ln(s.upstreamExpression.referencedBindings));)s=s.parent;t.serialize=r}}))})),We((({id:e,bindings:t})=>{ke(function(e,t){if(e){if(Array.isArray(e)){const r=e.length;let n,s=0;for(;s<r;){let o=e[s++];if(t(o)){for(n=o;s<r;)if(o=e[s++],t(o)){for(n=[n,o];s<r;)o=e[s++],t(o)&&n.push(o);return n}return n}}return n}if(t(e))return e}}(t,(({section:t})=>t.id===e)),((e,t)=>{e.id=t}))})),n.clear(),t.clear(),r.clear()}();const{scope:t,node:{extra:r}}=e;r.binding&&M(r.binding)&&(r.domExports.params=Hr(r.binding,t)),Vr=Xr.get(Vr)}},translate:{enter(e){if(Xr.set(e,Vr),Vr=e,Jr=N()?e.scope.generateUidIdentifier("scope"):null,N()&&e.scope.generateUidIdentifier("clean"),qr=B()?e.scope.generateUidIdentifier("renderer"):null,"hydrate"===$().output){const t=e.hub.file,r=new Set([(0,S.resolveRelativePath)(t,t.opts.filename)]);return P.visit(t,t,(function e(n){if(!r.has(n)){r.add(n);const s=(0,S.loadFileForImport)(t,n);s&&P.visit(s,t,(r=>e(function(e,t,r){return t===e?(0,S.resolveRelativePath)(t,r):(0,S.resolveRelativePath)(e,"."===r[0]?T.default.join(t.opts.filename,"..",r):r)}(t,s,r))))}})),e.node.body=P.build(t),void e.skip()}},exit(e){if(B()?zr.translate.exit(e):Rr.translate.exit(e),e.node.extra?.needsCompat){const t=fe(),r=[void 0];for(const n of e.node.body)"ImportDeclaration"===n.type&&n.source.value===t?r[0]=n:r.push(n);r[0]??=E.types.importDeclaration([],E.types.stringLiteral(t)),e.node.body=r}Vr=Xr.get(Vr)}}};function Hr(e,t){const r={id:e.export??=t.generateUid(e.name+"_"),props:void 0},{aliases:n,propertyAliases:s,downstreamExpressions:o}=e;if(!o.size){r.props={};for(const[e,n]of s)r.props[e]=Hr(n,t);for(const e of n){const n=Hr(e,t);if(!n.props)return r.props=void 0,r;r.props={...r.props,...n.props}}}return r}function Qr(e){let t=e;for(;!tn(t.parentPath);)t=t.parentPath;return t}function en(e){let t=e;if(!t.isProgram()){for(;!rn(t);){if(tn(t))return;t=t.parentPath}return t}}function tn(e){switch(e.type){case"MarkoTag":case"MarkoTagBody":case"MarkoAttribute":case"MarkoSpreadAttribute":case"MarkoPlaceholder":case"MarkoScriptlet":return!0;default:return!1}}function rn(e){switch(e.type){case"FunctionExpression":case"ArrowFunctionExpression":return!0;default:return!1}}function nn(e,t){return e.start=t.start,e.loc=t.loc,e.end=t.end,e}var[sn]=Ie((()=>new Set)),[on,an]=Ie((()=>0));function ln(e,t,r,n,s,o,a=!1){const i=on(),l={id:i,name:e,type:t,section:r,property:o,declared:a,excludeProperties:void 0,serialize:!1,aliases:new Set,propertyAliases:new Map,upstreamAlias:n,upstreamExpression:s,downstreamExpressions:new Set,export:void 0,nullable:!s?.confident||null==s.computed};if(o){a&&(n.nullable=!1);const e=n.propertyAliases.get(o);e?(l.property=void 0,l.upstreamAlias=e,e.aliases.add(l)):n.propertyAliases.set(o,l)}else n&&n.aliases.add(l);return an(i+1),sn().add(l),l}function cn(e,t,r,n){const s=e.node.var;if(s){const o=De(e),a=Sn(r);r&&n&&(n.pruned=!0),fn(s,t,e.scope,o,a,n,void 0)}}function pn(e,t,r,n){const s=e.node.params;if(e.node.body.length&&s.length){r&&n&&(n.pruned=!0);const o=De(e),a=Sn(r),i=a||((e.node.extra??={}).binding=ln(Vr.scope.generateUid("params_"),t,o,a,n,void 0));o.params=i;for(let r=0;r<s.length;r++)fn(s[r],t,e.scope,o,i,n,r+"")}}function dn(e,t){const r=De(e);un(e),Lt(e.node,(e=>{if(e.name===t.name){const n=e.extra??={};n.assignment=t,n.section=r}}))}function un(e){let t=en(e);for(;t;)(t.node.extra??={}).referencesScope=!0,t=en(t.parentPath)}function fn(e,t,r,n,s,o,a){switch(e.type){case"Identifier":(e.extra??={}).binding=ln(e.name,t,n,s,o,a,!0),function(e){const{identifier:t,referencePaths:r,constantViolations:n}=e,s=t.extra.binding;for(const e of r)mn(e,s);for(const e of n)if(e.isUpdateExpression())dn(e.get("argument"),s);else if(e.isAssignmentExpression()&&(dn(e.get("left"),s),"="!==e.node.operator)){const t=e.get("left");t.isIdentifier()&&mn(t,s)}}(r.getBinding(e.name));break;case"ObjectPattern":{const o=(a?s.propertyAliases.get(a):s)||((e.extra??={}).binding=ln(Vr.scope.generateUid("pattern_"),t,n,s,void 0,a));for(const s of e.properties)if("RestElement"===s.type)fn(s.argument,t,r,n,o,void 0,a);else{let e;if("Identifier"===s.key.type)e=s.key.name;else{if("StringLiteral"!==s.key.type)throw new Error("computed keys not supported in object pattern");e=s.key.value}fn(s.value,t,r,n,o,void 0,e)}break}case"ArrayPattern":{const o=(a?s.propertyAliases.get(a):s)||((e.extra??={}).binding=ln(Vr.scope.generateUid("pattern_"),t,n,s,void 0,a));let i=-1;for(const s of e.elements)i++,s&&("RestElement"===s.type?fn(s.argument,t,r,n,o,void 0,a):fn(s,t,r,n,o,void 0,`${i}`));break}case"AssignmentPattern":fn(e.left,t,r,n,s,void 0,a)}}function mn(e,t){let r=e,n=t,s=t.name;for(;;){const{parent:e}=r;if(!k.types.isMemberExpression(e))break;const t=Nn(e);if(void 0===t)break;if(n.propertyAliases.has(t))r=r.parentPath,n=n.propertyAliases.get(t),s=n.name;else{if(r.parentPath.parentPath.isCallExpression()&&!$n(t))break;r=r.parentPath,n=ln(s+=`_${t.replace(/[^a-zA-Z0-9_$]/g,"_")}`,n.type,n.section,n,void 0,t)}}const o=en(r),a=Qr(o||r),{section:i}=kn(a,n,r.node);if(o){const e=An(),t=o.node.extra??={};t.section=i,e.set(t,Ae(e.get(t),{binding:n,node:r.node}))}}var[yn]=Ie((()=>new Map));function gn(e,t,r){(t.extra??={}).section=e,yn().set(t,r)}function bn(e,t){const r=e.length,n=r-t.length;if(0!==n)return n;for(let n=0;n<r;n++){const r=xn.compare(e[n],t[n]);if(0!==r)return r}return 0}function hn(e,t){for(const r of t)if(!e.has(r))return!1;return!0}function vn(e){const t=new Set,r=new Set;return function e(n){if(4===n.type||3===n.type){let s,o=n;for(;s=o.upstreamAlias;)o=s;if(o.upstreamExpression){if(t.has(o))return;t.add(o),ke(o.upstreamExpression.referencedBindings,e)}else r.add(o)}else r.add(n)}(e),r}var xn=new class{constructor(e){this.compare=e}add(e,t){return e?Array.isArray(e)?Te(this.compare,e,t):Me(this.compare,e,t):t}union(e,t){return e?Array.isArray(e)?t?Array.isArray(t)?function(e,t,r){const n=t.length,s=r.length;let o=0,a=0;const i=[];for(;o<n&&a<s;){const n=t[o],s=r[a],l=e(n,s);0===l?(o++,a++,i.push(n)):l<0?(o++,i.push(n)):(a++,i.push(s))}if(n===s&&o===n)return t;for(;o<n;)i.push(t[o++]);for(;a<s;)i.push(r[a++]);return i}(this.compare,e,t):Te(this.compare,e,t):e:t?Array.isArray(t)?Te(this.compare,[...t],e):Me(this.compare,t,e):e:t}find(e,t){if(e){if(Array.isArray(e))return Se(this.compare,e,t);if(0===this.compare(e,t))return e}}}((function(e,t){return(e.section.id-t.section.id||e.type!==t.type&&(0===e.type||0===t.type))&&e.type-t.type||e.id-t.id})),[wn]=Ie((()=>new Map)),[An]=Ie((()=>new Map));function kn(e,t,r){const n=e.node.extra??={},s=wn();return n.section=De(e),s.set(n,Ae(s.get(n),{binding:t,node:r})),n}function En(e){if(Array.isArray(e))for(const t of e)(t.extra??={}).pruned=!0;else(e.extra??={}).pruned=!0}function Sn(e){return e&&(e.property?e:e.upstreamAlias||e)}function Tn(e,t=[]){if(e.arguments)for(const r of e.arguments)t.push(r);for(const r of e.attributes)t.push(r.value);for(const r of e.body.attributeTags?e.body.body:e.attributeTags)switch(r.type){case"MarkoTag":Tn(r,t);break;case"MarkoScriptlet":for(const e of r.body)t.push(e)}return t}function Mn(e){return $().optimize?k.types.numericLiteral(e.id):k.types.stringLiteral(e.name+(0===e.type?`/${e.id}`:""))}function In(e){const{extra:t}=e;if(!t)return;let r,{binding:n,read:s}=t;if(s&&(void 0===s.props?(n=s.binding,s=void 0):n=void 0),n)"Identifier"===e.type?n.name!==e.name&&(e.name=n.name):r=k.types.identifier(n.name);else if(s&&(r=le(k.types.identifier(s.binding.name),Array.isArray(s.props)?s.props[0]:s.props),Array.isArray(s.props)))for(let e=1;e<s.props.length;e++)r=le(r,s.props[e]);return r&&nn(r,e)}function jn(e,t){let r=!t.downstreamExpressions.size;for(const n of t.aliases)jn(e,n)?t.aliases.delete(n):r=!1;for(const[n,s]of t.propertyAliases)jn(e,s)?t.propertyAliases.delete(n):r=!1;return r&&e.delete(t),r}function Cn(e,t,r){let n;if(Array.isArray(t))for(const e of t){let{binding:r}=e;if(e.node){const n=(e.node.extra??={}).read??=Pn(t,r,void 0);({binding:r}=(e.node.extra??={}).read=n)}n=xn.add(n,r)}else t&&(t.node&&((t.node.extra??={}).read=Bn(t.binding,void 0)),n=t.binding);if(Array.isArray(n)){const t=r.get(e.section)||[],s=Se(bn,t,n);s?n=s:r.set(e.section,Te(bn,t,n))}return n}function Pn(e,t,r){const{upstreamAlias:n}=t;if(n&&Array.isArray(e)){const o=(s=t).property??s.upstreamAlias?.property,a=void 0===o?r:Ae(r,o);for(const{binding:r}of e)if(r!==t){let t=n;for(;t;){if(r===t)return Pn(e,t,a);t=t.upstreamAlias}}}var s;return Bn(t,r)}function Bn(e,t){return{binding:e,props:t}}function Nn(e){switch(e.property.type){case"StringLiteral":return e.property.value;case"NumericLiteral":return""+e.property.value;case"Identifier":if(e.computed)return;return e.property.name}}function $n(e){return/^on[-A-Z][a-zA-Z0-9_$]|[a-zA-Z_$][a-zA-Z0-9_$]*Change$/.test(e)}function Dn(e){return!(!e||e.pruned||!e.section)}function On(e){return Dn(e)&&void 0!==e.assignment}function Fn(e){return Dn(e)&&void 0!==e.registerId}function Ln(e){if(e){if(!Array.isArray(e))return Un(e);for(const t of e)if(Un(t))return!0}return!1}function Un(e){switch(e.type){case 1:case 2:return!0;default:return!e.upstreamExpression||Ln(e.upstreamExpression.referencedBindings)}}var Rn={analyze(e){(0,x.assertNoVar)(e),(0,x.assertNoArgs)(e),g(e),(0,x.assertNoAttributeTags)(e);const{node:t}=e,[r]=t.attributes;if(!r)throw e.get("name").buildCodeFrameError("The `await` tag requires a value.");if(t.attributes.length>1||!v.types.isMarkoAttribute(r)||"value"!==r.name)throw e.get("name").buildCodeFrameError("The `await` tag only supports the `value` attribute.");if(!t.body.body.length)throw e.get("name").buildCodeFrameError("The `await` tag requires body content.");if(t.body.params.length&&(t.body.params.length>1||v.types.isSpreadElement(t.body.params[0])))throw e.get("name").buildCodeFrameError("The `await` tag only supports a single parameter.");De(e),pn(e.get("body"),4,void 0,A(r.value))},translate:lt({html:{enter(e){const t=Oe(e.get("body"));t?(Re(t,!0),Ct(e)):e.remove()},exit(e){const{node:t}=e,[r]=t.attributes,n=e.get("body"),s=Oe(n);(Ln(r.extra?.referencedBindings)||Ze(s,!0))&&ar(s),Pt(e),Pr(n),e.replaceWith(v.types.expressionStatement(de("fork",r.value,v.types.arrowFunctionExpression(t.body.params,Gt(t.body.body)))))[0].skip()}},dom:{enter(e){const t=Oe(e.get("body"));t?Re(t,!0):e.remove()},exit(e){e.remove()}}}),attributes:{},autocomplete:[{description:"Use to consume asynchronous an data.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#await"}],types:f.name+"/tag-types/await.d.marko"},_n=r("../../browser-shims/compiler/index.js"),zn=r("../../browser-shims/compiler/babel-utils.js"),Wn={parse(e){const{node:t,hub:{file:r}}=e,n=t.rawValue,s=n.replace(/^client\s*/,"").trim(),o=t.name.start+(n.length-s.length);let a=(0,zn.parseStatements)(r,s,o,o+s.length);1===a.length&&_n.types.isBlockStatement(a[0])&&(a=a[0].body),e.replaceWith(_n.types.markoScriptlet(a,!0,"client"))},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:"client <statement>",description:"A JavaScript statement which is only evaluated once your template is loaded on the client.",descriptionMoreURL:"https://markojs.com/docs/syntax/#client-javascript"}]},Vn=r("../../browser-shims/compiler/index.js"),qn=r("../../browser-shims/compiler/babel-utils.js"),Jn=r("../../browser-shims/compiler/index.js");function Zn(e,t,r="const"){const{node:{var:n}}=e;n&&e.insertBefore(Jn.types.variableDeclaration(r,[Jn.types.variableDeclarator(n,t)]))}var Gn={analyze(e){(0,qn.assertNoArgs)(e),(0,qn.assertNoParams)(e),b(e);const{node:t}=e,[r]=t.attributes;if(!t.var)throw e.get("name").buildCodeFrameError("The `const` tag requires a tag variable.");if(!r)throw e.get("name").buildCodeFrameError("The `const` tag requires a value.");if(t.attributes.length>1||!Vn.types.isMarkoAttribute(r)||!r.default&&"value"!==r.name)throw e.get("name").buildCodeFrameError("The `const` tag only supports the `value` attribute.");const n=Vn.types.isIdentifier(r.value)?e.scope.getBinding(r.value.name)?.identifier.extra?.binding:void 0;cn(e,4,n,A(r.value))},translate:{exit(e){const{node:t}=e,[r]=t.attributes,{value:n}=r;if(N()){const r=Fe(e),s=t.var.extra?.binding;if(s&&!s.upstreamAlias){const e=pr(s);wr(r,n.extra?.referencedBindings,e,n)}}else Zn(e,n);e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Use to create an constant binding.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#const"}],types:f.name+"/tag-types/const.d.marko"},Kn=r("../../browser-shims/compiler/index.js"),Xn=r("../../browser-shims/compiler/babel-utils.js"),Yn={analyze(e){const[t]=e.node.attributes;if((0,Xn.assertNoVar)(e),(0,Xn.assertNoArgs)(e),(0,Xn.assertNoParams)(e),b(e),e.node.attributes.length>1||1===e.node.attributes.length&&(!Kn.types.isMarkoAttribute(t)||!t.default&&"value"!==t.name))throw e.get("name").buildCodeFrameError("The `debug` tag only supports the `value` attribute.")},translate:{exit(e){const t=Fe(e),[r]=e.node.attributes,n=r?.value.extra?.referencedBindings,s=nn(Kn.types.debuggerStatement(),e.node);B()?e.insertBefore(s):hr("render",t,n,s),e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Debug on value change.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#debug"}],types:f.name+"/tag-types/debug.d.marko"},Hn=(r("../../browser-shims/compiler/index.js"),r("../../browser-shims/compiler/babel-utils.js")),Qn=r("../../browser-shims/compiler/index.js"),es=r("../../browser-shims/compiler/babel-utils.js");function ts(e){const t="MarkoTagBody"===e.parent.type?e.parentPath.parentPath:e.parentPath;if("MarkoTag"===t.type)return t}var rs=new WeakMap;function ns(e){let t=rs.get(e);return t||(t=Vr.scope.generateUid(e.name),rs.set(e,t)),Qn.types.identifier(t)}function ss(e){if(e.node.extra?.attributeTags)return e.node.extra.attributeTags;const t=e.node.body.attributeTags?e.get("body").get("body"):e.get("attributeTags");if(!t.length)return;const r=(e.node.extra??={}).attributeTags={},n={},s=new Map;for(const e of t)if(e.isMarkoTag())if((0,es.isAttributeTag)(e)){const t=be(e);r[t]||=os(t,[t]),ss(e)}else{const t=(0,es.isLoopTag)(e);let o;for(const a of as(e,n)){const n=r[a];if(n)if(o){if(o!==n.group)for(const e of n.group)r[e].group=o,o.push(e)}else o=n.group;let i=r[a];i||(i=r[a]=os(a,[]),o=i.group,o.push(a)),i.dynamic=!0,t&&(i.repeated=!0),s.set(e,a)}}for(const[e,t]of s)(e.node.extra??={}).attributeTagGroup=r[t].group;for(const e in n){const t=r[e];if(!t.repeated){const r=n[e];r.length>1&&(t.repeated=!t.dynamic||is(r))}}return r}function os(e,t){return{name:e.slice(1),dynamic:!1,repeated:!1,group:t}}function as(e,t,r=new Set){const n=e.node.body.attributeTags?e.get("body").get("body"):e.get("attributeTags");for(const e of n)if(e.isMarkoTag())if((0,es.isAttributeTag)(e)){const n=be(e);r.add(n),(t[n]||=[]).push(e),ss(e)}else as(e,t,r);return r}function is(e){let t;const r=new Set;for(const n of e){const e=ts(n);if(r.has(e)||!we(e))return!0;const s=ls(e);if(s&&s!==(t||=s))return!0;r.add(e)}return!1}function ls(e){if("if"===be(e))return e;let t=e.getPrevSibling();for(;t.node;){if(t.isMarkoTag()&&"if"===be(t))return t;t=t.getPrevSibling()}}var cs=r("../../browser-shims/compiler/index.js"),ps=r("../../browser-shims/compiler/babel-utils.js"),ds=r("../../browser-shims/compiler/index.js"),us=r("../../browser-shims/compiler/babel-utils.js"),fs=r("../../browser-shims/compiler/index.js"),ms=r("../../browser-shims/compiler/babel-utils.js"),ys=Symbol("native tag binding"),gs=Symbol("serialize marker"),bs=Symbol("node getter id"),hs=new WeakMap;function vs(e,t){switch(e){case"input":if(t.checked||t.checkedChange)return{special:!1,helper:"controllable_input_checked",attrs:[t.checked,t.checkedChange]};if(t.checkedValue||t.checkedValueChange)return{special:!0,helper:"controllable_input_checkedValue",attrs:[t.checkedValue,t.checkedValueChange,t.value]};if(t.value||t.valueChange)return{special:!1,helper:"controllable_input_value",attrs:[t.value,t.valueChange]};break;case"select":if(t.value||t.valueChange)return{special:!0,helper:"controllable_select_value",attrs:[t.value,t.valueChange]};break;case"textarea":if(t.value||t.valueChange)return{special:!0,helper:"controllable_textarea_value",attrs:[t.value,t.valueChange]};break;case"details":case"dialog":if(t.open||t.openChange)return{special:!1,helper:"controllable_detailsOrDialog_open",attrs:[t.open,t.openChange]}}}var xs={transform:{enter(e){if("textarea"===be(e)&&e.node.body.body.length){const t=[];for(const r of e.node.body.body){if(!("MarkoText"===r.type||"MarkoPlaceholder"===r.type&&r.escape))throw e.hub.file.hub.buildError(r,"Unexpected content in textarea, only text and placeholders are supported.",SyntaxError);t.push(r.value)}e.node.attributes.push(fs.types.markoAttribute("value",dt(t)||ws())),e.node.body.body=[]}}},analyze:{enter(e){(0,ms.assertNoArgs)(e),(0,ms.assertNoParams)(e),(0,ms.assertNoAttributeTags)(e);const{node:t}=e;if(t.var&&!fs.types.isIdentifier(t.var))throw e.get("var").buildCodeFrameError("Tag variables on native elements cannot be destructured.");const r=be(e),n=De(e);let s=!1,o=!1;const a={},{attributes:i}=e.node;let l,c;for(let e=i.length;e--;){const t=i[e];if(fs.types.isMarkoAttribute(t)){if(a[t.name]){En(t.value);continue}a[t.name]=t,_(t.name)||(p=t.name,/^(?:value|checked(?:Value)?|open)Change/.test(p))?((t.value.extra??={}).isEffect=!0,s=!0):A(t.value).confident||(o=!0)}else fs.types.isMarkoSpreadAttribute(t)&&(s=!0,o=!0,(t.value.extra??={}).isEffect=!0);c?c.push(t.value):fs.types.isMarkoSpreadAttribute(t)&&(c=[t.value],l=vs(r,a))}var p;if(function(e,t){const r=[t.open||t.openChange,t.checked||t.checkedChange,t.checkedValue||t.checkedValueChange,t.valueChange].filter(Boolean);if(r.length>1)throw e.get("name").buildCodeFrameError(`The attributes ${r.map((e=>`"${e.name}"`)).join(", ")} are mutually exclusive.`)}(e,a),c){if(l&&!l.attrs.every(Boolean)){for(const e of l.attrs)e&&c.push(e.value);l=void 0}gn(n,e.node,c)}else l=vs(r,a);if(l&&gn(n,l.attrs.find(Boolean).value,l.attrs.map((e=>e?.value))),t.var||s||o){Vr.node.extra.isInteractive||=s;const r="StringLiteral"===t.name.type?t.name.value:fs.types.toIdentifier(e.get("name")),o=t.extra??={},a="#"+r;if(o[gs]=s||!!t.var,o[ys]=ln(a,0,n),t.var)for(const r of e.scope.getBinding(t.var.name).referencePaths)if(un(r),!As(r)){o[bs]=Er(n,a);break}}}},translate:{enter(e){const t=be(e),r=e.node.extra,n=r[ys],s=B(),o=e.get("name"),a=(0,ms.getTagDef)(e),i=It(e),l=Fe(e);if(s&&r.tagNameNullable&&Ct(e),e.has("var")){const t=r[bs];if(s){const r=e.node.var.name,n=e.scope.getBinding(r).referencePaths;for(const e of n){let t=Fe(e);for(;t!==l&&t.parent;)ir(t).set(fs.types.stringLiteral("_"),de("ensureScopeWithId",Le(t=t.parent)))}Zn(e,de("nodeRef",t&&Le(l),t&&fs.types.stringLiteral(t)))}else{const r=e.node.var.name,s=e.scope.getBinding(r).referencePaths;let o;t&&(o=Vr.scope.generateUidIdentifier(`get_${r}`),Vr.pushContainer("body",fs.types.variableDeclaration("const",[fs.types.variableDeclarator(o,de("nodeRef",fs.types.stringLiteral(t),Mn(n)))])));for(const t of s){const r=Fe(t);As(t)?t.parentPath.replaceWith(fs.types.expressionStatement(Vt(r,n))):o&&t.replaceWith(fs.types.callExpression(o,[Wt(r,Fe(e))]))}}}let c;n&&(c=Mn(n),At(e,32)),i`<${o.node}`;const p=function(e,t){const r={},{attributes:n}=t,s=new Set;let o,a,i,l,c;for(let t=n.length;t--;){const o=n[t],{value:a}=o;if(fs.types.isMarkoSpreadAttribute(o)){if(!i&&(i=[],c=vs(e,r),c&&!c.attrs.every(Boolean))){for(const e of c.attrs)e&&(i.push(ie(e.name,e.value)),s.delete(e));c=void 0}i.push(fs.types.spreadElement(a))}else r[o.name]||(r[o.name]=o,i?i.push(ie(o.name,o.value)):s.add(o))}if(i||(c=vs(e,r),!1!==c?.special||c.attrs[1]||(c=void 0)),c)for(const e of c.attrs)e&&s.delete(e);const p=[...s].reverse();if(i){if(i.reverse(),c)for(const e of c.attrs)e&&(l||=[]).push(ie(e.name,fs.types.numericLiteral(1)));for(const{name:e}of p)(l||=[]).push(ie(e,fs.types.numericLiteral(1)));l&&(a=fs.types.objectExpression(l)),o=$s(i)}return{staticAttrs:p,staticControllable:c,spreadExpression:o,skipExpression:a}}(t,e.node),{staticAttrs:d,staticControllable:u,skipExpression:f}=p;let m,{spreadExpression:y}=p;if(u){const{helper:e,attrs:r}=u,n=r.find(Boolean),o=n.value.extra?.referencedBindings,a=r.map((e=>e?.value));s?("select"!==t&&"textarea"!==t&&i`${de(e,Le(l),c,...a)}`,Cr(l,void 0)):(hr("render",l,o,fs.types.expressionStatement(de(e,Jr,c,...a))),hr("effect",l,void 0,fs.types.expressionStatement(de(`${e}_effect`,Jr,c))))}if(s)if("select"===t){if(u)hs.set(e.node,{value:u.attrs[0]?.value||ws(),valueChange:u.attrs[1]?.value||ws()});else if(y){const t=e.scope.generateUidIdentifier("select_input");e.insertBefore(fs.types.variableDeclaration("const",[fs.types.variableDeclarator(t,y)])),hs.set(e.node,{value:fs.types.memberExpression(t,fs.types.identifier("value")),valueChange:fs.types.memberExpression(t,fs.types.identifier("valueChange"))}),y=t}}else if("textarea"===t){let t,r;if(u)t=u.attrs[0]?.value,r=u.attrs[1]?.value;else if(y){const n=e.scope.generateUidIdentifier("textarea_input");e.insertBefore(fs.types.variableDeclaration("const",[fs.types.variableDeclarator(n,y)])),t=fs.types.memberExpression(n,fs.types.identifier("value")),r=fs.types.memberExpression(n,fs.types.identifier("valueChange")),y=n}(t||r)&&(m=de("controllable_textarea_value",Le(Fe(e)),Mn(n),t,r))}for(const e of d){const{name:r,value:n}=e,{confident:o,computed:a}=n.extra||{},p=n.extra?.referencedBindings;if(s&&"option"===t&&"value"===r)i`${de("optionValueAttr",n)}`;else switch(r){case"class":case"style":{const e=`${r}Attr`;o?i`${ue()[e](a)}`:s?i`${de(e,n)}`:hr("render",l,p,fs.types.expressionStatement(de(e,fs.types.memberExpression(Jr,c,!0),n)));break}default:o?i`${ue().attr(r,a)}`:s?_(r)?Cr(l,p):i`${de("attr",fs.types.stringLiteral(r),n)}`:_(r)?hr("effect",l,p,fs.types.expressionStatement(de("on",fs.types.memberExpression(Jr,c,!0),fs.types.stringLiteral(z(r)),n))):hr("render",l,p,fs.types.expressionStatement(de("attr",fs.types.memberExpression(Jr,c,!0),fs.types.stringLiteral(r),n)))}}if(y&&(s?(Cr(l,r.referencedBindings),f?i`${de("partialAttrs",y,f,c,Le(l),o.node)}`:i`${de("attrs",y,c,Le(l),o.node)}`):(hr("render",l,r.referencedBindings,f?fs.types.expressionStatement(de("partialAttrs",Jr,c,y,f)):fs.types.expressionStatement(de("attrs",Jr,c,y))),hr("effect",l,r.referencedBindings,fs.types.expressionStatement(de("attrsEvents",Jr,c)),!1))),a&&a.parseOptions?.openTagOnly)switch(a.htmlType){case"svg":case"math":i`/>`;break;default:i`>`}else i`>`;s&&r.tagNameNullable&&e.insertBefore(fs.types.ifStatement(o.node,jt(e)))[0].skip(),m&&i`${m}`,vt(e)},exit(e){const t=e.node.extra,r=t[ys],n=B(),s=(0,ms.getTagDef)(e)?.parseOptions?.openTagOnly,o=n&&hs.get(e.node),a=be(e);n&&t.tagNameNullable&&Pt(e),o?(It(e)`</${e.node.name}>`,Pt(e),e.insertBefore(fs.types.expressionStatement(de("controllable_select_value",Le(Fe(e)),Mn(r),o.value,o.valueChange,fs.types.arrowFunctionExpression([],fs.types.blockStatement(e.node.body.body)))))):e.insertBefore(e.node.body.body).forEach((e=>e.skip())),s||o||It(e,n&&("html"===a||"body"===a))`</${e.node.name}>`,n&&t.tagNameNullable&&e.insertBefore(fs.types.ifStatement(e.node.name,jt(e)))[0].skip(),r&&(t[gs]||Ln(t.referencedBindings)||e.node.attributes.some((e=>Ln(e.value.extra?.referencedBindings))))&&Nt(e,r),xt(e),e.remove()}}};function ws(){return fs.types.unaryExpression("void",fs.types.numericLiteral(0))}function As(e){const{parent:t,node:r}=e;return"CallExpression"===t.type&&t.callee===r}var ks=Symbol("for marker binding"),Es=Symbol("only child in parent"),Ss={analyze(e){const t=e.node.extra??={},r=e.node.body.attributeTags;let n;switch((0,us.assertNoVar)(e),(0,us.assertNoArgs)(e),g(e),Ts(e.node)){case"of":n=["of"];break;case"in":n=["in"];break;case"to":n=["to","from","step"];break;default:throw e.buildCodeFrameError("Invalid `for` tag, missing an `of=`, `in=`, `to=` attribute.")}if(r||n.push("by"),(0,us.assertAllowedAttributes)(e,n),r)return;const s=e.get("body"),o=$e(s);if(!o)return void En(Tn(e.node));o.isBranch=!0;const a=De(e);if(js(e)){const t=ts(e).node,r=t.name?.value;(t.extra??={})[ys]??=ln("#"+r,0,a)}else t[ks]=ln("#text",0,a);pn(s,3,void 0,t),gn(a,e.node,Tn(e.node)),o.upstreamExpression=t},translate:lt({html:{enter(e){if(e.node.body.attributeTags)return;const t=Oe(e.get("body"));t?(Re(t,!0),js(e)||(At(e,37),wt(e)),Ct(e)):e.remove()},exit(e){if(e.node.body.attributeTags)return;const t=e.get("body"),r=Fe(e),n=Oe(t),{node:s}=e,o=Ln(s.extra.referencedBindings),a=ts(e),i=js(e)?a.node.extra[ys]:e.node.extra[ks],l=rt(s),c=Ts(s),p=s.body.params,d=[],u=s.body.body,f=Ze(n,!0),m=null===n.content||n.content.singleChild;let y;if(o&&js(e)&&(a.node.extra[gs]=!0),o||f){const e={of:["list","index"],in:["key","value"],to:["value"]}[c],t="of"===c?1:0,s=l.by?e.length-1:t;ar(n);for(let t=0;t<=s;t++){const r=p[t];if(!r||!ds.types.isIdentifier(r)){const n=p[t]=Vr.scope.generateUidIdentifier(e[t]);r&&u.unshift(ds.types.variableDeclaration("let",[ds.types.variableDeclarator(r,n)]))}}if(l.by)if(ds.types.isStringLiteral(l.by))y=le(p[0],l.by.value);else if(ds.types.isFunction(l.by)){const e=Vr.scope.generateUidIdentifier("by");d.push(ds.types.variableDeclaration("const",[ds.types.variableDeclarator(e,l.by)])),y=ds.types.callExpression(e,p)}else y=de(function(e){switch(e){case"of":return"forOfBy";case"in":return"forInBy";case"to":return"forToBy"}}(c),l.by,...p);else y=p[t];const a=ze(n);d.push(ds.types.variableDeclaration("const",[ds.types.variableDeclarator(a,ds.types.newExpression(ds.types.identifier("Map"),[]))])),y&&(o||f)&&u.push(ds.types.expressionStatement(ds.types.callExpression(ds.types.memberExpression(ze(n),ds.types.identifier("set")),[y,de("ensureScopeWithId",Le(n))]))),ir(r).set(ds.types.stringLiteral(Mn(i).value+"("),ds.types.conditionalExpression(ds.types.memberExpression(a,ds.types.identifier("size")),a,ds.types.identifier("undefined")))}Pt(e),nr(e,(()=>{})),Pr(t);const g=Is(c,l),b=o?function(e,t){if(t)switch(e){case"of":return"resumeSingleNodeForOf";case"in":return"resumeSingleNodeForIn";case"to":return"resumeSingleNodeForTo"}else switch(e){case"of":return"resumeForOf";case"in":return"resumeForIn";case"to":return"resumeForTo"}}(c,m):Ms(c);g.push(ds.types.arrowFunctionExpression(p,ds.types.blockStatement(u))),o&&g.push(Le(r),Mn(i)),d.push(ds.types.expressionStatement(de(b,...g)));for(const t of e.replaceWithMultiple(d))t.skip()}},dom:{enter(e){if(e.node.body.attributeTags)return;const t=Oe(e.get("body"));t?(Re(t,!0),js(e)||(At(e,37),wt(e))):e.remove()},exit(e){if(e.node.body.attributeTags)return;const t=e.get("body"),r=Fe(e),n=Oe(t),{node:s}=e,o=s.extra,{referencedBindings:a}=o,i=js(e)?ts(e).node.extra[ys]:e.node.extra[ks];nr(e,((e,t,r)=>de("loopClosure",Mn(i),t,r)));const l=Ts(s),c=cr(r,i,"for");c.build=()=>de(function(e){switch(e){case"of":return"loopOf";case"in":return"loopIn";case"to":return"loopTo"}}(l),Mn(i),ds.types.identifier(n.name));const p=s.body.params;c.hasDownstreamIntersections=()=>{if(n.closures)return!0;for(const e of p){const t=e.extra?.binding;if(t)for(const{referencedBindings:e}of t.downstreamExpressions)if(cr(n,e).hasDownstreamIntersections())return!0}return!1};const d=rt(s),u=Is(l,d);d.by&&u.push(d.by),wr(r,a,c,ds.types.arrayExpression(u)),e.remove()}}}),parseOptions:{controlFlow:!0},attributes:{of:{type:"expression",autocomplete:[{description:"Iterates over a list of items."}]},in:{type:"expression",autocomplete:[{description:"Iterates over the keys and values of an object."}]},to:{type:"number",autocomplete:[{description:"Iterates up to the provided number (inclusive)"}]},from:{type:"number",autocomplete:[{description:"Iterates starting from the provided number (inclusive)"}]},step:{type:"number",autocomplete:[{description:"The amount to increment during each interation (with from/to)"}]}},autocomplete:[{snippet:"for|${1:value, index}| of=${3:array}",description:"Use to iterate over lists, object properties, or between ranges.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#iterating-over-a-list"},{snippet:"for|${1:name, value}| in=${3:object}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#iterating-over-an-objects-properties"},{snippet:"for|${1:index}| to=${2:number}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#iterating-between-a-range-of-numbers"}]};function Ts(e){for(const t of e.attributes)if("MarkoAttribute"===t.type)switch(t.name){case"of":case"in":case"to":return t.name}}function Ms(e){switch(e){case"of":return"forOf";case"in":return"forIn";case"to":return"forTo"}}function Is(e,t){switch(e){case"in":return[t.in];case"of":return[t.of];case"to":return[t.to,t.from||ds.types.numericLiteral(0),t.step||ds.types.numericLiteral(1)]}}function js(e){const t=e.node.extra;if(void 0!==t[Es])return t[Es];const r=ts(e);return r&&(0,us.getTagDef)(r)?.html?t[Es]=1===e.parent.body.length:t[Es]=!1}var Cs=new WeakSet;function Ps(e,t,r=[],n="content"){const s=new Set,o=[],a=e.node.extra?.attributeTags;if(a){for(const e in a){const n=a[e];Os(t,n.name)&&(s.add(n.name),n.dynamic&&(r.push(cs.types.variableDeclaration("let",[cs.types.variableDeclarator(ns(n))])),o.push(ie(n.name,ns(n)))))}const i=e.node.body.attributeTags?e.get("body").get("body"):e.get("attributeTags");for(let e=0;e<i.length;e++){const s=i[e];if(s.isMarkoTag())if((0,ps.isAttributeTag)(s)){const l=a[be(s)];if(l.dynamic)e=Ns(i,e,a,r,t,n);else{const e=Ps(s,t?.[l.name]?.props,r,n);if(l.repeated){const t=Fs(l.name,o);t?t.value=de("attrTags",t.value,$s(e.properties)):o.push(ie(l.name,de("attrTag",$s(e.properties))))}else o.push(ie(l.name,de("attrTag",$s(e.properties))))}}else e=Ns(i,e,a,r,t,n)}}if(!s.has(n)&&Os(t,n)){s.add(n);const t=function(e){const t=e.node.extra?.section;if(t)return B()?de("register",de("createRenderer",cs.types.arrowFunctionExpression(e.node.params,cs.types.blockStatement(e.node.body))),cs.types.stringLiteral(Ar(t,"renderer")),Le(Fe(function(e){let t=e;for(;(0,ps.isAttributeTag)(t)||(0,ps.isTransparentTag)(t);)t=ts(t);return t}(e.parentPath)))):cs.types.callExpression(cs.types.identifier(t.name),[Jr])}(e.get("body"));if(t){const e=cs.types.objectProperty(cs.types.identifier(n),t);Cs.add(e),o.push(e)}}const{attributes:i}=e.node;for(let e=i.length;e--;){const r=i[e],{value:n}=r;cs.types.isMarkoSpreadAttribute(r)?o.push(cs.types.spreadElement(n)):!s.has(r.name)&&Os(t,r.name)&&(s.add(r.name),o.push(ie(r.name,n)))}return o.reverse(),{properties:o,statements:r}}function Bs(e){for(const t of e)if(Cs.has(t))return t}function Ns(e,t,r,n,s,o="content"){const a=e[t];if(a.isMarkoTag())if((0,ps.isAttributeTag)(a)){const e=r[be(a)];if(Os(s,e.name)&&e.dynamic){const t=Ps(a,s?.[e.name]?.props,n,o);e.repeated?n.push(cs.types.expressionStatement(cs.types.assignmentExpression("=",ns(e),de("attrTags",ns(e),$s(t.properties))))):n.push(cs.types.expressionStatement(cs.types.assignmentExpression("=",ns(e),de("attrTag",$s(t.properties)))))}}else switch(be(a)){case"if":return function(e,t,r,n,s,o){const a=e[t],i=[];let l=cs.types.ifStatement(Ls(a),cs.types.blockStatement(i));n.push(l),Ds(a,r,i,s,o);let c=t+1;for(;c<e.length;){const t=e[c];if(t.isMarkoTag())switch(be(t)){case"else-if":case"else":{const e=Ls(t),n=[];if(Ds(t,r,n,s,o),e){l.alternate=l=cs.types.ifStatement(e,cs.types.blockStatement(n)),c++;continue}l.alternate=cs.types.blockStatement(n);break}}break}return c-1}(e,t,r,n,s,o);case"for":return function(e,t,r,n,s,o){const a=e[t],i=[];return Ds(a,r,i,s,o),n.push(function(e,t,r,n){return ds.types.expressionStatement(de(Ms(e),...Is(e,t),ds.types.arrowFunctionExpression(r,ds.types.blockStatement(n))))}(Ts(a.node),rt(a.node),a.node.body.params,i)),t}(e,t,r,n,s,o)}return t}function $s(e){return 1===e.length&&cs.types.isSpreadElement(e[0])?e[0].argument:cs.types.objectExpression(e)}function Ds(e,t,r,n,s){const o=e.node.body.attributeTags?e.get("body").get("body"):e.get("attributeTags");for(let e=0;e<o.length;e++)e=Ns(o,e,t,r,n,s)}function Os(e,t){return!e||!!e[t]}function Fs(e,t){for(const r of t)if("ObjectProperty"===r.type)switch(r.key.type){case"StringLiteral":if(r.key.value===e)return r;break;case"Identifier":if(r.key.name===e)return r}return!1}function Ls({node:{attributes:e}}){return 1===e.length?e[0].value:void 0}var Us={analyze(e){if((0,Hn.assertNoArgs)(e),!e.node.var)throw e.get("name").buildCodeFrameError("The `define` tag requires a tag variable.");const t=e.get("body");$e(t),cn(e,4),pn(t,3),ss(e),gn(De(e),e.node,Tn(e.node))},translate:{enter(e){B()&&Ct(e)},exit(e){const{node:t}=e,r=Ps(e);if(B())Pt(e),Pr(e.get("body")),e.insertBefore(r.statements),Zn(e,$s(r.properties));else{const n=Fe(e),s=t.extra?.referencedBindings,o=pr(e.get("var").node.extra.binding);r.statements.length&&hr("render",n,s,r.statements),wr(n,s,o,$s(r.properties))}e.remove()}},attributes:{},autocomplete:[{description:"Use to create a constant object binding that can be rendered.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#define"}],types:f.name+"/tag-types/define.d.marko"},Rs=r("../../browser-shims/compiler/index.js"),_s=r("../../browser-shims/compiler/babel-utils.js"),zs={migrate:[e=>{(0,_s.assertNoArgs)(e),(0,_s.assertNoParams)(e),b(e),(0,_s.assertNoAttributeTags)(e),g(e),(0,_s.assertAllowedAttributes)(e,["value"]),(0,_s.diagnosticDeprecate)(e,{label:"The 'effect' tag has been replaced by the 'script' tag.",fix(){const{node:t}=e;e.replaceWith(Rs.types.markoTag(nn(Rs.types.stringLiteral("script"),t.name),t.attributes,t.body,t.arguments,t.var,t.attributeTags))}})}],attributes:{},types:f.name+"/tag-types/effect.d.marko"},Ws=r("../../browser-shims/compiler/babel-utils.js"),Vs={parse(e){const{node:t}=e;e.replaceWith((0,Ws.parseStatements)(e.hub.file,t.rawValue,t.start,t.end)[0])},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:"export <value>"}]},qs=r("../../browser-shims/compiler/index.js"),Js=r("../../browser-shims/compiler/babel-utils.js"),Zs=Symbol("comment tag binding"),Gs=Symbol("node getter id"),Ks={analyze(e){(0,Js.assertNoArgs)(e),(0,Js.assertNoParams)(e),(0,Js.assertNoAttributes)(e);const t=e.node.var;let r=!1,n=!1;if(t){if(!qs.types.isIdentifier(t))throw e.get("var").buildCodeFrameError("The `html-comment` tag variable cannot be destructured.");r=!0;for(const r of e.scope.getBinding(t.name).referencePaths)if(!r.parentPath?.isCallExpression()){n=!0;break}}const s=[];for(const t of e.get("body").get("body"))if(t.isMarkoPlaceholder())s.push(t.node.value),r=!0;else if(!t.isMarkoText())throw t.buildCodeFrameError("Invalid child. Only text is allowed inside an html comment.");if(r){const t=De(e),r=e.node.extra??={};n&&(r[Gs]=Er(t,"comment")),r[Zs]=ln("#comment",0,t),gn(t,e.node,s)}e.skip()},translate(e){const t=e.node.extra,r=t[Zs];if(e.node.var){const n=t[Gs];if(B())Zn(e,de("nodeRef",n&&Le(Fe(e)),n&&qs.types.stringLiteral(n)));else{const t=e.node.var.name,s=e.scope.getBinding(t).referencePaths;let o;n&&(o=Vr.scope.generateUidIdentifier(`get_${t}`),Vr.pushContainer("body",qs.types.variableDeclaration("const",[qs.types.variableDeclarator(o,de("nodeRef",qs.types.stringLiteral(n),Mn(r)))])));for(const t of s){const n=Fe(t);t.parentPath?.isCallExpression()?t.parentPath.replaceWith(qs.types.expressionStatement(Vt(n,r))):o&&t.replaceWith(qs.types.callExpression(o,[Wt(n,Fe(e))]))}}}t[Zs]&&At(e,32);const n=It(e);if(vt(e),n`<!--`,B())for(const t of e.node.body.body)qs.types.isMarkoText(t)?n`${t.value}`:qs.types.isMarkoPlaceholder(t)&&n`${de("escapeXML",t.value)}`;else{const s=[],o=[];let a="";for(const t of e.node.body.body)qs.types.isMarkoText(t)?a+=t.value:qs.types.isMarkoPlaceholder(t)&&(s.push(qs.types.templateElement({raw:a})),o.push(t.value),a="");0===o.length?n`${a}`:(s.push(qs.types.templateElement({raw:a})),hr("render",Fe(e),t.referencedBindings,qs.types.expressionStatement(de("data",qs.types.memberExpression(Jr,Mn(r),!0),qs.types.templateLiteral(s,o)))))}xt(e),n`-->`,r&&Nt(e,r),e.remove()},parseOptions:{text:!0},attributes:{},autocomplete:[{description:"Use to create an html comment that is not stripped from the output.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#html-comment"}]},Xs=r("../../browser-shims/compiler/index.js"),Ys=r("../../browser-shims/compiler/babel-utils.js"),Hs=Symbol("node getter id"),Qs={analyze(e){(0,Ys.assertNoArgs)(e),(0,Ys.assertNoParams)(e);const{node:t}=e;if(t.var&&!Xs.types.isIdentifier(t.var))throw e.get("var").buildCodeFrameError("Tag variables on native elements cannot be destructured.");const r=De(e);let n=!1,s=!1;const o={},{attributes:a}=e.node;let i;for(let e=a.length;e--;){const t=a[e];if(Xs.types.isMarkoAttribute(t)){if(o[t.name]){En(t.value);continue}o[t.name]=t,_(t.name)?((t.value.extra??={}).isEffect=!0,n=!0):A(t.value).confident||(s=!0)}else Xs.types.isMarkoSpreadAttribute(t)&&(n=!0,s=!0,(t.value.extra??={}).isEffect=!0);i?i.push(t.value):Xs.types.isMarkoSpreadAttribute(t)&&(i=[t.value])}i&&gn(r,e.node,i);const l=[];let c=!1;for(const t of e.node.body.body)if(Xs.types.isMarkoPlaceholder(t))l.push(t.value),c=!0;else if(!Xs.types.isMarkoText(t))throw e.hub.buildError(t,"Invalid child. Only text is allowed inside an html-script.");if(l.length>1&&gn(r,l[0],l.slice(1)),t.var||n||s||c){Vr.node.extra.isInteractive||=n;const s=t.extra??={},o="#script";if(s[gs]=n||!!t.var,s[ys]=ln(o,0,r),t.var)for(const n of e.scope.getBinding(t.var.name).referencePaths)if(!n.parentPath?.isCallExpression()){s[Hs]=Er(r,o);break}}},translate(e){const t=e.node.extra,r=t[ys],n=B(),s=It(e),o=Fe(e);if(e.node.var){const s=t[Hs];if(n){const t=e.node.var.name,r=e.scope.getBinding(t).referencePaths;for(const e of r){let t=Fe(e);for(;t!==o&&t.parent;)ir(t).set(Xs.types.stringLiteral("_"),de("ensureScopeWithId",Le(t=t.parent)))}Zn(e,de("nodeRef",s&&Le(o),s&&Xs.types.stringLiteral(s)))}else{const t=e.node.var.name,n=e.scope.getBinding(t).referencePaths;let o;s&&(o=Vr.scope.generateUidIdentifier(`get_${t}`),Vr.pushContainer("body",Xs.types.variableDeclaration("const",[Xs.types.variableDeclarator(o,de("nodeRef",Xs.types.stringLiteral(s),Mn(r)))])));for(const t of n){const n=Fe(t);t.parentPath?.isCallExpression()?t.parentPath.replaceWith(Xs.types.expressionStatement(Vt(n,r))):o&&t.replaceWith(Xs.types.callExpression(o,[Wt(n,Fe(e))]))}}}let a;r&&(a=Mn(r),At(e,32)),s`<script`;const i=function(e){const t={},{attributes:r}=e,n=new Set;let s,o,a,i;for(let e=r.length;e--;){const s=r[e],{value:o}=s;Xs.types.isMarkoSpreadAttribute(s)?(a||(a=[]),a.push(Xs.types.spreadElement(o))):t[s.name]||(t[s.name]=s,a?a.push(ie(s.name,s.value)):n.add(s))}const l=[...n].reverse();if(a){a.reverse();for(const{name:e}of l)(i||=[]).push(ie(e,Xs.types.numericLiteral(1)));i&&(o=Xs.types.objectExpression(i)),s=$s(a)}return{staticAttrs:l,spreadExpression:s,skipExpression:o}}(e.node),{staticAttrs:l,skipExpression:c,spreadExpression:p}=i;for(const e of l){const{name:t,value:r}=e,{confident:i,computed:l}=r.extra||{},c=r.extra?.referencedBindings;switch(t){case"class":case"style":{const e=`${t}Attr`;i?s`${ue()[e](l)}`:n?s`${de(e,r)}`:hr("render",o,c,Xs.types.expressionStatement(de(e,Xs.types.memberExpression(Jr,a,!0),r)));break}default:i?s`${ue().attr(t,l)}`:n?_(t)?Cr(o,c):s`${de("attr",Xs.types.stringLiteral(t),r)}`:_(t)?hr("effect",o,c,Xs.types.expressionStatement(de("on",Xs.types.memberExpression(Jr,a,!0),Xs.types.stringLiteral(z(t)),r))):hr("render",o,c,Xs.types.expressionStatement(de("attr",Xs.types.memberExpression(Jr,a,!0),Xs.types.stringLiteral(t),r)))}}if(p&&(n?(Cr(o,t.referencedBindings),c?s`${de("partialAttrs",p,c,a,Le(o),Xs.types.stringLiteral("script"))}`:s`${de("attrs",p,a,Le(o),Xs.types.stringLiteral("script"))}`):(hr("render",o,t.referencedBindings,c?Xs.types.expressionStatement(de("partialAttrs",Jr,a,p,c)):Xs.types.expressionStatement(de("attrs",Jr,a,p))),hr("effect",o,t.referencedBindings,Xs.types.expressionStatement(de("attrsEvents",Jr,a)),!1))),s`>`,vt(e),B())for(const t of e.node.body.body)Xs.types.isMarkoText(t)?s`${t.value}`:Xs.types.isMarkoPlaceholder(t)&&s`${de("escapeScript",t.value)}`;else{const t=[],r=[];let n,o="";for(const s of e.node.body.body)Xs.types.isMarkoText(s)?o+=s.value:Xs.types.isMarkoPlaceholder(s)&&(n||=s,t.push(Xs.types.templateElement({raw:o})),r.push(s.value),o="");n?(t.push(Xs.types.templateElement({raw:o})),hr("render",Fe(e),n.value.extra?.referencedBindings,Xs.types.expressionStatement(de("textContent",Xs.types.memberExpression(Jr,a,!0),Xs.types.templateLiteral(t,r))))):s`${o}`}s`</script>`,r&&Nt(e,r),xt(e),e.remove()},"@async":"#html-async","@crossorigin":"#html-crossorigin","@defer":"#html-defer","@integrity":"#html-integrity","@nomodule":"#html-nomodule","@nonce":"#html-nonce","@referrerpolicy":"#html-referrerpolicy","@src":"#html-src","@type":"#html-type","attribute-groups":["html-attributes"],parseOptions:{text:!0,preserveWhitespace:!0}},eo=r("../../browser-shims/compiler/index.js"),to=r("../../browser-shims/compiler/babel-utils.js"),ro=Symbol("node getter id"),no={analyze(e){(0,to.assertNoArgs)(e),(0,to.assertNoParams)(e);const{node:t}=e;if(t.var&&!eo.types.isIdentifier(t.var))throw e.get("var").buildCodeFrameError("Tag variables on native elements cannot be destructured.");const r=De(e);let n=!1,s=!1;const o={},{attributes:a}=e.node;let i;for(let e=a.length;e--;){const t=a[e];if(eo.types.isMarkoAttribute(t)){if(o[t.name]){En(t.value);continue}o[t.name]=t,_(t.name)?((t.value.extra??={}).isEffect=!0,n=!0):A(t.value).confident||(s=!0)}else eo.types.isMarkoSpreadAttribute(t)&&(n=!0,s=!0,(t.value.extra??={}).isEffect=!0);i?i.push(t.value):eo.types.isMarkoSpreadAttribute(t)&&(i=[t.value])}i&&gn(r,e.node,i);const l=[];let c=!1;for(const t of e.node.body.body)if(eo.types.isMarkoPlaceholder(t))l.push(t.value),c=!0;else if(!eo.types.isMarkoText(t))throw e.hub.buildError(t,"Invalid child. Only text is allowed inside an html-style.");if(l.length>1&&gn(r,l[0],l.slice(1)),t.var||n||s||c){Vr.node.extra.isInteractive||=n;const s=t.extra??={},o="#style";if(s[gs]=n||!!t.var,s[ys]=ln(o,0,r),t.var)for(const n of e.scope.getBinding(t.var.name).referencePaths)if(!n.parentPath?.isCallExpression()){s[ro]=Er(r,o);break}}},translate(e){const t=e.node.extra,r=t[ys],n=B(),s=It(e),o=Fe(e);if(e.node.var){const s=t[ro];if(n){const t=e.node.var.name,r=e.scope.getBinding(t).referencePaths;for(const e of r){let t=Fe(e);for(;t!==o&&t.parent;)ir(t).set(eo.types.stringLiteral("_"),de("ensureScopeWithId",Le(t=t.parent)))}Zn(e,de("nodeRef",s&&Le(o),s&&eo.types.stringLiteral(s)))}else{const t=e.node.var.name,n=e.scope.getBinding(t).referencePaths;let o;s&&(o=Vr.scope.generateUidIdentifier(`get_${t}`),Vr.pushContainer("body",eo.types.variableDeclaration("const",[eo.types.variableDeclarator(o,de("nodeRef",eo.types.stringLiteral(s),Mn(r)))])));for(const t of n){const n=Fe(t);t.parentPath?.isCallExpression()?t.parentPath.replaceWith(eo.types.expressionStatement(Vt(n,r))):o&&t.replaceWith(eo.types.callExpression(o,[Wt(n,Fe(e))]))}}}let a;r&&(a=Mn(r),At(e,32)),s`<style`;const i=function(e){const t={},{attributes:r}=e,n=new Set;let s,o,a,i;for(let e=r.length;e--;){const s=r[e],{value:o}=s;eo.types.isMarkoSpreadAttribute(s)?(a||(a=[]),a.push(eo.types.spreadElement(o))):t[s.name]||(t[s.name]=s,a?a.push(ie(s.name,s.value)):n.add(s))}const l=[...n].reverse();if(a){a.reverse();for(const{name:e}of l)(i||=[]).push(ie(e,eo.types.numericLiteral(1)));i&&(o=eo.types.objectExpression(i)),s=$s(a)}return{staticAttrs:l,spreadExpression:s,skipExpression:o}}(e.node),{staticAttrs:l,skipExpression:c,spreadExpression:p}=i;for(const e of l){const{name:t,value:r}=e,{confident:i,computed:l}=r.extra||{},c=r.extra?.referencedBindings;switch(t){case"class":case"style":{const e=`${t}Attr`;i?s`${ue()[e](l)}`:n?s`${de(e,r)}`:hr("render",o,c,eo.types.expressionStatement(de(e,eo.types.memberExpression(Jr,a,!0),r)));break}default:i?s`${ue().attr(t,l)}`:n?_(t)?Cr(o,c):s`${de("attr",eo.types.stringLiteral(t),r)}`:_(t)?hr("effect",o,c,eo.types.expressionStatement(de("on",eo.types.memberExpression(Jr,a,!0),eo.types.stringLiteral(z(t)),r))):hr("render",o,c,eo.types.expressionStatement(de("attr",eo.types.memberExpression(Jr,a,!0),eo.types.stringLiteral(t),r)))}}if(p&&(n?(Cr(o,t.referencedBindings),c?s`${de("partialAttrs",p,c,a,Le(o),eo.types.stringLiteral("style"))}`:s`${de("attrs",p,a,Le(o),eo.types.stringLiteral("style"))}`):(hr("render",o,t.referencedBindings,c?eo.types.expressionStatement(de("partialAttrs",Jr,a,p,c)):eo.types.expressionStatement(de("attrs",Jr,a,p))),hr("effect",o,t.referencedBindings,eo.types.expressionStatement(de("attrsEvents",Jr,a)),!1))),s`>`,vt(e),B())for(const t of e.node.body.body)eo.types.isMarkoText(t)?s`${t.value}`:eo.types.isMarkoPlaceholder(t)&&s`${de("escapeStyle",t.value)}`;else{const t=[],r=[];let n,o="";for(const s of e.node.body.body)eo.types.isMarkoText(s)?o+=s.value:eo.types.isMarkoPlaceholder(s)&&(n||=s,t.push(eo.types.templateElement({raw:o})),r.push(s.value),o="");n?(t.push(eo.types.templateElement({raw:o})),hr("render",Fe(e),n.value.extra?.referencedBindings,eo.types.expressionStatement(de("textContent",eo.types.memberExpression(Jr,a,!0),eo.types.templateLiteral(t,r))))):s`${o}`}s`</style>`,r&&Nt(e,r),xt(e),e.remove()},"@disabled":"#html-disabled","@media":"#html-media","@nonce":"#html-nonce","@type":"#html-type","attribute-groups":["html-attributes"],parseOptions:{text:!0,preserveWhitespace:!0}},so=r("../../browser-shims/compiler/index.js"),oo=r("../../browser-shims/compiler/babel-utils.js"),ao={analyze(e){(0,oo.assertNoArgs)(e),(0,oo.assertNoParams)(e),(0,oo.assertNoAttributes)(e),b(e),(0,oo.assertNoAttributeTags)(e);const{node:t}=e;if(!t.var)throw e.get("name").buildCodeFrameError("The `id` tag requires a tag variable.");if(!so.types.isIdentifier(t.var))throw e.get("var").buildCodeFrameError("The `id` tag cannot be destructured");cn(e,4)},translate:{exit(e){const{node:t}=e,r=B()?de("nextTagId"):de("nextTagId",Jr);if(B())e.replaceWith(so.types.variableDeclaration("const",[so.types.variableDeclarator(t.var,r)]));else{const n=pr(t.var.extra.binding);wr(Fe(e),void 0,n,r),e.remove()}}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{displayText:"id/<name>",description:"Use to create a unique identifier.",snippet:"id/${1:name}",descriptionMoreURL:"https://markojs.com/docs/core-tags/#id"}],types:f.name+"/tag-types/id.d.marko"},io=r("../../browser-shims/compiler/index.js"),lo=r("../../browser-shims/compiler/babel-utils.js"),co=r("../../browser-shims/compiler/index.js"),po=Symbol("if node binding"),uo=new WeakMap,fo={analyze(e){if(function(e){switch((0,lo.assertNoVar)(e),(0,lo.assertNoArgs)(e),(0,lo.assertNoParams)(e),function(e){if(!e.node.body.body.length&&!e.node.attributeTags.length)throw e.get("name").buildCodeFrameError(`The \`${be(e)}\` tag requires body content.`)}(e),g(e),be(e)){case"if":bo(e);break;case"else-if":bo(e),go(e);break;case"else":!function(e){const{node:t}=e,[r]=t.attributes;if(t.attributes.length>1||r&&"if"!==r.name){const r=t.attributes[1].loc?.start,n=t.attributes[t.attributes.length-1].loc?.end,s=`The \`${be(e)}\` tag only supports an \`if=\` attribute.`;throw null==r||null==n?e.get("name").buildCodeFrameError(s):e.hub.buildError({loc:{start:r,end:n}},s,Error)}}(e),go(e)}}(e),e.node.body.attributeTags)return;const[t,r]=ho(e,$e(e.get("body")));if(t){const[t]=r[0],n=t.node.extra??={},s=[];let o=!0;for(const[e,t]of r)t&&(t.isBranch=!0,t.upstreamExpression=n,null===t.content||t.content?.singleChild||(o=!1)),e.node.attributes.length&&s.push(e.node.attributes[0].value);const a=De(e);n[po]=ln("#text",0,a,void 0,n),n.singleNodeOptimization=o,gn(a,t.node,s)}},translate:lt({html:{enter(e){if(e.node.body.attributeTags)return;const t=Oe(e.get("body"));vo(e)&&At(e,37),wt(e),Ct(e),t&&Re(t,!0)},exit(e){if(e.node.body.attributeTags)return;const t=e.get("body"),r=Fe(e),n=Oe(t),[s,o]=ho(e,n),a=o[0][0].node.extra,i=a[po],l=Ln(a.referencedBindings),c=a.singleNodeOptimization,p=n&&Ze(n,!0);if(n&&((l||p)&&ar(n),Pt(e),nr(e,(()=>{})),Pr(t)),s){const t=e.getNextSibling(),n=e.scope.generateUidIdentifier("ifScopeId"),s=e.scope.generateUidIdentifier("ifRenderer");let a;for(let e=o.length;e--;){const[t,r]=o[e],i=t.node.body.body;if(r){const e=Ze(r,!0);l&&i.push(io.types.expressionStatement(de("register",io.types.assignmentExpression("=",s,de("createRenderer",io.types.arrowFunctionExpression([],io.types.blockStatement([])))),io.types.stringLiteral(Ar(r,"renderer"))))),(l||e)&&i.push(io.types.expressionStatement(io.types.assignmentExpression("=",n,Le(r))))}const[c]=t.node.attributes,p=(d=i,Array.isArray(d)?1===d.length?d[0]:co.types.blockStatement(d):d);a=c?io.types.ifStatement(c.value,p,a):p,t.remove()}if(l||p){if(l){ir(r).set(io.types.stringLiteral(Mn(i).value+"("),s);const e=io.types.arrowFunctionExpression([],io.types.blockStatement([a]));a=io.types.expressionStatement(de(c?"resumeSingleNodeConditional":"resumeConditional",e,Le(r),Mn(i)))}t.insertBefore([io.types.variableDeclaration("let",[io.types.variableDeclarator(n),l&&io.types.variableDeclarator(s)].filter(Boolean)),a]),ir(r).set(io.types.stringLiteral(Mn(i).value+"!"),de("getScopeById",n))}else t.insertBefore(a)}var d}},dom:{enter(e){if(e.node.body.attributeTags)return;const t=Oe(e.get("body"));t&&Re(t,!0),vo(e)&&At(e,37),wt(e)},exit(e){if(e.node.body.attributeTags)return;const[t,r]=ho(e,Oe(e.get("body")));if(t){const t=Fe(e),n=r[0][0].node.extra,s=n[po];let o=io.types.nullLiteral();for(let e=r.length;e--;){const[t,n]=r[e],[a]=t.node.attributes,i=n?io.types.identifier(n.name):io.types.numericLiteral(0);nr(t,((e,t,r)=>de("conditionalClosure",Mn(s),io.types.arrowFunctionExpression([],io.types.identifier(n.name)),t,r))),t.remove(),o=a?io.types.conditionalExpression(a.value,i,o):i}const a=cr(t,s,"if");a.build=()=>de("conditional",Mn(s),dr(a,[Jr])),a.hasDownstreamIntersections=()=>r.some((([,e])=>e?.closures)),wr(t,n.referencedBindings,a,o)}}}}),parseOptions:{controlFlow:!0},autocomplete:[{snippet:"if=${1:condition}",description:"Use to display content only if the condition is met.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#if-else-if-else"}]},mo={...fo,autocomplete:[{snippet:"else-if=${1:condition}",description:"Use after an <if> or <else-if> tag to display content if those conditions do not match and this one does.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#if-else-if-else"}]},yo={...fo,autocomplete:[{description:"Use after an <if> or <else-if> tag to display content if those conditions do not match.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#if-else-if-else"}]};function go(e){let t=e.getPrevSibling();for(;t.node&&t.isMarkoComment();)t=t.getPrevSibling();if(!we(t)||"else"!==be(t)&&!t.node.attributes.length)throw e.buildCodeFrameError(`The \`<${be(e)}>\` must have a preceding \`<if=cond>\`, \`<else-if=cond>\`, or \`<else if=cond>\`.`)}function bo(e){const{node:t}=e,[r]=t.attributes;if(!io.types.isMarkoAttribute(r)||!r.default)throw e.get("name").buildCodeFrameError(`The \`${be(e)}\` tag requires a value.`);if(t.attributes.length>1){const r=t.attributes[1].loc?.start,n=t.attributes[t.attributes.length-1].loc?.end,s=`The \`${be(e)}\` tag only supports the \`value\` attribute.`;throw null==r||null==n?e.get("name").buildCodeFrameError(s):e.hub.buildError({loc:{start:r,end:n}},s,Error)}}function ho(e,t){const r=uo.get(e)??[];let n=e.getNextSibling();for(;n.isMarkoComment();)n=n.getNextSibling();const s=!(xe(n,"else")||xe(n,"else-if"));return r.push([e,t]),s||uo.set(n,r),[s,r]}function vo(e){return xe(e,"if")}var xo=r("../../browser-shims/compiler/babel-utils.js"),wo={parse(e){const{node:t}=e;e.replaceWith((0,xo.parseStatements)(e.hub.file,t.rawValue,t.start,t.end)[0])},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:'import <scope> from "<path>"',description:"Use to import external modules, follows the same syntax as JavaScript imports.",snippet:'import ${2} from "${1:path}"',descriptionMoreURL:"https://markojs.com/docs/syntax/#importing-external-files"}]},Ao=r("../../browser-shims/compiler/index.js"),ko=r("../../browser-shims/compiler/babel-utils.js"),Eo={analyze(e){const{node:t}=e,r=t.var;let n,s;for(const r of t.attributes)if(Ao.types.isMarkoAttribute(r))if("value"===r.name)n=r;else{if("valueChange"!==r.name){const t=r.loc?.start,n=r.loc?.end,s="The `let` tag only supports the `value` attribute and its change handler.";throw null==t||null==n?e.get("name").buildCodeFrameError(s):e.hub.buildError({loc:{start:t,end:n}},s,Error)}s=r}if((0,ko.assertNoArgs)(e),(0,ko.assertNoParams)(e),b(e),g(e),!r)throw e.get("name").buildCodeFrameError("The `let` tag requires a tag variable.");if(!Ao.types.isIdentifier(r))throw e.get("var").buildCodeFrameError("The `let` tag variable cannot be destructured.");if(s&&(0,ko.computeNode)(s.value))throw e.get("attributes").find((e=>e.node===s)).get("value").buildCodeFrameError("The `let` tag `valueChange` attribute must be a function.");gn(De(e),e.node,[n?.value,s?.value]),cn(e,1,void 0,e.node.extra)},translate:{exit(e){const{node:t}=e,r=t.var,n=t.attributes.find((e=>Ao.types.isMarkoAttribute(e)&&(e.default||"value"===e.name)))??Ao.types.markoAttribute("value",Ao.types.identifier("undefined")),s=t.attributes.find((e=>Ao.types.isMarkoAttribute(e)&&"valueChange"===e.name)),o=Fe(e),a=r.extra.binding;if(N()){const t=pr(a,"state");wr(o,e.node.extra.referencedBindings,t,n.value),s&&(t.extraArgs=[s.value]),t.buildAssignment=(e,r)=>{const n=Wt(e,t.section);return Ao.types.callExpression(t.identifier,[n,r])}}else Zn(e,n.value),s&&ir(o).set(Ao.types.stringLiteral(Mn(a).value+"@"),s.value);e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Use to create a mutable binding.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#let"}],types:f.name+"/tag-types/let.d.marko"},So=r("../../browser-shims/compiler/index.js"),To=r("../../browser-shims/compiler/babel-utils.js"),Mo=Symbol("lifecycle attrs reference"),Io={analyze(e){(0,To.assertNoArgs)(e),(0,To.assertNoVar)(e),(0,To.assertNoParams)(e),b(e);const{node:t}=e,r=t.extra??={},n=De(e);if(r[Mo]=ln(Vr.scope.generateUid("lifecycle"),4,n,void 0,r),0===t.attributes.length)throw e.get("name").buildCodeFrameError("The `lifecycle` tag requires at least one attribute.");for(const r of t.attributes){if(So.types.isMarkoSpreadAttribute(r))throw e.get("name").buildCodeFrameError("The `lifecycle` tag does not support `...spread` attributes.");(r.value.extra??={}).isEffect=!0}(Vr.node.extra??={}).isInteractive=!0,gn(n,e.node,Tn(e.node))},translate:{exit(e){const{node:t}=e,r=Fe(e),n=t.extra,{referencedBindings:s}=n,o=n[Mo];if(N()){const t=Ps(e);t.statements.push(So.types.expressionStatement(de("lifecycle",Jr,Mn(o),$s(t.properties)))),hr("effect",r,s,t.statements)}else Cr(r,s);e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Use to create a side effects.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#effect"}],types:f.name+"/tag-types/lifecycle.d.marko"},jo=r("../../browser-shims/compiler/index.js"),Co=r("../../browser-shims/compiler/babel-utils.js"),Po={analyze(e){const[t]=e.node.attributes;if((0,Co.assertNoArgs)(e),(0,Co.assertNoVar)(e),(0,Co.assertNoParams)(e),b(e),!t)throw e.get("name").buildCodeFrameError("The `log` tag requires a value.");if(e.node.attributes.length>1||!jo.types.isMarkoAttribute(t)||!t.default&&"value"!==t.name)throw e.get("name").buildCodeFrameError("The `log` tag only supports the `value` attribute.")},translate:{exit(e){const t=Fe(e),[r]=e.node.attributes,{value:n}=r,s=n.extra?.referencedBindings,o=jo.types.expressionStatement(jo.types.callExpression(jo.types.memberExpression(jo.types.identifier("console"),jo.types.identifier("log")),[n]));B()?e.insertBefore(o):hr("render",t,s,o),e.remove()}},parseOptions:{openTagOnly:!0},attributes:{},autocomplete:[{description:"Use to log a value to the console.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#log"}],types:f.name+"/tag-types/log.d.marko"},Bo=r("../../browser-shims/compiler/index.js"),No=r("../../browser-shims/compiler/babel-utils.js"),$o=" For a native html `script` tag use the `html-script` core tag instead.",Do={parse(e){const{node:t}=e,{body:r}=t.body;if(r.length){let n="";for(const t of r){if("MarkoText"!==t.type)throw e.hub.file.hub.buildError(t,"Unexpected content in `script` tag. Only javascript and typescript is supported."+$o,SyntaxError);n+=t.value}const s=r[0]?.start,o=r[r.length-1]?.end,a=(0,No.parseStatements)(e.hub.file,n,s,o),i=Bo.types.arrowFunctionExpression([],Bo.types.blockStatement(a),Qt(a,Oo));t.attributes.push(Bo.types.markoAttribute("value",i)),t.body.body=[]}},analyze(e){const{node:t}=e;if((0,No.assertNoArgs)(e),(0,No.assertNoParams)(e),b(e),(0,No.assertNoAttributeTags)(e),t.var)throw e.hub.buildError(t.var,"The `script` tag does not support a tag variable reference."+$o);let r=!1;for(const n of t.attributes){if("MarkoAttribute"!==n.type||"value"!==n.name)throw e.hub.buildError(n,"The `script` tag does not support html attributes."+$o);if(r)throw e.hub.buildError(n,"Invalid duplicate value attribute.");r=!0,(n.value.extra??={}).isEffect=!0,(Vr.node.extra??={}).isInteractive=!0}r||En(Tn(t))},translate:{exit(e){const{node:t}=e,[r]=t.attributes;if(!r)return void e.remove();const n=Fe(e),{value:s}=r,o=s.extra?.referencedBindings;if(N()){const{value:e}=r,t=Bo.types.isFunctionExpression(e)||Bo.types.isArrowFunctionExpression(e);let s=null;if(t&&!e.async&&!e.generator)if(Bo.types.isBlockStatement(e.body)){let t=!1;for(const r of e.body.body)if(Bo.types.isDeclaration(r)){t=!0;break}s=t?e.body:e.body.body}else s=Bo.types.expressionStatement(e.body);hr("effect",n,o,s||Bo.types.expressionStatement(Bo.types.callExpression(e,t?[]:[Jr])))}else Cr(n,o);e.remove()}},html:!1,parseOptions:{text:!0,preserveWhitespace:!0},attributes:{},autocomplete:[{description:"Use to create a side effects.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#script"}],types:f.name+"/tag-types/script.d.marko"};function Oo(e){switch(e.type){case"FunctionDeclaration":case"FunctionExpression":case"ArrowFunctionExpression":case"ClassMethod":case"ObjectMethod":case"ClassPrivateMethod":return Yt;case"AwaitExpression":return!0;default:return!1}}var Fo=r("../../browser-shims/compiler/index.js"),Lo=r("../../browser-shims/compiler/babel-utils.js"),Uo={parse(e){const{node:t,hub:{file:r}}=e,n=t.rawValue,s=n.replace(/^server\s*/,"").trim(),o=t.name.start+(n.length-s.length);let a=(0,Lo.parseStatements)(r,s,o,o+s.length);1===a.length&&Fo.types.isBlockStatement(a[0])&&(a=a[0].body),e.replaceWith(Fo.types.markoScriptlet(a,!0,"server"))},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:"server <statement>",description:"A JavaScript statement which is only evaluated once your template is loaded on the server.",descriptionMoreURL:"https://markojs.com/docs/syntax/#server-javascript"}]},Ro=r("../../browser-shims/compiler/index.js"),_o=r("../../browser-shims/compiler/babel-utils.js"),zo={parse(e){const{node:t,hub:{file:r}}=e,n=t.rawValue,s=n.replace(/^static\s*/,"").trim(),o=t.name.start+(n.length-s.length);let a=(0,_o.parseStatements)(r,s,o,o+s.length);1===a.length&&Ro.types.isBlockStatement(a[0])&&(a=a[0].body),e.replaceWith(Ro.types.markoScriptlet(a,!0))},parseOptions:{statement:!0,rawOpenTag:!0},autocomplete:[{displayText:"static <statement>",description:"A JavaScript statement which is only evaluated once your template is loaded.",descriptionMoreURL:"https://markojs.com/docs/syntax/#static-javascript"}]},Wo=r("../../browser-shims/compiler/index.js"),Vo=r("../../browser-shims/compiler/babel-utils.js"),qo=d(r("../../node_modules/magic-string/dist/magic-string.cjs.js")),Jo=d(r("../../node_modules/path-browserify/index.js")),Zo=/^style((?:\.[a-zA-Z0-9$_-]+)+)?/,Go=" For a native html `style` tag use the `html-style` core tag instead.",Ko={analyze(e){(0,Vo.assertNoArgs)(e),(0,Vo.assertNoParams)(e),(0,Vo.assertNoAttributeTags)(e);const{node:t}=e,r=Zo.exec(t.rawValue||"")?.[1]?.slice(1);for(const n of t.attributes)if(null!=n.start||"MarkoAttribute"!==n.type||"class"!==n.name||"StringLiteral"!==n.value.type||n.value.value!==r)throw e.hub.buildError(n.value,"The `style` does not support html attributes."+Go);for(const r of t.body.body)if("MarkoText"!==r.type)throw e.hub.buildError(r,"The `style` tag currently only supports static content."+Go);if(t.body.body.length>1)throw e.hub.buildError(t.name,"The `style` tag currently only supports static content."+Go)},translate(e){const{node:t,hub:{file:r}}=e,{filename:n,sourceMaps:s}=r.opts;let o=Zo.exec(t.rawValue||"")?.[1]||".css";t.var&&!/\.module\./.test(o)&&(o=".module"+o);const a=t.body.body[0],{resolveVirtualDependency:i}=$(),l=(0,Vo.getStart)(r,a),c=(0,Vo.getEnd)(r,a);let p,d=a.value;if(i&&s&&null!==l&&null!==c){const e=new qo.default(r.code,{filename:n});e.remove(0,l),e.remove(c,r.code.length),p=e.generateMap({source:n,includeContent:!0}),"inline"!==s&&"both"!==s||(d+=`\n/*# sourceMappingURL=${p.toUrl()}*/`,"inline"===s&&(p=void 0))}const u=i?.(n,{virtualPath:`./${Jo.default.basename(n)+o}`,code:d,map:p});u&&(t.var?Wo.types.isIdentifier(t.var)?Vr.pushContainer("body",Wo.types.importDeclaration([Wo.types.importDefaultSpecifier(t.var)],Wo.types.stringLiteral(u))):Vr.pushContainer("body",Wo.types.variableDeclaration("const",[Wo.types.variableDeclarator(t.var,(0,Vo.importDefault)(r,u,"style"))])):Vr.pushContainer("body",Wo.types.importDeclaration([],Wo.types.stringLiteral(u)))),e.remove()},parseOptions:{html:!1,text:!0,rawOpenTag:!0,preserveWhitespace:!0},attributes:{}},Xo=r("../../browser-shims/compiler/index.js"),Yo=r("../../browser-shims/compiler/babel-utils.js"),Ho={analyze(e){(0,Yo.assertNoVar)(e),(0,Yo.assertNoArgs)(e),(0,Yo.assertNoParams)(e),(0,Yo.assertNoAttributes)(e),g(e),ss(e);const{node:t}=e,r=De(e);if(!t.body.body.length)throw e.get("name").buildCodeFrameError("The `try` tag requires body content.");gn(r,e.node,Tn(e.node))},translate:lt({html:{enter(e){Oe(e.get("body"))?(Qo(e),Ct(e)):e.remove()},exit(e){const t=e.get("body"),r=Ps(e);Pt(e),Pr(t),e.insertBefore(r.statements),e.replaceWith(Xo.types.expressionStatement(de("tryContent",$s(r.properties))))[0].skip()}},dom:{enter(e){Qo(e)},exit(e){e.remove()}}}),attributes:{},autocomplete:[{description:"Used to capture errors and display placeholders for nested content.",descriptionMoreURL:"https://markojs.com/docs/core-tags/#try"}],types:f.name+"/tag-types/try.d.marko"};function Qo(e){for(const t of e.get("attributeTags"))t.isMarkoTag()&&Qo(t);const t=Oe(e.get("body"));t&&Re(t,!0)}var ea={taglibId:f.taglibId,"<attrs>":h,"<await>":Rn,"<client>":Wn,"<const>":Gn,"<debug>":Yn,"<define>":Us,"<effect>":zs,"<else-if>":mo,"<else>":yo,"<export>":Vs,"<for>":Ss,"<html-comment>":Ks,"<html-script>":Qs,"<html-style>":no,"<id>":ao,"<if>":fo,"<import>":wo,"<let>":Eo,"<lifecycle>":Io,"<log>":Po,"<return>":Ft,"<script>":Do,"<server>":Uo,"<static>":zo,"<style>":Ko,"<try>":Ho},ta={translate:{enter(e){throw e.buildCodeFrameError("CDATA sections are not supported in Marko.")}}},ra={translate:{exit(e){e.remove()}}},na={translate:{enter(e){throw e.buildCodeFrameError("XML declarations sections are not supported in Marko.")}}},sa={translate:{exit(e){B()&&It(e)`<!${e.node.value}>`,e.remove()}}},oa=r("../../browser-shims/compiler/index.js"),aa=r("../../browser-shims/compiler/babel-utils.js"),ia=new WeakMap,la={analyze(e){const t=en(e.parentPath),r=function(e){let t=e;do{t=t.parentPath}while(t&&!tn(t));return t}(t||e),n=!r||r.isMarkoScriptlet({static:!0});if(t||!function(e,t){switch(e.node.type){case"FunctionDeclaration":return t&&!e.node.declare;case"FunctionExpression":case"ArrowFunctionExpression":return!0;default:return!1}}(e,n))return;if(r&&(r.isMarkoPlaceholder()||r.isMarkoScriptlet()&&"server"===r.node.target))return;const{node:s}=e,o=s.extra??={},a=o.name=e.node.id?.name||(ca(r)?r.node.default?oa.types.toIdentifier(r.parentPath.has("var")?r.parentPath.get("var"):r.parentPath.get("name")):r.node.name:oa.types.isVariableDeclarator(e.parent)&&oa.types.isIdentifier(e.parent.id)?e.parent.id.name:"anonymous");if(ca(r)&&((0,aa.isNativeTag)(r.parentPath)&&/^on[A-Z-]/.test(r.node.name)||xe(r.parentPath,"script")||xe(r.parentPath,"lifecycle")||xe(r.parentPath,"for")))return;const{markoOpts:i,opts:{filename:l}}=Vr.hub.file,c=Fe(e);let p=ia.get(c);p||(p=new Map,ia.set(c,p));const d=p.get(a);let u="";void 0===d?p.set(a,0):u=`_${d}`,o.section=c,o.registerId=(0,aa.getTemplateId)(i,l,`${c.id}/${a+u}`)}};function ca(e){return!!e&&e.isMarkoAttribute()}var pa=r("../../browser-shims/compiler/babel-utils.js"),da={analyze(e){const{node:t}=e,{source:r}=t,{value:n}=r,s=(0,pa.resolveTagImport)(e,n);if(s){t.extra??={},t.extra.tagImport=s;const r=e.hub.file.metadata.marko.tags;r.includes(s)||r.push(s)}},translate:{exit(e){const{node:t}=e,{extra:r}=t,n=r?.tagImport;n&&(t.source.value=n)}}},ua=r("../../browser-shims/compiler/index.js"),fa=Symbol("placeholder node binding"),ma=Symbol("placeholder has sibling text"),ya={analyze(e){const{node:t}=e,{confident:r,computed:n}=A(t.value);r&&(t.escape||ga(n))||((t.extra??={})[fa]=ln("#text",0,De(e),void 0,t.value.extra),function(e){const t=e.node.extra;let r=e.getPrevSibling();for(;r.node;){const e=qe(r,"endType");if(null!==e){if(4===e||1===e||2===e)return t[ma]=1;break}r=r.getPrevSibling()}if(!r.node&&ua.types.isProgram(e.parentPath))return t[ma]=1;let n=e.getNextSibling();for(;n.node;){const e=qe(n,"startType");if(null!==e){if(4===e||1===e||2===e)return t[ma]=2;break}n=n.getNextSibling()}if(!n.node&&ua.types.isProgram(e.parentPath))return t[ma]=2;t[ma]=0}(e))},translate:{exit(e){const{node:t}=e,{value:r}=t,{confident:n,computed:s,referencedBindings:o}=A(r);if(n&&ga(s))return void e.remove();const a=B(),i=It(e),l=t.extra||{},c=l[fa],p=a||n&&t.escape,d=p?t.escape?"escapeXML":"toString":t.escape?"data":"html",u=Ln(o),f=l[ma];n&&p?i`${ue()[d](s)}`:(1===f?(a&&u&&i`<!>`,At(e,37)):2===f?At(e,37):(a||i` `,At(e,32)),a?(i`${de(d,r)}`,u&&Nt(e,c)):hr("render",Fe(e),r.extra?.referencedBindings,ua.types.expressionStatement("data"===d?de("data",ua.types.memberExpression(Jr,Mn(c),!0),r):de("html",Jr,r,Mn(c))))),wt(e),e.remove()}}};function ga(e){return null==e||!1===e}var ba=r("../../browser-shims/compiler/index.js"),ha=new WeakMap,va={migrate(e){const{name:t}=e.node;if(!e.scope.hasBinding(t)&&"out"===t){if(!ba.types.isMemberExpression(e.parent)||!ba.types.isIdentifier(e.parent.property)||"global"!==e.parent.property.name)throw e.buildCodeFrameError("Only `out.global` is supported for compatibility.");e.parentPath.replaceWith(ba.types.identifier("$global"))}},analyze(e){const{name:t}=e.node;e.scope.hasBinding(t)||("$global"===t?un(e):"$signal"===t&&(De(e).hasAbortSignal=!0,un(e)))},translate(e){const{name:t}=e.node;if(!e.scope.hasBinding(t))switch(t){case"$global":B()?e.replaceWith(ba.types.callExpression(pe("$global"),[])):e.replaceWith(ba.types.memberExpression(Jr,ba.types.identifier("$global")));break;case"$signal":if(B())e.replaceWith(ba.types.callExpression(ba.types.arrowFunctionExpression([],ba.types.blockStatement([ba.types.throwStatement(ba.types.newExpression(ba.types.identifier("Error"),[ba.types.stringLiteral("Cannot use $signal in a server render.")]))])),[]));else{const t=Fe(e),r=Qr(e);let n,s=ha.get(t);s?n=s.get(r):(s=new Map,ha.set(t,s)),n||(n=s.size,s.set(r,n),hr("render",t,r.node.extra?.referencedBindings,ba.types.expressionStatement(ba.types.callExpression(pe("resetAbortSignal"),[Jr,ba.types.numericLiteral(n)])))),e.replaceWith(ba.types.callExpression(pe("getAbortSignal"),[Jr,ba.types.numericLiteral(n)]))}}}},xa={analyze(e){if(!e.node.static)throw e.buildCodeFrameError("Scriptlets are not supported when using the tags api.");gn(De(e),e.node,e.node.body)},translate:{exit(e){const{node:t}=e,r=B();t.target&&t.target!==(r?"server":"client")?e.remove():r||(Ht(t,"body",Lr),e.replaceWithMultiple(t.body))}}},wa=r("../../browser-shims/compiler/index.js"),Aa=r("../../browser-shims/compiler/babel-utils.js"),ka=(r("../../browser-shims/compiler/index.js"),r("../../browser-shims/compiler/babel-utils.js")),Ea={analyze:{enter(e){(0,ka.assertNoVar)(e),(0,ka.assertNoArgs)(e);const t=e.get("body");if($e(t),pn(t,3),!(0,ka.findParentTag)(e))throw e.get("name").buildCodeFrameError("@tags must be nested within another tag.")}},translate:{enter(e){B()&&Ct(e)},exit(e){B()&&(Pt(e),Pr(e.get("body")))}}},Sa=r("../../browser-shims/compiler/index.js"),Ta=r("../../browser-shims/compiler/babel-utils.js"),Ma=d(r("../../node_modules/path-browserify/index.js")),Ia=Symbol("custom tag child scope"),ja={analyze:{enter(e){if((0,Ta.assertAttributesOrSingleArg)(e),ss(e),!(0,Ta.getTagTemplate)(e)){const t=be(e);if(t&&e.scope.hasBinding(t))throw e.get("name").buildCodeFrameError(`Local variables must be in a dynamic tag unless they are PascalCase. Use \`<\${${t}}/>\` or rename to \`${t.charAt(0).toUpperCase()+t.slice(1)}\`.`);throw e.get("name").buildCodeFrameError("Unable to find entry point for custom tag.")}const t=De(e),r=e.get("body"),n=e.node.extra??={};$e(r),cn(e,4),pn(r,3),n[Ia]=ln("#childScope",0,t,void 0,n);const s=(0,Ta.loadFileForTag)(e);if(s.opts.filename===e.hub.file.opts.filename)gn(t,e.node,Tn(e.node));else{const r=s.ast.program.extra;Pa(t,e,r?.domExports.params?.props?.[0]),Vr.node.extra.hasInteractiveChild=r?.isInteractive||r?.hasInteractiveChild||!1}}},translate:{enter(e){At(e),B()&&Ct(e)},exit(e){B()?function(e){const t=e.get("body"),{node:r}=e;let n;if(Pt(e),Pr(t),Sa.types.isStringLiteral(r.name)){const t=Ca(e);n=$a(e.hub.file,t)?qr:(0,Ta.importDefault)(e.hub.file,t,be(e))}else n=r.name;const s=r.var,o=Fe(e),a=r.extra[Ia],i=e.scope.generateUidIdentifier(a?.name);e.insertBefore(Sa.types.variableDeclaration("const",[Sa.types.variableDeclarator(i,de("peekNextScope"))])),ir(o).set(Mn(a),de("writeExistingScope",i));const l=(0,Ta.loadFileForTag)(e)?.ast.program.extra?.domExports?.params?.props?.[0],{properties:c,statements:p}=l?Ps(e,l.props):{properties:[],statements:[]};if(r.extra.tagNameNullable){const t=Bs(c);let r;if(t){const n=t.value;t.value=r=e.scope.generateUidIdentifier("content");const[s]=e.insertBefore(Sa.types.variableDeclaration("const",[Sa.types.variableDeclarator(r,n)]));s.skip()}let o=Oa(n,$s(c));s&&(Zn(e,Sa.types.unaryExpression("void",Sa.types.numericLiteral(0)),"let"),o=Sa.types.assignmentExpression("=",s,o)),p.push(Sa.types.ifStatement(n,Sa.types.expressionStatement(o),r&&Da(r)))}else s?(Zn(e,Oa(n,$s(c),de("register",Sa.types.arrowFunctionExpression([],Sa.types.blockStatement([])),Sa.types.stringLiteral(Ar(o,r.var.extra?.binding,"var")),Le(o)))),ar(o)):p.push(Da(n,$s(c)));for(const t of e.replaceWithMultiple(p))t.skip()}(e):function(e){const t=Fe(e),{node:r}=e,n=r.extra[Ia],s=It(e),{file:o}=e.hub,a=Sa.types.isIdentifier(r.name)?r.name.name:Sa.types.isStringLiteral(r.name)?r.name.value:"tag",i=Ca(e),l=(0,Ta.loadFileForTag)(e),c=l.ast.program.extra.domExports,p=Na(o,i,c.setup,a),d=c.params?.props?.[0];if(d&&Ba(e,d,`${be(e)||"tag"}_input`,{circular:l.opts.filename===o.opts.filename,tagSection:t,relativePath:i,childScopeBinding:n}),s`${(0,Ta.importNamed)(o,i,c.template,`${a}_template`)}`,function(e,t){const r=yt(Fe(e));gt(Fe(e)).push(`${ht[47]}`,t.name,ht[38]),ut(r,String.fromCharCode(47)),r.push(t,String.fromCharCode(38))}(e,(0,Ta.importNamed)(o,i,c.walks,`${a}_walks`)),r.var){const e=pr(r.var.extra.binding);e.register=!0,e.buildAssignment=(e,t)=>Sa.types.callExpression(pe("tagVarSignalChange"),[Vt(e,n),t]),hr("render",t,void 0,Sa.types.expressionStatement(de("setTagVar",Jr,Mn(n),e.identifier)))}hr("render",t,void 0,Sa.types.expressionStatement(Sa.types.callExpression(p,[Vt(t,n)]))),e.remove()}(e)}}};function Ca(e){const{node:t,hub:{file:r}}=e;let n;if(Sa.types.isStringLiteral(t.name)){const t=(0,Ta.getTagTemplate)(e);n=t&&(0,Ta.resolveRelativePath)(r,t)}else t.extra?.tagNameImported&&(n=t.extra.tagNameImported);if(!n){const t=be(e);if(t&&e.scope.hasBinding(t))throw e.get("name").buildCodeFrameError(`Local variables must be in a dynamic tag unless they are PascalCase. Use \`<\${${t}}/>\` or rename to \`${t.charAt(0).toUpperCase()+t.slice(1)}\`.`);throw e.get("name").buildCodeFrameError("Unable to find entry point for custom tag.")}return n}function Pa(e,t,r){if(!r)return void En(Tn(t.node));if(!r.props||t.node.arguments?.length)return void gn(e,t.node,Tn(t.node));const n=ss(t),s=new Set;if(n){const o=new Map,a=(e,t)=>{const r=Tn(t.node),n=o.get(e);n?n.referenceNodes=n.referenceNodes.concat(r):o.set(e,{firstTag:t,referenceNodes:r})};for(const e in n)s.add(n[e].name);const i=t.node.body.attributeTags?t.get("body").get("body"):t.get("attributeTags");for(const t of i)if(t.isMarkoTag())if((0,Ta.isAttributeTag)(t)){const s=n[be(t)],o=r.props[s.name];o?o.props&&!s.dynamic?Pa(e,t,o):a(s.group,t):En(Tn(t.node))}else{const e=t.node.extra.attributeTagGroup;let s=!1;for(const t of e)if(r.props[n[t].name]){s=!0;break}s?a(e,t):En(Tn(t.node))}for(const{firstTag:t,referenceNodes:r}of o.values())gn(e,t.node,r)}const{attributes:o}=t.node;let a;for(let e=o.length;e--;){const t=o[e];if(Sa.types.isMarkoAttribute(t)){if(s.has(t.name)||!r.props[t.name]){En(t.value);continue}s.add(t.name)}a?a.push(t.value):Sa.types.isMarkoSpreadAttribute(t)&&(a=[t.value])}a&&gn(e,t.node,a)}function Ba(e,t,r,n){if(e.node.arguments?.length){const[s]=e.node.arguments,o=Na(e.hub.file,n.relativePath,t.id,r);return void wr(n.tagSection,e.node.extra?.referencedBindings,Fa(o),Sa.types.isSpreadElement(s)?Sa.types.memberExpression(s.argument,Sa.types.numericLiteral(0),!0):s,Vt(n.tagSection,n.childScopeBinding),de("inChild",Mn(n.childScopeBinding),Sa.types.identifier(o.name)))}if(!t.props||n.circular){const s=e.node.extra?.referencedBindings,o=Na(e.hub.file,n.relativePath,t.id,r),a=Ps(e);a.statements.length&&hr("render",n.tagSection,s,a.statements);let i=$s(a.properties);return(0,Ta.isAttributeTag)(e)&&(i=de("attrTag",i)),void wr(n.tagSection,s,Fa(o),i,Vt(n.tagSection,n.childScopeBinding),de("inChild",Mn(n.childScopeBinding),Sa.types.identifier(o.name)))}const s=new Set,o=ss(e);if(o){const a=e.get("attributeTags"),i=new Map,l=(e,r)=>{const n=a[r];let s=i.get(e)?.statements;return s||(s=[],i.set(e,{referencedBindings:n.node.extra?.referencedBindings,statements:s})),Ns(a,r,o,s,t.props)};for(const e in o)s.add(o[e].name);for(let e=0;e<a.length;e++){const s=a[e];if(s.isMarkoTag())if((0,Ta.isAttributeTag)(s)){const a=o[be(s)],i=t.props[a.name];i&&(a.dynamic?e=l(a.group,e):Ba(s,i,`${r}_${a.name}`,n))}else s.node.extra?.attributeTagGroup&&(e=l(s.node.extra.attributeTagGroup,e))}for(const[s,{referencedBindings:a,statements:l}]of i){const i=[];for(const l of s){const s=o[l],c=t.props[s.name];if(!c)continue;const p=Na(e.hub.file,n.relativePath,c.id,`${r}_${s.name}`);i.push(Sa.types.variableDeclarator(ns(s))),wr(n.tagSection,a,Fa(p),ns(s),Vt(n.tagSection,n.childScopeBinding),de("inChild",Mn(n.childScopeBinding),Sa.types.identifier(p.name)))}hr("render",n.tagSection,a,[Sa.types.variableDeclaration("let",i),...l])}}const a=e.node.body.extra?.section;if(a&&!s.has("content")&&(s.add("content"),t.props.content)){const s=(0,Ta.importNamed)(e.hub.file,n.relativePath,t.props.content.id,`${r}_content`);wr(n.tagSection,void 0,Fa(s),Sa.types.callExpression(Sa.types.identifier(a.name),[Jr]),Vt(n.tagSection,n.childScopeBinding),de("inChild",Mn(n.childScopeBinding),Sa.types.identifier(s.name)))}const{attributes:i}=e.node,l=[];let c;for(let e=i.length;e--;){const r=i[e];if(Sa.types.isMarkoAttribute(r)){if(!t.props[r.name]||s.has(r.name))continue;if(s.add(r.name),c){c.push(ie(r.name,r.value));continue}l.push(r)}else c?c.push(Sa.types.spreadElement(r.value)):c=[Sa.types.spreadElement(r.value)]}for(const s of l.reverse()){const o=t.props[s.name],a=Na(e.hub.file,n.relativePath,o.id,`${r}_${s.name}`);wr(n.tagSection,s.value.extra?.referencedBindings,Fa(a),s.value,Vt(n.tagSection,n.childScopeBinding),de("inChild",Mn(n.childScopeBinding),Sa.types.identifier(a.name)))}const p=new Set(Object.keys(t.props));for(const e of s)p.delete(e);if(p.size){const s=e.node.extra?.referencedBindings;let o=La;if(c){const t=e.scope.generateUidIdentifier(`${r}_spread`);c.reverse(),o=e=>le(t,e),hr("render",n.tagSection,s,[Sa.types.variableDeclaration("const",[Sa.types.variableDeclarator(t,$s(c))])])}for(const a of p){const i=t.props[a],l=Na(e.hub.file,n.relativePath,i.id,`${r}_${a}`);wr(n.tagSection,s,Fa(l),o(a),Vt(n.tagSection,n.childScopeBinding),de("inChild",Mn(n.childScopeBinding),Sa.types.identifier(l.name)))}}}function Na(e,t,r,n){return $a(e,t)?Sa.types.identifier(r):(0,Ta.importNamed)(e,t,r,n)}function $a(e,t){const{filename:r}=e.opts;return t===r||"."===t[0]&&Ma.default.resolve(r,"..",t)===r}function Da(e,...t){return Sa.types.expressionStatement(Oa(e,...t))}function Oa(e,...t){return Sa.types.callExpression(e,t.filter(Boolean))}function Fa(e){return{identifier:e,hasDownstreamIntersections:Ua}}function La(){return Sa.types.unaryExpression("void",Sa.types.numericLiteral(0))}function Ua(){return!0}var Ra=r("../../browser-shims/compiler/index.js"),_a=r("../../browser-shims/compiler/babel-utils.js"),za=Symbol("dynamic tag dom binding"),Wa={analyze:{enter(e){(0,_a.assertAttributesOrArgs)(e),ss(e);const t=De(e),r=e.node.extra??={},n=e.get("body"),s=r[za]=ln("#text",0,t,void 0,r);$e(n),cn(e,4),pn(n,3),gn(t,e.node,Tn(e.node)),kn(e,s)}},translate:{enter(e){At(e,37),wt(e),B()&&Ct(e)},exit(e){const{node:t}=e,r=t.extra,n=r[za],s=Fe(e),o="class"===r.featureType;let a=t.name;Ra.types.isStringLiteral(a)&&(a=(0,_a.importDefault)(e.hub.file,Ca(e),a.value)),o&&(B()?Vr.pushContainer("body",Ra.types.expressionStatement(Ra.types.callExpression((0,_a.importNamed)(e.hub.file,fe(),"s"),[Ra.types.identifier(a.name),Ra.types.stringLiteral((0,_a.loadFileForTag)(e).metadata.marko.id)]))):Vr.pushContainer("body",Ra.types.expressionStatement(de("register",Ra.types.stringLiteral((0,_a.loadFileForTag)(e).metadata.marko.id),Ra.types.identifier(a.name)))));const{properties:i,statements:l}=Ps(e,void 0,void 0,o?"renderBody":"content"),c=[];let p=!1;if(t.arguments?.length)c.push(...t.arguments),i.length?(p=!0,c.push($s(i))):p=t.arguments.length>1||Ra.types.isSpreadElement(t.arguments[0]);else{const e=Bs(i);e?(i.splice(i.indexOf(e),1),c.push($s(i),e.value)):c.push($s(i))}if(B()){Pt(e),Pr(e.get("body")),t.var&&(p||1!==c.length||c.push(Ra.types.unaryExpression("void",Ra.types.numericLiteral(0))),c.push(de("register",Ra.types.arrowFunctionExpression([],Ra.types.blockStatement([])),Ra.types.stringLiteral(Ar(s,t.var.extra?.binding,"var")),Le(s))));const r=Vr.scope.generateUidIdentifier("dynamicScope"),o=p?de("dynamicTagArgs",Le(s),Mn(n),a,Ra.types.arrayExpression(c)):de("dynamicTagInput",Le(s),Mn(n),a,...c);l.push(Ra.types.variableDeclaration("const",[Ra.types.variableDeclarator(r,de("peekNextScope"))])),l.push(t.var?Ra.types.variableDeclaration("const",[Ra.types.variableDeclarator(t.var,o)]):Ra.types.expressionStatement(o)),ir(s).set(Ra.types.stringLiteral(Mn(n).value+"!"),de("writeExistingScope",r)),ir(s).set(Ra.types.stringLiteral(Mn(n).value+"("),de("normalizeDynamicRenderer",Ra.types.isIdentifier(a)?Ra.types.identifier(a.name):a));for(const t of e.replaceWithMultiple(l))t.skip()}else{const s=Fe(e),o=Oe(e.get("body")),i=cr(s,n,"dynamicTagName");if(i.build=()=>de("conditional",Mn(n),dr(i,[Jr]),yr(i)),i.hasDownstreamIntersections=()=>!0,wr(s,t.name.extra?.referencedBindings,i,o?Ra.types.logicalExpression("||",a,Ra.types.callExpression(Ra.types.identifier(o.name),[Jr])):a),e.node.var){const t=Ra.types.stringLiteral(Mn(r[za]).value+"!"),o=pr(e.node.var.extra.binding);o.register=!0,o.buildAssignment=(e,r)=>Ra.types.callExpression(pe("tagVarSignalChange"),[Ra.types.memberExpression(Wt(o.section,e),t,!0),r]),hr("render",s,n,Ra.types.expressionStatement(de("setTagVar",Jr,t,o.identifier)))}if(c.length){const r=p?Ra.types.arrayExpression(c):c[0],a=Ra.types.arrowFunctionExpression([],l.length?Ra.types.blockStatement(l.concat(Ra.types.returnStatement(r))):r),i=Vr.scope.generateUidIdentifier(e.get("name").toString()+"_input");let d=!1;wr(s,t.extra?.referencedBindings,{get identifier(){return d||(Vr.pushContainer("body",Ra.types.variableDeclaration("const",[Ra.types.variableDeclarator(i,de("dynamicTagAttrs",Mn(n),o&&Ra.types.identifier(o.name),p&&Ra.types.numericLiteral(1)))])),d=!0),i},hasDownstreamIntersections:()=>!0},a)}e.remove()}}}},Va=/^[A-Z][a-zA-Z0-9_$]*$/,qa={transform:{enter(e){const{node:t}=e,{name:r,attributes:n}=e.node;let s=!1;if(wa.types.isStringLiteral(r)){const n=r.value;e.scope.getBinding(n)&&Va.test(n)&&(t.name=nn(wa.types.identifier(n),r),s=!0)}for(let t=0;t<n.length;t++){const r=n[t];if(wa.types.isMarkoAttribute(r)&&r.bound){r.bound=!1;const o=Ja(e,r);if(null===o)throw e.hub.buildError(r,"Attributes may only be bound to identifiers or member expressions");n.splice(++t,0,wa.types.markoAttribute(r.name+"Change",o)),s=!0}}s&&e.scope.crawl()}},analyze:{enter(e){const t=(0,Aa.getTagDef)(e),r=Ne(e),n=t?.analyzer?.hook;if(n)st(n,e);else if(0!==r)switch(r){case 1:ja.analyze.enter(e);break;case 3:Ea.analyze.enter(e);break;case 2:Wa.analyze.enter(e)}else xs.analyze.enter(e)},exit(e){const t=(0,Aa.getTagDef)(e)?.analyzer?.hook;t&&ot(t,e)}},translate:{enter(e){const t=(0,Aa.getTagDef)(e),r=e.node.extra;if(t?.translator)return t.translator.path&&e.hub.file.metadata.marko.watchFiles.push(t.translator.path),void st(t.translator.hook,e);for(const t of e.get("attributes"))if(t.isMarkoAttribute()){if(t.node.arguments)throw t.buildCodeFrameError(`Unsupported arguments on the \`${t.node.name}\` attribute.`);if(t.node.modifier){if(!(0,Aa.isNativeTag)(t.parentPath))throw t.buildCodeFrameError(`Unsupported modifier \`${t.node.modifier}\`.`);t.node.name+=`:${t.node.modifier}`}}if(r.tagNameDynamic&&r.tagNameNullable&&!e.get("name").isIdentifier()&&B()){const t=e.scope.generateUidIdentifier("tagName"),[r]=e.insertBefore(wa.types.variableDeclaration("const",[wa.types.variableDeclarator(t,e.node.name)]));r.skip(),e.set("name",t)}switch(r.tagNameType){case 0:xs.translate.enter(e);break;case 1:ja.translate.enter(e);break;case 2:Wa.translate.enter(e);break;case 3:Ea.translate.enter(e)}},exit(e){const t=(0,Aa.getTagDef)(e)?.translator;if(t)ot(t.hook,e);else switch(e.node.extra.tagNameType){case 0:xs.translate.exit(e);break;case 1:ja.translate.exit(e);break;case 2:Wa.translate.exit(e);break;case 3:Ea.translate.exit(e)}}}};function Ja(e,t){if(wa.types.isIdentifier(t.value)){const r=e.scope.generateUidIdentifier("new_"+t.value.name);return wa.types.arrowFunctionExpression([r],wa.types.blockStatement([wa.types.expressionStatement(wa.types.assignmentExpression("=",wa.types.cloneNode(t.value),r))]))}if(wa.types.isMemberExpression(t.value)){const e=t.value.property;return wa.types.isPrivateName(e)?null:wa.types.isIdentifier(e)?wa.types.memberExpression(wa.types.cloneNode(t.value.object),wa.types.identifier(e.name+"Change")):wa.types.memberExpression(wa.types.cloneNode(t.value.object),wa.types.binaryExpression("+",wa.types.cloneNode(e),wa.types.stringLiteral("Change")),!0)}return null}r("../../browser-shims/compiler/index.js");var Za=function(e){const t={migrate:{},transform:{},analyze:{},translate:{}};for(const r in e){const n=r,s=e[n];s.migrate&&(t.migrate[n]=s.migrate),s.transform&&(t.transform[n]=s.transform),s.analyze&&(t.analyze[n]=s.analyze),s.translate&&(t.translate[n]=s.translate)}return t}({Program:Yr,Function:la,ReferencedIdentifier:va,ImportDeclaration:da,MarkoDocumentType:sa,MarkoDeclaration:na,MarkoCDATA:ta,MarkoText:{translate:{exit(e){It(e)`${e.node.value}`,wt(e),e.remove()}}},MarkoTag:qa,MarkoPlaceholder:ya,MarkoScriptlet:xa,MarkoComment:ra}),Ga=["tags"],Ka="tags",{transform:Xa,analyze:Ya,translate:Ha}=Za,Qa=[["../../node_modules/@marko/runtime-tags/dist/translator",{...ea,migrate:Za.migrate}]];function ei(e,t){return[`${f.name}${t?"":"/debug"}/${"html"===e?"html":"dom"}`]}},"../../node_modules/@marko/runtime-tags/package.json":e=>{e.exports=JSON.parse('{"name":"@marko/runtime-tags","version":"0.3.26","description":"Optimized runtime for Marko templates.","keywords":["api","marko","runtime","tags"],"homepage":"https://github.com/marko-js/marko","bugs":"https://github.com/marko-js/marko/issues","repository":{"type":"git","url":"git+https://github.com/marko-js/marko.git","directory":"packages/runtime-tags"},"license":"MIT","exports":{".":{"types":"./index.d.ts"},"./package.json":"./package.json","./translator":"./dist/translator/index.js","./tag-types/*":"./tag-types/*","./debug/*":{"types":"./dist/*.d.ts","import":"./dist/debug/*.mjs","default":"./dist/debug/*.js"},"./*":{"types":"./dist/*.d.ts","import":"./dist/*.mjs","default":"./dist/*.js"}},"types":"index.d.ts","files":["dist","tag-types","index.d.ts","tags-html.d.ts","!**/meta.*.json","!**/__tests__","!**/*.tsbuildinfo"],"scripts":{"build":"node -r ~ts ./scripts/bundle.ts"},"dependencies":{"@marko/compiler":"^5.39.11","csstype":"^3.1.3","magic-string":"^0.30.17"},"engines":{"node":"18 || 20 || >=22"},"exports:override":{".":{"types":"./index.d.ts"},"./translator":"./src/translator/index.ts","./tag-types/*":"./tag-types/*","./debug/*":"./src/*.ts","./*":"./src/*.ts"}}')}}]);
//# sourceMappingURL=420.a5ee434c.js.map